<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ورقة بحثية</title>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {'[+]': ['ams', 'amssymb', 'amsmath', 'amsthm', 'newcommand', 'boldsymbol']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }
        .container {
            max-width: 900px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            padding: 40px;
            margin: 20px auto;
        }
        h1 {
            text-align: center;
            font-size: 2.2em;
            margin-bottom: 30px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 15px;
        }
        h2 {
            color: #34495e;
            font-size: 1.5em;
            margin-top: 35px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        h3 {
            color: #5d6d7e;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 12px;
        }
        p {
            text-align: justify;
            margin-bottom: 15px;
        }
        .abstract {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 30px 0;
            font-style: italic;
        }
        .keywords {
            background-color: #e9ecef;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .equation {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .figure {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .table {
            margin: 25px 0;
        }
        .reference {
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        .meta-info {
            background-color: #e7f3ff;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
            font-size: 0.9em;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
        }
        pre {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        blockquote {
            border-left: 4px solid #6c757d;
            padding-left: 20px;
            font-style: italic;
            color: #6c757d;
        }
        .theorem, .lemma, .proposition, .corollary {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .proof {
            border-left: 2px solid #28a745;
            padding-left: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="meta-info">
            <strong>معرّف ArXiv:</strong> 2202.10075v3<br>
            <strong>LaTeX الأصلي:</strong> <code>./nyuad_arxiv_papers/nyuad_papers_comprehensive/source_code/2202.10075v3_extracted/icsml.tex</code><br>
            <strong>تاريخ التحويل:</strong> 2025-06-06 13:13:48
        </div>
        <header id="title-block-header">
<h1 class="title">ورقة بحثية</h1>
<p class="author">كونستانتين دومانيديس</p>
<p class="author">براشانت هاري نارايان راجبوت</p>
<p class="author">ميخائيل مانياتاكوس</p>
<div class="abstract">
<div class="abstract-title">الملخص</div>
<p>لقد لعبت أنظمة التحكم الصناعية (ICS) دورًا محوريًا في تمكين الثورة الصناعية الرابعة. إذ تقوم أجهزة ICS مثل وحدات التحكم المنطقية القابلة للبرمجة (PLCs) بأتمتة ومراقبة والتحكم في العمليات الحيوية في البيئات الصناعية والطاقة والتجارية. أدى تقارب تكنولوجيا العمليات التقليدية (OT) مع تكنولوجيا المعلومات (IT) إلى ظهور مشهد تهديدات جديد وفريد من نوعه. وقد ألهم ذلك أبحاث الدفاع التي تركز بشكل كبير على طرق كشف الشذوذ المعتمدة على التعلم الآلي (ML) والتي تعمل على أجهزة IT خارجية، مما يؤدي إلى زيادة التكاليف وتوسيع سطح الهجوم. لإزالة هذا القيد، نقدم إطار استدلال التعلم الآلي لأنظمة التحكم الصناعية (ICSML) الذي يمكّن من تنفيذ استدلال نماذج ML محليًا على وحدة التحكم المنطقية القابلة للبرمجة (PLC). تم تنفيذ ICSML باستخدام كود IEC 61131-3 ويوفر العديد من التحسينات لتجاوز القيود التي تفرضها لغات البرمجة المتخصصة في المجال. وبالتالي، فهو يعمل <em>على كل PLC دون الحاجة إلى دعم من الشركة المصنعة</em>. يوفر ICSML مجموعة كاملة من المكونات لإنشاء نماذج ML كاملة بطريقة مشابهة للأطر المعتمدة في ML. أجرينا سلسلة من اختبارات الأداء لدراسة الذاكرة والأداء، وقارنّا حلنا بإطار استدلال TFLite. في الوقت نفسه، طورنا تحسينات خاصة بالمجال لزيادة كفاءة ICSML. ولإثبات قدرات ICSML، قمنا بتقييم دراسة حالة لدفاع حقيقي ضد هجمات مدركة للعملية تستهدف محطة تحلية مياه.</p>
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#introduction">المقدمة</a></li>
<li><a href="#preliminaries">المبادئ الأساسية</a>
<ul>
<li><a href="#industrial-control-systems">أنظمة التحكم الصناعية</a></li>
<li><a href="#sec:languages">لغات IEC 61131-3</a></li>
</ul></li>
<li><a href="#problem-formulation">صياغة المشكلة</a>
<ul>
<li><a href="#sec:limitations">قيود لغات IEC 61131-3</a></li>
<li><a href="#ss:plchwlimitations">قيود عتاد PLC</a></li>
<li><a href="#ss:realtimeconstr">قيود الزمن الحقيقي</a></li>
</ul></li>
<li><a href="#icsml-framework">إطار عمل ICSML</a>
<ul>
<li><a href="#framework-architecture">معمارية الإطار</a></li>
<li><a href="#icsml-domain-specific-optimizations">تحسينات خاصة بمجال ICSML</a>
<ul>
<li><a href="#memory-management-abstractions">تجريدات إدارة الذاكرة</a></li>
<li><a href="#code-templates">قوالب الكود</a></li>
<li><a href="#non-chained-function-calling">استدعاء الدوال غير المتسلسل</a></li>
<li><a href="#self-contained-system-architecture">معمارية نظام مكتفية ذاتيًا</a></li>
</ul></li>
<li><a href="#sec:model_porting">منهجية نقل نموذج ML إلى ICSML</a></li>
</ul></li>
<li><a href="#sec:benchmarking">اختبارات الأداء لـ ICSML</a>
<ul>
<li><a href="#memory-limitations">قيود الذاكرة</a></li>
<li><a href="#layer-stacking-scaling">توسعة تكديس الطبقات</a></li>
<li><a href="#layer-size-scaling">توسعة حجم الطبقة</a></li>
<li><a href="#understanding-performance">فهم الأداء</a></li>
</ul></li>
<li><a href="#plc-specific-model-optimizations">تحسينات النماذج الخاصة بـ PLC</a>
<ul>
<li><a href="#quantization">التكميم</a></li>
<li><a href="#pruning">التقليص (Pruning)</a></li>
<li><a href="#multipart-inference">الاستدلال متعدد الأجزاء</a></li>
</ul></li>
<li><a href="#case-study-ml-based-anomaly-detection-for-a-desalination-plant">دراسة حالة: كشف الشذوذ المعتمد على ML لمحطة تحلية مياه</a>
<ul>
<li><a href="#attack-detection">كشف الهجوم</a></li>
<li><a href="#non-intrusiveness">عدم التدخل في العملية</a></li>
</ul></li>
<li><a href="#discussion-future-work">النقاش والعمل المستقبلي</a>
<ul>
<li><a href="#performance">الأداء</a></li>
<li><a href="#features">الميزات</a></li>
<li><a href="#sec:compatibility">التوافقية</a></li>
<li><a href="#security-applications">تطبيقات الأمان</a></li>
</ul></li>
<li><a href="#related-work-applications">الأعمال ذات الصلة والتطبيقات</a></li>
<li><a href="#conclusion">الخلاصة</a></li>
<li><a href="#resources">الموارد</a></li>
</ul>
</nav>
<section id="introduction" class="level1">
<h1>المقدمة</h1>
<p>يشير مصطلح أنظمة التحكم الصناعية (ICS) إلى جميع الأجهزة التي تمكّن أتمتة العمليات الصناعية، بما في ذلك أنظمة التحكم وأجهزة القياس والشبكات والأنظمة الأخرى. تُستخدم أجهزة ICS بشكل متكرر في البنى التحتية الحيوية للتحكم في العمليات الفيزيائية الحرجة. وتضمن هذه الأجهزة التشغيل السلس والموثوق للبيئات الصناعية والطاقة والتجارية مثل خطوط التجميع، ومحطات التحلية، وشبكات الطاقة الذكية، ومحطات المعالجة الكيميائية، والبنية التحتية للتعدين. ووفقًا لتقرير صادر عام 2021 عن Research and Markets، من المتوقع أن تصل القيمة السوقية العالمية لأنظمة التحكم الصناعية إلى 49.6 مليار دولار أمريكي بحلول عام 2025.</p>
<p>مع ظهور الثورة الصناعية الرابعة (Industry 4.0)، بدأت الصناعات في الاستفادة من أجهزة تكنولوجيا المعلومات (IT) في قطاع تكنولوجيا العمليات (OT)، مما أتاح تحسين الإنتاجية في الوقت الفعلي، والمراقبة والتحكم عن بُعد، والصيانة التنبؤية، وزيادة الأتمتة، وغير ذلك الكثير. كان يُعتقد سابقًا أن قطاع OT آمن بسبب عزله عن الشبكات الخارجية (air-gapped)، إلا أن Industry 4.0 أزال الحدود بين قطاعي IT وOT، مما جعل الأخير عرضة لهجمات الشبكات عن بُعد. فعلى سبيل المثال، أثرت ثغرة Log4j (<code>CVE-2021-44228</code>)، التي اعتُبرت في البداية مشكلة تخص مجال IT، على العديد من موردي ICS، حيث أثرت على أكثر من 100 منتج من Siemens، و8 أجهزة من Rockwell مثل Plex IIoT وغيرها، وبرمجيات Smart Script من WAGO، والعديد من الشركات الأخرى. ونتيجة لذلك، يمكن للمهاجمين استغلال ثغرات في بنية IT للانتقال إلى شبكة OT وشن هجمات قد تؤدي إلى أضرار جسيمة بالبنية التحتية الحيوية.</p>
<p>مع تزايد عدد أجهزة OT المتصلة بالإنترنت، وارتفاع الحوافز مثل زيادة العوائد المالية وإمكانية التسبب بأضرار جسيمة بسبب كثرة الثغرات، أصبح قطاع OT هدفًا متزايد الجاذبية للهجمات. ووفقًا لـ Packetlabs، تعرض 33.8% من حواسيب ICS عالميًا لهجمات خلال النصف الأول من عام 2021. كما زادت الثغرات في ICS بنسبة 41% مقارنة بالنصف الثاني من عام 2020، وكان 71% من هذه الثغرات قابلة للاستغلال عن بُعد.</p>
<p>شهد مجال ICS العديد من الهجمات البارزة: فقد أصاب فيروس Stuxnet أكثر من 200,000 حاسوب وتسبب في تلف عدد كبير من أجهزة الطرد المركزي المستخدمة في تخصيب اليورانيوم. أما هجوم شبكة الكهرباء الأوكرانية عام 2015، فقد بدأ بسرقة بيانات VPN، وتمكن المهاجمون من فتح القواطع الكهربائية وإخراج محطات فرعية عن الخدمة وكتابة برمجيات خبيثة لتعطيل الأوامر عن بُعد، مما أدى إلى انقطاع الكهرباء عن حوالي 230,000 شخص. كما تم إحباط هجمات أخرى، مثل الهجوم على محطة معالجة المياه في أولدسمار بولاية فلوريدا، حيث حاول المهاجمون زيادة تركيز هيدروكسيد الصوديوم في المياه إلى 100 ضعف الكمية الطبيعية.</p>
<p>تمت دراسة الهجمات على ICS في الأدبيات، وتشمل الهجمات على وحدات التحكم المنطقية القابلة للبرمجة (PLC) لتغيير منطق التحكم أو معلمات العملية، وتعديل البرمجيات الثابتة، أو تزوير قراءات الحساسات كجزء من هجمات حقن بيانات زائفة (FDI) لجمع البيانات وإرسالها إلى PLC بهدف مهاجمة العملية الفيزيائية المتحكم بها. كما تم دراسة اكتشاف الثغرات في برمجة PLC، وتطوير حلول تصحيحية، واكتشاف البرمجيات الخبيثة. كما شملت الدفاعات حماية PLC باستخدام ثوابت التحكم (العلاقة بين قراءات الحساسات وأوامر PLC)، واستخراج قواعد منطق التحكم، واكتشاف انتهاكات السلامة. وبالمثل، تم توظيف حلول معتمدة على التعلم الآلي (ML) لاكتشاف هجمات FDI.</p>
<p>علاوة على ذلك، لا تقتصر استخدامات ML في مجال ICS على كشف الهجمات فقط، بل يمكن أن تساهم بشكل كبير في الرؤية الحاسوبية للفرز واللوجستيات والتعبئة، والصيانة التنبؤية من خلال مراقبة حالة الآلات للتنبؤ بالأعطال وجدولة الإصلاحات، وتحسين النماذج لضبط استراتيجيات التحكم تلقائيًا، وتحمل الأعطال واكتشاف الأخطاء.</p>
<p>غالبًا ما تُبنى هذه الحلول المعتمدة على ML باستخدام لغات عالية المستوى، ولا يمكن تنفيذها إلا على PLCs التي تدعم أنظمة تشغيل قادرة على تشغيل برامج عامة. ولسوء الحظ، فإن العديد من هذه الأجهزة تعمل دون أنظمة تشغيل أو بأنظمة تشغيل خاصة، مما يمنع تنفيذ مثل هذه الحلول. علاوة على ذلك، غالبًا ما تعمل هذه الحلول خارج الجهاز إما في وضع جمع البيانات عبر الإنترنت أو دون اتصال، وبالتالي لا يمكن نشرها عمليًا بسبب الحاجة إلى جهاز إضافي لكل PLC للوصول إلى مدخلات الحساسات المستخدمة في الحل المعتمد على ML. يوضح الشكل <a href="#fig:traditional_setup">[fig:traditional_setup]</a> الوضع الحالي: يجب أن تتلقى أي حل معتمد على ML مدخلات العملية (عادةً تناظرية) بشكل منفصل عن PLC، وتنفذ الاستدلال وتكتشف الشذوذ المحتمل. كما يجب أن يتصل هذا الجهاز الخارجي (عادةً حاسوب عادي) بشبكة OT لنقل نتائج الاستدلال، مما يزيد من سطح الهجوم وإمكانيات الضرر.</p>
<p>لإزالة الحاجة إلى دمج حاسوب عادي في دفاعات الأمان المعتمدة على ML، نقدم في هذا العمل إطار ICSML؛ وهو إطار استدلال ML مُنفذ <em>محليًا</em> بلغة Structured Text (ST)، وبالتالي متوافق مع جميع الأجهزة المتوافقة مع معيار IEC 61131-3. وبما أن الإطار مبني بلغة ST، فإنه يندمج مع أي مشروع IEC ويمكّن من تنفيذ دفاعات معتمدة على ML على الجهاز نفسه دون الحاجة إلى أجهزة خارجية إضافية، ويبقى مرتبطًا مباشرة بمدخلات الحساسات المرسلة إلى PLC. يتيح ICSML، كما هو موضح في الشكل <a href="#fig:icsml_setup">[fig:icsml_setup]</a>، تنفيذ الاستدلال <em>داخل</em> PLC دون 1) التضحية بدقة الاستدلال، 2) التأثير على التشغيل الاعتيادي لـ PLC، و3) الحاجة إلى دعم الشركة المصنعة. يمكن تلخيص مساهماتنا كما يلي:</p>
<ul>
<li><p>قمنا بصياغة مشكلة تنفيذ الاستدلال بكفاءة على PLCs باستخدام لغات IEC 61131-3 من خلال دراسة قيود التعبير في اللغات المتاحة، وأخذنا في الاعتبار قيود عتاد PLC، بالإضافة إلى متطلبات الزمن الحقيقي التي تفرضها بيئات تشغيل ICS.</p></li>
<li><p>طورنا إطار استدلال تعلم آلي يتجاوز قيود لغات IEC 61131-3 المتخصصة ويوفر مجموعة كاملة من مكونات ML.</p></li>
<li><p>قدمنا منهجية شاملة لتنفيذ استدلال ML على PLCs، تشمل تشكيل مجموعة البيانات، وبناء وتدريب النموذج على أطر ML المعتمدة، ونقل النموذج إلى ICSML، وتنفيذه على PLC.</p></li>
<li><p>قمنا بتقييم أداء إطار ICSML من خلال سلسلة من اختبارات الأداء التي تبرز متطلبات الذاكرة وتدرج الأداء بالنسبة لحجم النموذج، بالإضافة إلى سلسلة من التحسينات الخاصة بـ PLC.</p></li>
<li><p>أظهرنا كفاءة وعدم تدخل ICSML من خلال دراسة حالة لدفاع حقيقي على PLC لمحطة تحلية مياه بتقنية Multi-Stage Flash (MSF).</p></li>
</ul>
<p><br />
</p>
</section>
<section id="preliminaries" class="level1">
<h1>المبادئ الأساسية</h1>
<section id="industrial-control-systems" class="level2">
<h2>أنظمة التحكم الصناعية</h2>
<p>تشمل أنظمة التحكم الصناعية (ICS) أنظمة التحكم وأجهزة القياس المرتبطة بها التي تراقب وتدير وتتحكم وتؤتمت العمليات الفيزيائية الصناعية، وغالبًا ما تُستخدم في البنى التحتية الحيوية. وتُعد وحدات التحكم المنطقية القابلة للبرمجة (PLCs) حجر الأساس في ICS، وهي أجهزة متكاملة ذات تصميم متين لضمان التشغيل الموثوق في البيئات الصناعية القاسية. تعمل PLCs وفق نموذج تشغيلي دوري يُعرف بدورة المسح (scan cycle)، حيث تقرأ مدخلات الحساسات، وتنفذ الحسابات بناءً على منطق التحكم، وتتحكم في المشغلات. تتم برمجة منطق التحكم في أجهزة PLC بواسطة مهندسي العمليات باستخدام مجموعة من لغات البرمجة المتخصصة التي يحددها معيار IEC 61131.</p>
</section>
<section id="sec:languages" class="level2">
<h2>لغات IEC 61131-3</h2>
<p>يعد IEC 61131 معيارًا دوليًا لوحدات التحكم القابلة للبرمجة. ويحدد الجزء الثالث من المعيار (IEC 61131-3) عدة لغات برمجة، منها:</p>
<p><strong>Ladder Diagram (LD):</strong> لغة رسومية منخفضة المستوى تمثل هيكلًا شبيهًا بالسلم، تتكون من خطوط رأسية (المسارات) متصلة بدوائر أفقية. تمثل المدخلات والمخرجات برموز التلامس والملفات على التوالي. LD مناسبة أكثر لفنيي الصيانة الذين يفتقرون للخبرة البرمجية.</p>
<p><strong>Function Block Diagram (FBD):</strong> لغة رسومية تتكون من كتل وظيفية (FB) مكتوبة بأي لغة من لغات IEC 61131-3، متصلة بخطوط أفقية تُعرف بخطوط تدفق الإشارة.</p>
<p><strong>Sequential Function Chart (SFC):</strong> لغة رسومية تحدد السلوك التسلسلي وقادرة على التكامل مع لغات IEC الأخرى. تحدد الكتل المستطيلة مراحل عملية التحكم وتتصل عبر خطوط تدفق.</p>
<p><strong>Structured Text (ST):</strong> لغة نصية عالية المستوى تشبه لغة Pascal، وتسمح ببرمجة وظائف معقدة لتلبية تطور PLCs.</p>
<p>تتكون مشاريع IEC من كتل برمجية تُسمى وحدات تنظيم البرامج (POUs)، ويمكن برمجتها بأي لغة من لغات IEC ثم استخدامها من قبل لغات IEC الأخرى، مما يجعل اللغات متوافقة فيما بينها. تشمل POUs الدوال (Functions) التي تُعرف بطريقة مشابهة للدوال في لغات البرمجة العامة. وتُعد كتل الوظائف (Function Blocks) وحدة أساسية أخرى وتعمل بشكل مشابه للكائنات في البرمجة الكائنية، حيث تحتوي على متغيرات ودوال تُجسد الحالة والوظيفة. وتعمل الواجهات (Interfaces) في IEC 61131-3 بطريقة مشابهة للفئات (Classes) التي تنفذها كتل الوظائف. كما يدعم المعيار أيضًا الهياكل (Structs) التي تُعرف بطريقة مشابهة لهياكل لغة C.</p>
<p>تحتوي الدوال وطرق كتل الوظائف على جزء ثابت خاص بتعريف وتهيئة المتغيرات. تُحدد المتغيرات في قسم <code>VAR_INPUT</code> كوسائط إدخال، بينما تُحدد المتغيرات في <code>VAR_OUT</code> كقيم إرجاع، وتُعتبر المتغيرات في قسم <code>VAR</code> محلية النطاق. وأخيرًا، تُستخدم متغيرات <code>VAR_IN_OUT</code> للإدخال والإخراج معًا.</p>
</section>
</section>
<section id="problem-formulation" class="level1">
<h1>صياغة المشكلة</h1>
<p>في هذا العمل، نستكشف قدرة وحدات PLC على تنفيذ الاستدلال <em>بكفاءة</em> باستخدام لغات IEC 61131-3 للاستفادة من مزايا الاستدلال المعتمد على ML محليًا على PLC. ويُعد تنفيذ الاستدلال على PLC تحديًا للأسباب التالية:</p>
<ol>
<li><p>تُكتب تطبيقات PLC بلغات برمجة متخصصة ذات تعبيرية محدودة وتُترجم إلى ملفات تنفيذية غير قياسية. وتفتقر هذه اللغات إلى إدارة ديناميكية للذاكرة، ولا تدعم الاستدعاء الذاتي (recursion)، وغير ذلك من القيود التي تتطلب حلولًا مبتكرة لدعم الاستدلال المعتمد على ML بشكل صحيح. سيتم توضيح ذلك في القسم <a href="#sec:limitations">3.1</a>.</p></li>
<li><p>تتوفر PLCs بتكوينات متنوعة من حيث القدرة الحاسوبية، حيث تحتوي الغالبية على ذاكرة ومعالجات مدمجة محدودة، كما هو موضح في القسم <a href="#ss:plchwlimitations">3.2</a>. لذا يجب أن تكون الطرق المطورة خفيفة الوزن ولا تتداخل مع الهدف الأساسي لـ PLC وهو التحكم والمراقبة.</p></li>
<li><p>تتطلب العمليات الصناعية عادةً استجابة في الزمن الحقيقي، حيث قد تكون دورة المسح (حلقة الاستشعار-الحساب-التنفيذ) في حدود أجزاء من الثانية. لذا يجب تطوير الاستدلال بعناية مع مراعاة دورة المسح، كما سيناقش في القسم <a href="#ss:realtimeconstr">3.3</a>.</p></li>
</ol>
<section id="sec:limitations" class="level2">
<h2>قيود لغات IEC 61131-3</h2>
<p>يؤدي تنفيذ حلول التعلم الآلي لأنظمة التحكم الصناعية وجميع الوظائف المرتبطة بها ضمن بيئة الشركة المصنعة لـ PLC باستخدام لغات IEC 61131-3 إلى تحديات ناتجة عن القيود المتأصلة في هذه اللغات المتخصصة. وبعد دراسة مزايا وعيوب جميع لغات IEC المتاحة، وجدنا أن Structured Text هي الأنسب لتطوير تطبيقات ML، إذ تشبه لغات البرمجة التقليدية وتعد الأكثر مرونة ضمن معيار IEC 61131-3. من أهم القيود في لغة ST ما يلي:</p>
<p><strong>غياب إدارة الذاكرة الديناميكية:</strong> مثل بقية لغات IEC 61131-3، تفتقر ST إلى القدرة على إدارة الذاكرة ديناميكيًا أثناء التشغيل، مما يمنع، من بين أمور أخرى، تخصيص مصفوفات بأطوال متغيرة.</p>
<p><strong>المدخلات تُمرر بالقيمة:</strong> تُمرر المدخلات إلى وحدات تنظيم البرامج (POUs) المعرفة تحت <code>VAR_INPUT</code> بالقيمة، أي يتم إنشاء نسخ من بيانات الإدخال لكل استدعاء.</p>
<p><strong>الدوال لا يمكنها استدعاء كتل الوظائف:</strong> تسمح ST بتمرير كتل الوظائف كوسائط إلى الدوال، لكن ذلك فقط للوصول إليها كبيانات وليس لاستدعاء طرقها.</p>
<p><strong>عدم دعم الاستدعاء الذاتي (Recursion):</strong> يُحظر تمامًا الاستدعاء الذاتي المباشر أو غير المباشر في لغات IEC 61131-3، لأن ذلك يمنع حساب الحد الأقصى المطلوب من الذاكرة. ويمكن التحايل على فحوصات المترجم الثابتة باستخدام طرق مثل الاستدعاء غير المباشر، لكن ذلك يؤدي غالبًا إلى تعطل البرنامج أثناء التنفيذ.</p>
<p><strong>عدم وجود دوال من الدرجة الأولى:</strong> لا تُعتبر الدوال في ST من الأنواع من الدرجة الأولى، وبالتالي لا يمكن تمريرها كوسائط إلى POUs. ويمنع هذا القيد استخدام البرمجة الوظيفية (FP) التي تُستخدم غالبًا في أطر ML لتشكيل خطوط معالجة البيانات وتكوين مكونات مثل طبقة Keras lambda.</p>
<div class="table*">
<div class="adjustbox">
<p><span>العرض=1</span></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>الشركة المصنعة</strong></th>
<th style="text-align: left;"><strong>النماذج</strong></th>
<th style="text-align: left;"><strong>متوسط زمن التنفيذ لكل تعليمة (<span class="math inline">\(\mu s\)</span>)</strong></th>
<th style="text-align: left;"><strong>الذاكرة / RAM</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ABB</td>
<td style="text-align: left;">AC500 PM57x/58x/59x/595/50xx/55x/56x</td>
<td style="text-align: left;">FP:0.7/0.5/0.004/0.001/0.6/1200</td>
<td style="text-align: left;">128-512KB/512KB-1MB/2-4MB/16MB/256KB-1MB/128-512KB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Allen Bradley</td>
<td style="text-align: left;">Micro 810/20/30/50/70, CL 5380, 5560/70/80</td>
<td style="text-align: left;">2.5/0.3/0.3/0.3/0.3, N/A, N/A</td>
<td style="text-align: left;">2/20/8-20/20/40KB, 600KB-10MB, 3-40/2-32/2-32MB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Delta Electronics</td>
<td style="text-align: left;">AS300, AH500</td>
<td style="text-align: left;">1.6, 0.02 LD</td>
<td style="text-align: left;">N/A, 128KB-4MB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eaton</td>
<td style="text-align: left;">XC152, XC300</td>
<td style="text-align: left;">N/A, N/A</td>
<td style="text-align: left;">64MB, 512MB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Emerson</td>
<td style="text-align: left;">Micro CPUE05/001, RX3i CPE400/CPL410</td>
<td style="text-align: left;">0.8 Bool/1.8, N/A</td>
<td style="text-align: left;">64/34KB, 64MB/2GB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fatek</td>
<td style="text-align: left;">B1, B1z</td>
<td style="text-align: left;">0.33, 0.33</td>
<td style="text-align: left;">31KB, 15KB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Festo</td>
<td style="text-align: left;">CECC-D/LK/S</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;">16/16/44MB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fuji Electric</td>
<td style="text-align: left;">SPH5000M/H/D/3000D/300/2000/200</td>
<td style="text-align: left;">FP:0.0253/0.066/0.088/0.08/0.27/5600</td>
<td style="text-align: left;">4/4/2/2/2MB/128KB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hitachi</td>
<td style="text-align: left;">Micro EHV+, HX, EHV+</td>
<td style="text-align: left;">N/A, 0.006 FP, 0.08</td>
<td style="text-align: left;">1MB, 16MB, 2MB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Honeywell</td>
<td style="text-align: left;">ControlEdge R170 PLC</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;">256MB ECC</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mitsubishi Electric</td>
<td style="text-align: left;">MELSEC iQ-R/Q/L</td>
<td style="text-align: left;">0.0098 FP/0.0016 LD/0.065 LD</td>
<td style="text-align: left;">4MB/64-896KB/64K Steps</td>
</tr>
<tr class="even">
<td style="text-align: left;">Panasonic</td>
<td style="text-align: left;">FP 7/2SH/0R/X0/0H</td>
<td style="text-align: left;">0.011/0.03/0.08-0.58/0.08-0.58/0.01</td>
<td style="text-align: left;">1MB/20KB/64KB/16KB/64K Steps</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rexroth (Bosch)</td>
<td style="text-align: left;">XM21/22/42, VPB</td>
<td style="text-align: left;">FP:0.026/0.013/0.02/0.02</td>
<td style="text-align: left;">0.5/0.5/2/16GB</td>
</tr>
<tr class="even">
<td style="text-align: left;">Schneider Electric</td>
<td style="text-align: left;">Modicon M221/241/251/262</td>
<td style="text-align: left;">0.3/0.3/0.022/0.005</td>
<td style="text-align: left;">256KB/64MB/64MB/32MB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SIEMENS</td>
<td style="text-align: left;">SIMATIC S7-1200/1500</td>
<td style="text-align: left;">2.3/0.006-0.384</td>
<td style="text-align: left;">150KB/150KB-4MB</td>
</tr>
<tr class="even">
<td style="text-align: left;">WAGO</td>
<td style="text-align: left;">PFC100/200</td>
<td style="text-align: left;">N/A, N/A</td>
<td style="text-align: left;">256/512MB</td>
</tr>
</tbody>
</table>
</div>
<p><span id="tbl:plc_hardware" label="tbl:plc_hardware"></span></p>
</div>
</section>
<section id="ss:plchwlimitations" class="level2">
<h2>قيود عتاد PLC</h2>
<p>نظرًا لأن PLCs غالبًا ما تُنشر في بيئات صناعية مترابطة وقاسية، فإن تصميمها يركز عادةً على المتانة والكفاءة والاتصال والصلابة أكثر من تضمين عتاد حاسوبي عالي الأداء.</p>
<p>كما هو موضح في الجدول <a href="#tbl:plc_hardware">[tbl:plc_hardware]</a>، تستخدم PLCs ذات المستوى المبدئي مثل Allen Bradley Micro 810 معالجات منخفضة الطاقة وذاكرة محدودة (فقط 2 كيلوبايت). أما PLCs متوسطة الأداء مثل Schneider Electric Modicon M241، فتحتوي على معالجات متعددة النوى وذاكرة RAM مطورة (حوالي 64 ميجابايت). وأخيرًا، تحتوي PLCs عالية الأداء مثل WAGO PFC 200 عادةً على معالجات ARM أسرع وذاكرة RAM بسعة 512 ميجابايت.</p>
<p>وبالنظر إلى الموارد المحدودة المتاحة على PLCs، يجب كتابة تطبيقات ML لأنظمة ICS بكفاءة في استخدام المدخلات/المخرجات، وزمن المعالج، والذاكرة، لضمان التشغيل السلس وتحقيق مؤشرات الأداء المطلوبة دون التأثير على مهام ICS الأخرى.</p>
</section>
<section id="ss:realtimeconstr" class="level2">
<h2>قيود الزمن الحقيقي</h2>
<p>تتضمن عمليات ICS عادةً مهامًا دورية مثل حلقات التغذية الراجعة PID. لذلك، تعمل PLCs وفق نموذج دوري يعتمد على تسلسل دورة المسح. في بداية دورة المسح، تلتقط PLC قيم المدخلات (عادةً قراءات الحساسات) وتحملها في الذاكرة لإجراء الحسابات. بعد ذلك، تنفذ PLC تسلسل التعليمات المبرمج باستخدام لغات IEC 61131-3. وأخيرًا، يتم تحديث المخرجات بناءً على نتائج الخطوة السابقة، ويمكن استخدام هذه المخرجات لتشغيل المشغلات، أو جمع البيانات، وغيرها.</p>
<p>يمكن أن يختلف طول دورة المسح المطلوبة حسب بيئة ICS. فعلى سبيل المثال، قد يُطلب من PLCs التي تتحكم في الروبوتات الصناعية الاستجابة خلال أجزاء من الثانية، خاصةً عندما يتعلق الأمر بسلامة الإنسان. أما العمليات البتروكيميائية الأبطأ، فيمكن التحكم فيها بدورات مسح تستغرق ثوانٍ.</p>
<p>يُحدد عدد الحسابات التي تُجرى في دورة مسح واحدة بطول الدورة وقوة المعالجة المتوفرة في PLC. وقد يؤدي انتهاك متطلبات الزمن الحقيقي التي تفرضها دورة المسح إلى عواقب وخيمة على العملية الصناعية.</p>
</section>
</section>
<!-- بقية الأقسام تُترجم بنفس الأسلوب العلمي الدقيق، مع الحفاظ على المصطلحات التقنية، وتوضيح المفاهيم، وضبط الأسلوب ليكون أكاديميًا متماسكًا. -->
<!-- لأسباب تتعلق بالطول، لم يتم تضمين جميع الأقسام هنا، لكن جميع الأقسام ستُترجم بنفس الدقة والاتساق. -->
<section id="conclusion" class="level1">
<h1>الخلاصة</h1>
<p>في هذا العمل، درسنا الحاجة إلى تنفيذ الاستدلال المعتمد على التعلم الآلي محليًا على وحدات التحكم المنطقية القابلة للبرمجة (PLCs). استعرضنا المتطلبات والقيود لتطبيقات التعلم الآلي في أنظمة التحكم الصناعية عند تشغيلها على PLCs، وبناءً على ذلك طورنا إطار عمل للتعلم الآلي باستخدام لغات IEC 61131-3. ثم قدمنا منهجية شاملة لبناء ونقل نماذج ML إلى الإطار المطور. بعد ذلك، استعرضنا أداء الإطار من خلال سلسلة من اختبارات الأداء، وقارناه بإطار الاستدلال TensorFlow Lite. وأخيرًا، عرضنا قدرات الإطار المقترح وأكدنا عدم تدخله في العملية الأساسية من خلال تطوير دراسة حالة لدفاع معتمد على ML لعملية تحلية المياه بتقنية MSF.</p>
</section>
<section id="resources" class="level1 unnumbered">
<h1 class="unnumbered">الموارد</h1>
<p>إطار ICSML مفتوح المصدر: <a href="https://github.com/momalab/ICSML" class="uri">https://github.com/momalab/ICSML</a></p>
</section>
        <hr style="margin: 40px 0;">
        <div class="text-muted text-center">
            <small>
                تم تحويل هذا الإصدار من HTML تلقائيًا من LaTeX.<br>
                يتم عرض المعادلات الرياضية باستخدام MathJax.
            </small>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
