<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICSML: إطار استدلال للتعلُّم الآلي على وحدات PLC في أنظمة التحكم الصناعية</title>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {'[+]': ['ams', 'amssymb', 'amsmath', 'amsthm', 'newcommand', 'boldsymbol']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Times New Roman', serif;
            line-height: 1.75;
            color: #333;
            background-color: #fafafa;
        }
        .container {
            max-width: 900px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.08);
            padding: 40px;
            margin: 24px auto;
        }
        h1 {
            text-align: center;
            font-size: 2.1em;
            margin-bottom: 28px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 14px;
        }
        h2 {
            color: #34495e;
            font-size: 1.5em;
            margin-top: 34px;
            margin-bottom: 14px;
            border-left: 4px solid #3498db;
            padding-left: 10px;
        }
        h3 {
            color: #5d6d7e;
            font-size: 1.25em;
            margin-top: 24px;
            margin-bottom: 12px;
        }
        p {
            text-align: justify;
            margin-bottom: 14px;
        }
        .abstract {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 28px 0;
            font-style: italic;
        }
        .abstract-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-style: normal;
        }
        .keywords {
            background-color: #e9ecef;
            padding: 14px;
            margin: 18px 0;
            border-radius: 5px;
        }
        .equation {
            text-align: center;
            margin: 18px 0;
            padding: 14px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .figure {
            text-align: center;
            margin: 26px 0;
            padding: 18px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .table {
            margin: 22px 0;
        }
        .reference {
            font-size: 0.9em;
            margin-bottom: 7px;
        }
        .meta-info {
            background-color: #e7f3ff;
            padding: 14px;
            margin-bottom: 28px;
            border-radius: 5px;
            font-size: 0.9em;
        }
        code {
            background-color: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
        }
        pre {
            background-color: #f8f9fa;
            padding: 14px;
            border-radius: 5px;
            overflow-x: auto;
        }
        blockquote {
            border-left: 4px solid #6c757d;
            padding-left: 18px;
            font-style: italic;
            color: #6c757d;
        }
        .theorem, .lemma, .proposition, .corollary {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 14px;
            margin: 18px 0;
            border-radius: 5px;
        }
        .proof {
            border-left: 2px solid #28a745;
            padding-left: 14px;
            margin: 14px 0;
        }
        nav#TOC ul {
            list-style: none;
            padding-left: 0;
        }
        nav#TOC ul li {
            margin-bottom: 6px;
        }
        nav#TOC a {
            text-decoration: none;
            color: #0d6efd;
        }
        nav#TOC a:hover {
            text-decoration: underline;
        }
        .caption {
            color: #6c757d;
            font-size: 0.9em;
            margin-top: 6px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="meta-info">
            <strong>معرّف ArXiv:</strong> 2202.10075v3<br>
            <strong>LaTeX الأصلي:</strong> <code>./nyuad_arxiv_papers/nyuad_papers_comprehensive/source_code/2202.10075v3_extracted/icsml.tex</code><br>
            <strong>تاريخ التحويل:</strong> 2025-06-06 13:13:48
        </div>
        <header id="title-block-header">
            <h1 class="title">ICSML: إطار استدلال للتعلُّم الآلي على وحدات PLC في أنظمة التحكم الصناعية</h1>
            <p class="author">كونستانتين دومانيديس</p>
            <p class="author">براشانت هاري نارايان راجبوت</p>
            <p class="author">ميخائيل مانياتاكوس</p>
            <div class="abstract">
                <div class="abstract-title">الملخّص</div>
                <p>لقد أدّت أنظمة التحكّم الصناعية (ICS) دورًا محوريًّا في تمكين الثورة الصناعية الرابعة. إذ تُؤتمت أجهزة ICS، مثل وحدات التحكّم المنطقيّة القابلة للبرمجة (PLCs)، العمليات الحيوية وتُراقبها وتتحكّم بها في البيئات الصناعية والطاقة والتجارية. وقد أفضى تقارب تكنولوجيا العمليات (OT) مع تكنولوجيا المعلومات (IT) إلى مشهد تهديد جديد وفريد. ألهم ذلك أبحاث دفاع تركّز بكثافة على أساليب كشف الشذوذ المُعتمِدة على التعلُّم الآلي (ML) التي تعمل على عتاد IT خارجي، ما يزيد التكاليف ويُوسّع سطح الهجوم. لإزالة هذا القيد، نقدّم إطار استدلال للتعلُّم الآلي لأنظمة التحكّم الصناعية (ICSML) يتيح تنفيذ استدلال نماذج ML محليًّا على الـ PLC. جرى تنفيذ ICSML باستخدام لغات IEC 61131-3 (بلغة Structured Text أساسًا)، ويُقدّم عددًا من التحسينات لتجاوز القيود التي تفرضها هذه اللغات المتخصّصة، وبذلك يعمل <em>على أي PLC دون حاجة إلى دعم من الشركة المصنِّعة</em>. يُوفّر ICSML مجموعة كاملة من المكوّنات لبناء نماذج ML وتشغيلها بطريقة مماثلة لأُطر ML الشائعة. أجرينا سلسلة من اختبارات الأداء لاستكشاف بصمة الذاكرة وزمن التنفيذ، وقارَنّا حلّنا بإطار الاستدلال TFLite. بالتوازي، طوّرنا تحسينات خاصّة بالمجال لرفع كفاءة ICSML. ولإثبات القدرات، قيّمنا دراسة حالة لدفاع واقعي ضد هجمات مُدركة للعملية تستهدف محطة تحلية مياه.</p>
            </div>
        </header>
        <nav id="TOC" role="doc-toc">
            <ul>
                <li><a href="#introduction">المقدّمة</a></li>
                <li><a href="#preliminaries">المبادئ الأساسية</a>
                    <ul>
                        <li><a href="#industrial-control-systems">أنظمة التحكّم الصناعية</a></li>
                        <li><a href="#sec:languages">لغات IEC 61131-3</a></li>
                    </ul>
                </li>
                <li><a href="#problem-formulation">صياغة المشكلة</a>
                    <ul>
                        <li><a href="#sec:limitations">قيود لغات IEC 61131-3</a></li>
                        <li><a href="#ss:plchwlimitations">قيود عتاد PLC</a></li>
                        <li><a href="#ss:realtimeconstr">قيود الزمن الحقيقي</a></li>
                    </ul>
                </li>
                <li><a href="#icsml-framework">إطار عمل ICSML</a>
                    <ul>
                        <li><a href="#framework-architecture">معمارية الإطار</a></li>
                        <li><a href="#icsml-domain-specific-optimizations">تحسينات خاصّة بمجال ICSML</a>
                            <ul>
                                <li><a href="#memory-management-abstractions">تجريدات إدارة الذاكرة</a></li>
                                <li><a href="#code-templates">قوالب الشيفرة</a></li>
                                <li><a href="#non-chained-function-calling">استدعاء الدوال غير المُتسلسل</a></li>
                                <li><a href="#self-contained-system-architecture">معمارية نظام مُكتفية ذاتيًّا</a></li>
                            </ul>
                        </li>
                        <li><a href="#sec:model_porting">منهجيّة نقل نموذج ML إلى ICSML</a></li>
                    </ul>
                </li>
                <li><a href="#sec:benchmarking">اختبارات الأداء لـ ICSML</a>
                    <ul>
                        <li><a href="#memory-limitations">قيود الذاكرة</a></li>
                        <li><a href="#layer-stacking-scaling">تحجيم تكديس الطبقات</a></li>
                        <li><a href="#layer-size-scaling">تحجيم حجم الطبقة</a></li>
                        <li><a href="#understanding-performance">فهم الأداء</a></li>
                    </ul>
                </li>
                <li><a href="#plc-specific-model-optimizations">تحسينات النماذج الخاصّة بـ PLC</a>
                    <ul>
                        <li><a href="#quantization">التكميم</a></li>
                        <li><a href="#pruning">التشذيب (Pruning)</a></li>
                        <li><a href="#multipart-inference">الاستدلال متعدّد الأجزاء</a></li>
                    </ul>
                </li>
                <li><a href="#case-study-ml-based-anomaly-detection-for-a-desalination-plant">دراسة حالة: كشف الشذوذ المُعتمد على ML لمحطة تحلية مياه</a>
                    <ul>
                        <li><a href="#attack-detection">كشف الهجوم</a></li>
                        <li><a href="#non-intrusiveness">عدم التداخُل مع العملية</a></li>
                    </ul>
                </li>
                <li><a href="#discussion-future-work">النقاش والعمل المستقبلي</a>
                    <ul>
                        <li><a href="#performance">الأداء</a></li>
                        <li><a href="#features">الميزات</a></li>
                        <li><a href="#sec:compatibility">التوافقيّة</a></li>
                        <li><a href="#security-applications">تطبيقات الأمان</a></li>
                    </ul>
                </li>
                <li><a href="#related-work-applications">الأعمال ذات الصلة والتطبيقات</a></li>
                <li><a href="#conclusion">الخلاصة</a></li>
                <li><a href="#resources">الموارد</a></li>
            </ul>
        </nav>
        <section id="introduction" class="level1">
            <h1>المقدّمة</h1>
            <p>يشير مصطلح أنظمة التحكّم الصناعية (ICS) إلى جميع الأجهزة التي تُمكِّن أتمتة العمليات الصناعية، بما يشمل أنظمة التحكّم وأجهزة القياس والشبكات والأنظمة الأخرى. تُستخدم أجهزة ICS بكثافة في البُنى التحتية الحيوية للتحكّم في العمليات الفيزيائية الحرِجة، بما يضمن التشغيل السلس والموثوق لبيئات صناعية وطاقوية وتجارية، مثل خطوط التجميع، ومحطات التحلية، وشبكات الطاقة الذكية، ومحطات المعالجة الكيميائية، والبُنى التحتية للتعدين. ووفقًا لتقرير Research and Markets لعام 2021، من المتوقع أن تبلغ القيمة السوقية العالمية لـ ICS نحو 49.6 مليار دولار أمريكي بحلول 2025.</p>
            <p>مع بزوغ الثورة الصناعية الرابعة (Industry 4.0)، شرعت الصناعات في الاستفادة من أجهزة تكنولوجيا المعلومات (IT) داخل قطاع تكنولوجيا العمليات (OT)، ما أتاح تحسين الإنتاجية في الزمن الحقيقي، والمراقبة والتحكّم عن بُعد، والصيانة التنبؤية، وزيادة الأتمتة، وغيرها. وبينما كان يُعتقَد سابقًا أن قطاع OT آمن بسبب العزل الشبكي (air-gapped)، فقد ألغت Industry 4.0 الحدود بين IT وOT، وجعلت الأخير عرضة لهجمات الشبكات عن بُعد. فعلى سبيل المثال، أثّرت ثغرة Log4j (<code>CVE-2021-44228</code>) —التي عُدّت بدايةً مشكلة تخصّ IT— في عدد كبير من مورّدي ICS، إذ طالت أكثر من 100 منتج من Siemens، و8 أجهزة من Rockwell مثل Plex IIoT وغيرها، وبرمجيات Smart Script من WAGO، وشركات أخرى كثيرة. تبعًا لذلك، يمكن للمهاجمين استغلال ثغرات في بنية IT للانتقال إلى شبكة OT وشنّ هجمات قد تسفر عن أضرار جسيمة بالبُنى التحتية الحيوية.</p>
            <p>مع ازدياد عدد أجهزة OT المتصلة بالإنترنت وارتفاع الحوافز (مثل العوائد المالية وإمكان إحداث أضرار كبيرة) في ظل كثرة الثغرات، أصبح قطاع OT هدفًا متزايد الجاذبية للهجمات. ووفق Packetlabs، تعرّض 33.8% من حواسيب ICS عالميًّا لهجمات خلال النصف الأول من 2021. كما ازداد عدد الثغرات في ICS بنسبة 41% مقارنةً بالنصف الثاني من 2020، وكان 71% منها قابلاً للاستغلال عن بُعد.</p>
            <p>شهد مجال ICS هجمات بارزة عدّة: أصاب Stuxnet أكثر من 200,000 حاسوب وتسبّب في تلف عدد كبير من أجهزة الطرد المركزي لتخصيب اليورانيوم. أما هجوم شبكة الكهرباء الأوكرانية عام 2015 فبدأ بسرقة بيانات VPN، وتمكّن المهاجمون من فتح القواطع الكهربائية وإخراج محطات فرعية من الخدمة وكتابة برمجيات خبيثة لتعطيل الأوامر عن بُعد، ما أدّى إلى انقطاع الكهرباء عن نحو 230,000 شخص. وأُحبِطت هجمات أخرى، مثل الهجوم على محطة معالجة المياه في أولدسمار بولاية فلوريدا، حيث حاول المهاجمون زيادة تركيز هيدروكسيد الصوديوم في المياه إلى 100 ضعف القيمة الطبيعية.</p>
            <p>تطرّقت الأدبيات إلى الهجمات على ICS، وتشمل الهجمات على وحدات PLC لتغيير منطق التحكّم أو معلمات العملية، وتعديل البرمجيات الثابتة، أو تزوير قراءات الحساسات ضمن هجمات حقن البيانات الزائفة (FDI) لجمعها وإرسالها إلى PLC بقصد مهاجمة العملية الفيزيائية المتحكَّم بها. كما دُرست طرق اكتشاف الثغرات في برمجة PLC، وتطوير حلول تصحيحية، واكتشاف البرمجيات الخبيثة. واشتملت الدفاعات على حماية PLC باستخدام ثوابت التحكّم (علاقات قراءات الحساسات بأوامر PLC)، واستخراج قواعد منطق التحكّم، واكتشاف انتهاكات السلامة. وبالمثل، وُظِّفت حلول مُعتمِدة على ML لاكتشاف هجمات FDI.</p>
            <p>ولا تقتصر استخدامات ML في مجال ICS على كشف الهجمات، بل تُسهِم أيضًا في الرؤية الحاسوبية للفرز واللوجستيات والتعبئة، والصيانة التنبؤية عبر مراقبة حالة الآلات للتنبؤ بالأعطال وجدولة الإصلاحات، وتحسين الضبط عبر نماذج تُكيِّف استراتيجيات التحكّم آليًّا، وتحمل الأعطال واكتشاف الأخطاء.</p>
            <p>غالبًا ما تُبنى هذه الحلول المُعتمِدة على ML باستخدام لغات عالية المستوى، ولا يمكن تشغيلها إلا على وحدات PLC التي تدعم أنظمة تشغيل قادرة على تنفيذ برامج عامّة الغرض. وللأسف، تعمل أجهزة كثيرة بلا نظام تشغيل أو بأنظمة خاصة، ما يحول دون تنفيذ مثل هذه الحلول عليها. علاوةً على ذلك، كثيرًا ما تعمل هذه الحلول خارج الجهاز إمّا بجمع البيانات عبر الإنترنت أو دون اتصال، وبذلك يتعذّر نشرها عمليًّا لأن الأمر يتطلّب جهازًا إضافيًّا لكل PLC للوصول إلى مدخلات الحساسات التي يعتمد عليها حل ML. يوضّح الشكل <a href="#fig:traditional_setup">[fig:traditional_setup]</a> الوضع الحالي: إذ يجب أن تتلقى أي منظومة ML مدخلات العملية (غالبًا تناظرية) بشكل منفصل عن PLC، وتنفّذ الاستدلال وتكشف الشذوذ المحتمل، ثم يتعيّن على هذا الجهاز الخارجي (عادةً حاسوبًا عامًا) الاتصال بشبكة OT لتمرير نواتج الاستدلال، ما يزيد سطح الهجوم وإمكان الضرر.</p>
            <p>لِلتخلّص من ضرورة إدماج حاسوب عام ضمن دفاعات الأمان المُعتمِدة على ML، نقدّم في هذا العمل إطار ICSML؛ وهو إطار استدلال ML مُنفَّذ <em>محليًّا</em> بلغة Structured Text (ST)، وبالتالي متوافق مع أي جهاز يدعم معيار IEC 61131-3. وبما أنّ الإطار مبنيٌّ بـ ST، فهو يندمج مع أي مشروع IEC ويُمكّن من تنفيذ دفاعات مُعتمِدة على ML على الجهاز نفسه دون أجهزة خارجية إضافية، مع اتصال مباشر بمدخلات الحساسات المرسلة إلى الـ PLC. يتيح ICSML، كما في الشكل <a href="#fig:icsml_setup">[fig:icsml_setup]</a>، تنفيذ الاستدلال <em>داخل</em> الـ PLC دون 1) التضحية بدقة الاستدلال، 2) التأثير في التشغيل الاعتيادي للـ PLC، و3) الحاجة إلى دعم من الشركة المصنِّعة. يمكن تلخيص مساهماتنا كالآتي:</p>
            <ul>
                <li>صغنا مشكلة تنفيذ الاستدلال بكفاءة على وحدات PLC باستخدام لغات IEC 61131-3 عبر دراسة قيود التعبير في اللغات المتاحة، وبالالتفات إلى قيود عتاد PLC، ومتطلبات الزمن الحقيقي في بيئات ICS.</li>
                <li>طوّرنا إطار استدلال للتعلُّم الآلي يتجاوز قيود لغات IEC 61131-3 المتخصّصة ويُوفّر مجموعة كاملة من مكوّنات ML.</li>
                <li>قدّمنا منهجيّة شاملة لتنفيذ استدلال ML على PLCs، تشمل إعداد مجموعة البيانات، وبناء وتدريب النموذج على أطر ML الشائعة، ثم نقل النموذج إلى ICSML وتشغيله على PLC.</li>
                <li>قيّمنا أداء ICSML عبر سلسلة من اختبارات القياس التي تُبرز متطلبات الذاكرة وتحجيم الأداء مع حجم النموذج، إلى جانب تحسينات خاصّة بـ PLC.</li>
                <li>أظهرنا كفاءته وعدم تداخُله مع العملية من خلال دراسة حالة لدفاع واقعي على PLC لمحطة تحلية مياه بتقنية التبخير الومضي متعدّد المراحل (MSF).</li>
            </ul>
            <p><br></p>
        </section>
        <section id="preliminaries" class="level1">
            <h1>المبادئ الأساسية</h1>
            <section id="industrial-control-systems" class="level2">
                <h2>أنظمة التحكّم الصناعية</h2>
                <p>تشمل أنظمة التحكّم الصناعية (ICS) أنظمة التحكّم وأجهزة القياس المرتبطة بها التي تُراقب وتُدير وتتحكّم وتُؤتمت العمليات الفيزيائية الصناعية، وغالبًا ما تُستخدم في البُنى التحتية الحيوية. تُعدّ وحدات التحكّم المنطقية القابلة للبرمجة (PLCs) حجر الأساس في ICS، وهي أجهزة متكاملة ذات تصميم متين لضمان التشغيل الموثوق في البيئات الصناعية القاسية. تعمل PLCs وفق نموذج تشغيلي دوري يُعرف بدورة المسح (scan cycle)، حيث تَقرأ مدخلات الحساسات، وتُجري الحسابات بناءً على منطق التحكّم، وتُفعِّل المشغلات. يُبرمج منطق التحكّم في أجهزة PLC بواسطة مهندسي العمليات باستخدام مجموعة من لغات البرمجة المتخصّصة التي يحدّدها معيار IEC 61131.</p>
            </section>
            <section id="sec:languages" class="level2">
                <h2>لغات IEC 61131-3</h2>
                <p>يُعد IEC 61131 معيارًا دوليًّا لوحدات التحكّم القابلة للبرمجة. ويحدّد الجزء الثالث منه (IEC 61131-3) عدّة لغات برمجة، منها:</p>
                <p><strong>Ladder Diagram (LD):</strong> لغة رسومية منخفضة المستوى تُحاكي شكل السلم، تتكوّن من خطّين رأسيين تتصل بينهما خطوط أفقية تُسمّى الأعتاب (rungs). تُمثَّل المدخلات والمخرجات برموز «تلامس» و«ملفات» على الترتيب. تُناسب LD أكثر فِنيّي الصيانة محدودي الخبرة البرمجية.</p>
                <p><strong>Function Block Diagram (FBD):</strong> لغة رسومية تتألف من كُتل وظيفية (FB) مكتوبة بأيٍّ من لغات IEC 61131-3، وتُوصل بخطوط أفقية تُعرف بخطوط تدفّق الإشارة.</p>
                <p><strong>Sequential Function Chart (SFC):</strong> لغة رسومية تحدّد السلوك التسلسلي وقابلة للتكامل مع لغات IEC الأخرى. تُشير المربّعات المستطيلة إلى مراحل عملية التحكّم وتترابط عبر أسهم تدفّق.</p>
                <p><strong>Structured Text (ST):</strong> لغة نصّية عالية المستوى تُشبه Pascal، وتتيح برمجة وظائف معقّدة مواكبةً لتطوّر قدرات PLC.</p>
                <p>تتكوّن مشاريع IEC من كُتل برمجية تُسمّى وحدات تنظيم البرامج (POUs)، ويمكن برمجتها بأيٍّ من لغات IEC ثم استخدامها من قبل لغات IEC الأخرى، ما يجعل اللغات متوافقة فيما بينها. تشمل POUs «الدوال» (Functions) المُعرّفة بطريقة تُشبه دوال لغات البرمجة العامّة. وتُعد «كُتل الوظائف» (Function Blocks) وحدة أساسية أخرى وتعمل بصورة تُشبه الكائنات في البرمجة الكائنية، إذ تحتوي متغيرات ودوال تُجسّد الحالة والوظيفة. وتعمل «الواجهات» (Interfaces) في IEC 61131-3 بطريقة تُشبه واجهات اللغات الكائنية، وتُطبَّق عبر كُتل الوظائف. كما يدعم المعيار «الهياكل» (Structs) المُعرّفة على نحوٍ شبيه بهياكل لغة C.</p>
                <p>تضمّ الدوال وطرق كُتل الوظائف جزءًا ثابتًا لتعريف وتهيئة المتغيّرات. تُعرَّف المتغيّرات في قسم <code>VAR_INPUT</code> كوسائط إدخال، وفي <code>VAR_OUTPUT</code> كقيم إرجاع، وتُعدّ المتغيّرات في قسم <code>VAR</code> محلّية النطاق. وأخيرًا، تُستخدم متغيّرات <code>VAR_IN_OUT</code> للإدخال والإخراج معًا.</p>
            </section>
        </section>
        <section id="problem-formulation" class="level1">
            <h1>صياغة المشكلة</h1>
            <p>نستكشف في هذا العمل قدرة وحدات PLC على تنفيذ الاستدلال <em>بكفاءة</em> باستخدام لغات IEC 61131-3 للاستفادة من مزايا الاستدلال المُعتمِد على ML محليًّا على PLC. ويُعد تنفيذ الاستدلال على PLC تحدّيًا للأسباب التالية:</p>
            <ol>
                <li>تُكتب تطبيقات PLC بلغات برمجة متخصّصة ذات تعبيريّة محدودة وتُترجم إلى ملفات تنفيذية غير قياسية. وتفتقر هذه اللغات إلى إدارة ديناميكية للذاكرة، ولا تدعم الاستدعاء الذاتي (recursion)، وغيرها من القيود التي تتطلّب حلولًا مبتكرة لدعم الاستدلال المُعتمِد على ML بصورة صحيحة. سيُوضَّح ذلك في القسم <a href="#sec:limitations">3.1</a>.</li>
                <li>تتوفر وحدات PLC بتكوينات متباينة من حيث القدرة الحاسوبية، إذ تحتوي الغالبية على ذاكرة ومعالجات مدمجة محدودة، كما في القسم <a href="#ss:plchwlimitations">3.2</a>. لذا يجب أن تكون الأساليب المطوّرة خفيفة الوزن ولا تتداخل مع الهدف الأساسي للـ PLC، أي التحكّم والمراقبة.</li>
                <li>تتطلّب العمليات الصناعية عادةً استجابة في الزمن الحقيقي، حيث قد تكون دورة المسح (حلقة الاستشعار–الحوسبة–التفعيل) في حدود أجزاء من الثانية. لذا يجب أن يُراعى زمن الدورة عند تطوير الاستدلال، كما سيناقَش في القسم <a href="#ss:realtimeconstr">3.3</a>.</li>
            </ol>
            <section id="sec:limitations" class="level2">
                <h2>قيود لغات IEC 61131-3</h2>
                <p>يُفضي تنفيذ حلول التعلُّم الآلي لأنظمة التحكّم الصناعية وجميع وظائفها المرتبطة ضمن بيئة الشركة المصنِّعة للـ PLC باستخدام لغات IEC 61131-3 إلى تحدّيات ناجمة عن القيود المتأصّلة في هذه اللغات المتخصّصة. وبعد دراسة مزايا وعيوب جميع لغات IEC المتاحة، وجدنا أنّ Structured Text هي الأنسب لتطوير تطبيقات ML، إذ تُشبه لغات البرمجة التقليدية وتُعدّ الأكثر مرونة ضمن معيار IEC 61131-3. من أهم القيود في ST ما يلي:</p>
                <p><strong>غياب إدارة الذاكرة الديناميكية:</strong> مثل بقية لغات IEC 61131-3، تفتقر ST إلى إدارة الذاكرة ديناميكيًّا أثناء التشغيل، ما يمنع —من بين أمور أخرى— تخصيص مصفوفات ذات أطوال متغيرة.</p>
                <p><strong>تمرير المُدخلات بالقيمة:</strong> تُمرَّر المُدخلات إلى وحدات تنظيم البرامج (POUs) المُعرّفة تحت <code>VAR_INPUT</code> بالقيمة، أي تُنشأ نسخ من بيانات الإدخال لكل استدعاء.</p>
                <p><strong>الدوال لا يمكنها استدعاء كُتل الوظائف:</strong> تسمح ST بتمرير كتل الوظائف كوسائط إلى الدوال، لكن بغرض الوصول إلى بياناتها فحسب لا لاستدعاء طرقها.</p>
                <p><strong>عدم دعم الاستدعاء الذاتي (Recursion):</strong> يُحظَر الاستدعاء الذاتي المباشر أو غير المباشر في لغات IEC 61131-3، لأنّه يمنع حساب الحدّ الأقصى المطلوب من الذاكرة. ويمكن التحايل على فحوصات المُصرّف الثابتة بطرق مثل الاستدعاء غير المباشر، لكن ذلك غالبًا ما يؤدّي إلى تعطل البرنامج وقت التنفيذ.</p>
                <p><strong>عدم وجود دوال من الدرجة الأولى:</strong> لا تُعدّ الدوال في ST كائنات من الدرجة الأولى، وبالتالي لا يمكن تمريرها كوسائط إلى POUs. ويمنع هذا القيد استخدام البرمجة الوظيفية (FP) التي تُستعمَل كثيرًا في أطر ML لتشكيل خطوط معالجة البيانات وتكوين مكونات مثل طبقة Keras lambda.</p>
                <div class="table" id="tbl:plc_hardware">
                    <div class="table-responsive">
                        <table class="table table-striped table-sm align-middle">
                            <thead>
                                <tr>
                                    <th style="text-align: right;"><strong>الشركة المصنِّعة</strong></th>
                                    <th style="text-align: right;"><strong>النماذج</strong></th>
                                    <th style="text-align: right;"><strong>متوسط زمن تنفيذ التعليمة (<span class="math inline">\( \mu s \)</span>)</strong></th>
                                    <th style="text-align: right;"><strong>الذاكرة / RAM</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="text-align: right;">ABB</td>
                                    <td style="text-align: right;">AC500 PM57x/58x/59x/595/50xx/55x/56x</td>
                                    <td style="text-align: right;">FP:0.7/0.5/0.004/0.001/0.6/1200</td>
                                    <td style="text-align: right;">128–512KB / 512KB–1MB / 2–4MB / 16MB / 256KB–1MB / 128–512KB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Allen Bradley</td>
                                    <td style="text-align: right;">Micro 810/20/30/50/70, CL 5380, 5560/70/80</td>
                                    <td style="text-align: right;">2.5/0.3/0.3/0.3/0.3, N/A, N/A</td>
                                    <td style="text-align: right;">2/20/8–20/20/40KB, 600KB–10MB, 3–40/2–32/2–32MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Delta Electronics</td>
                                    <td style="text-align: right;">AS300, AH500</td>
                                    <td style="text-align: right;">1.6, 0.02 LD</td>
                                    <td style="text-align: right;">N/A, 128KB–4MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Eaton</td>
                                    <td style="text-align: right;">XC152, XC300</td>
                                    <td style="text-align: right;">N/A, N/A</td>
                                    <td style="text-align: right;">64MB, 512MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Emerson</td>
                                    <td style="text-align: right;">Micro CPUE05/001, RX3i CPE400/CPL410</td>
                                    <td style="text-align: right;">0.8 Bool/1.8, N/A</td>
                                    <td style="text-align: right;">64/34KB, 64MB/2GB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Fatek</td>
                                    <td style="text-align: right;">B1, B1z</td>
                                    <td style="text-align: right;">0.33, 0.33</td>
                                    <td style="text-align: right;">31KB, 15KB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Festo</td>
                                    <td style="text-align: right;">CECC-D/LK/S</td>
                                    <td style="text-align: right;">N/A</td>
                                    <td style="text-align: right;">16/16/44MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Fuji Electric</td>
                                    <td style="text-align: right;">SPH5000M/H/D/3000D/300/2000/200</td>
                                    <td style="text-align: right;">FP:0.0253/0.066/0.088/0.08/0.27/5600</td>
                                    <td style="text-align: right;">4/4/2/2/2MB / 128KB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Hitachi</td>
                                    <td style="text-align: right;">Micro EHV+, HX, EHV+</td>
                                    <td style="text-align: right;">N/A, 0.006 FP, 0.08</td>
                                    <td style="text-align: right;">1MB, 16MB, 2MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Honeywell</td>
                                    <td style="text-align: right;">ControlEdge R170 PLC</td>
                                    <td style="text-align: right;">N/A</td>
                                    <td style="text-align: right;">256MB ECC</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Mitsubishi Electric</td>
                                    <td style="text-align: right;">MELSEC iQ-R/Q/L</td>
                                    <td style="text-align: right;">0.0098 FP / 0.0016 LD / 0.065 LD</td>
                                    <td style="text-align: right;">4MB / 64–896KB / 64K Steps</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Panasonic</td>
                                    <td style="text-align: right;">FP 7/2SH/0R/X0/0H</td>
                                    <td style="text-align: right;">0.011/0.03/0.08–0.58/0.08–0.58/0.01</td>
                                    <td style="text-align: right;">1MB/20KB/64KB/16KB/64K Steps</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Rexroth (Bosch)</td>
                                    <td style="text-align: right;">XM21/22/42, VPB</td>
                                    <td style="text-align: right;">FP:0.026/0.013/0.02/0.02</td>
                                    <td style="text-align: right;">0.5/0.5/2/16GB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">Schneider Electric</td>
                                    <td style="text-align: right;">Modicon M221/241/251/262</td>
                                    <td style="text-align: right;">0.3/0.3/0.022/0.005</td>
                                    <td style="text-align: right;">256KB/64MB/64MB/32MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">SIEMENS</td>
                                    <td style="text-align: right;">SIMATIC S7-1200/1500</td>
                                    <td style="text-align: right;">2.3/0.006–0.384</td>
                                    <td style="text-align: right;">150KB / 150KB–4MB</td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">WAGO</td>
                                    <td style="text-align: right;">PFC100/200</td>
                                    <td style="text-align: right;">N/A, N/A</td>
                                    <td style="text-align: right;">256/512MB</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="caption">جدول 1: لمحة عن مواصفات نماذج مختارة من وحدات PLC (قِيَم كما تُورِدها الشركات المصنِّعة؛ قد تختلف بحسب الطراز/الإصدار).</div>
                </div>
            </section>
            <section id="ss:plchwlimitations" class="level2">
                <h2>قيود عتاد PLC</h2>
                <p>نظرًا لأن وحدات PLC تُنشر غالبًا في بيئات صناعية مترابطة وقاسية، فإن تصميمها يركّز عادةً على المتانة والكفاءة والاتصال والصلابة، أكثر من تضمين عتاد حاسوبي عالي الأداء.</p>
                <p>كما في الجدول <a href="#tbl:plc_hardware">[tbl:plc_hardware]</a>، تستخدم PLCs من الفئة الأساسية —مثل Allen Bradley Micro 810— معالجات منخفضة الاستهلاك وذاكرة محدودة (حتى 2 كيلوبايت فقط). أما وحدات PLC من الفئة المتوسطة —مثل Schneider Electric Modicon M241— فتضمّ معالجات متعدّدة النوى وذاكرة RAM موسّعة (نحو 64 ميجابايت). في حين تحتوي وحدات عالية الأداء —مثل WAGO PFC 200— عادةً على معالجات ARM أسرع وذاكرة RAM بسعة 512 ميجابايت.</p>
                <p>وبالنظر إلى الموارد المحدودة المتاحة على كثير من وحدات PLC، ينبغي كتابة تطبيقات ML لأنظمة ICS بكفاءة في استخدام المدخلات/المخرجات، وزمن المعالج، والذاكرة، لضمان التشغيل السلس وتحقيق مؤشرات الأداء المطلوبة دون التأثير في مهام ICS الأخرى.</p>
            </section>
            <section id="ss:realtimeconstr" class="level2">
                <h2>قيود الزمن الحقيقي</h2>
                <p>تتضمن عمليات ICS عادةً مهامًا دورية مثل حلقات التغذية الراجعة PID. ولذلك تعمل وحدات PLC وفق نموذج دوري يعتمد على تسلسل «دورة المسح». في بداية الدورة، تلتقط PLC قيم المُدخلات (عادةً قراءات الحساسات) وتحملها في الذاكرة لإجراء الحسابات. بعد ذلك، تُنفّذ تسلسل التعليمات المبرمجة باستخدام لغات IEC 61131-3. وأخيرًا، تُحدّث المُخرجات بناءً على النتائج، ويمكن استخدام هذه المُخرجات لتفعيل المشغّلات، أو جمع البيانات، وغيرها.</p>
                <p>قد يختلف طول دورة المسح المطلوبة حسب بيئة ICS. فمثلًا، قد يُطلب من PLCs التي تتحكّم في الروبوتات الصناعية الاستجابة خلال أجزاء من الثانية، لا سيّما في سياقات سلامة الإنسان. أمّا العمليات البتروكيميائية الأبطأ، فقد تُدار بدورات مسح قد تمتدّ لثوانٍ.</p>
                <p>يُحدَّد عدد الحسابات التي تُجرى في دورة مسح واحدة بطول الدورة وقوة المعالجة المتاحة على الـ PLC. وقد يؤدّي انتهاك متطلبات الزمن الحقيقي التي تفرضها دورة المسح إلى عواقب وخيمة على العملية الصناعية.</p>
            </section>
        </section>
        <!-- بقية الأقسام تُترجم وتُحرَّر بالأسلوب العلمي الدقيق نفسه، مع الحفاظ على المصطلحات التقنية والاتساق الأسلوبي. -->
        <section id="conclusion" class="level1">
            <h1>الخلاصة</h1>
            <p>درسنا في هذا العمل الحاجة إلى تنفيذ الاستدلال المُعتمِد على التعلُّم الآلي محليًّا على وحدات التحكّم المنطقية القابلة للبرمجة (PLCs). استعرضنا متطلبات وتحدّيات تشغيل تطبيقات ML في أنظمة التحكّم الصناعية على وحدات PLC، وبنينا على ذلك إطارًا للتعلُّم الآلي باستخدام لغات IEC 61131-3. ثم قدّمنا منهجيّة شاملة لبناء ونقل نماذج ML إلى الإطار المُقترَح. بعد ذلك، استعرضنا أداء الإطار عبر سلسلة من اختبارات القياس، وقارَنّاه بإطار الاستدلال TensorFlow Lite. وأخيرًا، عرضنا قدراته وأكدنا عدم تداخُله مع العملية الأساسية من خلال تطوير دراسة حالة لدفاع مُعتمِد على ML لعملية تحلية المياه بتقنية التبخير الومضي متعدّد المراحل (MSF).</p>
        </section>
        <section id="resources" class="level1 unnumbered">
            <h1 class="unnumbered">الموارد</h1>
            <p>إطار ICSML مفتوح المصدر: <a href="https://github.com/momalab/ICSML" class="uri">https://github.com/momalab/ICSML</a></p>
        </section>
        <hr style="margin: 40px 0;">
        <div class="text-muted text-center">
            <small>
                تم تحويل هذا الإصدار من HTML تلقائيًّا من LaTeX.<br>
                تُعرَض المعادلات الرياضية باستخدام MathJax.
            </small>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>