<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Naoufal El Bekri, Lucas Drumetz, Franck Vermet">
  <title>تَدَفُّقات التَّطْبِيعِ المُعَدَّلة زَمَنِيًّا لنمذجةِ المُعادَلاتِ التَّفاضُلِيَّةِ العَشْوائِيَّةِ بِدِقَّة</title>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
    body {
      direction: rtl;
      font-size: 22px;
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding: 0;
      line-height: 1.7;
    }
    header {
      background: linear-gradient(90deg, #3a6073 0%, #16222a 100%);
      color: #fff;
      padding: 40px 0 20px 0;
      text-align: center;
      margin-bottom: 30px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    }
    h1.title {
      font-size: 2.4em;
      font-weight: 700;
      margin-bottom: 12px;
      letter-spacing: 0.5px;
      line-height: 1.3;
    }
    .author {
      font-size: 1.05em;
      margin-top: 8px;
      color: #e0e0e0;
      letter-spacing: 0.3px;
    }
    nav.toc {
      background: #fff;
      border: 1px solid #e6ecf1;
      border-right: 4px solid #3a6073;
      margin: 0 auto 35px auto;
      max-width: 1000px;
      padding: 12px 18px;
      border-radius: 6px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.04);
    }
    nav.toc ul {
      margin: 0.2em 1em 0.2em 0;
      padding: 0 1em 0 0;
      list-style: none;
      display: flex;
      flex-wrap: wrap;
      gap: 0.8em 1.4em;
    }
    nav.toc a {
      color: #2c3e50;
      text-decoration: none;
      padding: 2px 6px;
      border-radius: 4px;
      background: #f3f6f9;
    }
    nav.toc a:hover { background: #e8eef4; }
    main { max-width: 1000px; margin: 0 auto; padding: 0 18px 40px 18px; }
    h1, h2, h3 {
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      font-weight: 700;
      color: #2c3e50;
      margin-top: 1.7em;
      margin-bottom: 0.7em;
      line-height: 1.2;
    }
    h1 {
      font-size: 2em;
      border-bottom: 2px solid #3a6073;
      padding-bottom: 0.2em;
      margin-bottom: 1em;
    }
    h2 {
      font-size: 1.35em;
      border-right: 4px solid #3a6073;
      padding-right: 0.5em;
      margin-bottom: 0.7em;
      margin-top: 1.5em;
    }
    h3 {
      font-size: 1.1em;
      color: #34495e;
      margin-bottom: 0.5em;
    }
    p {
      margin: 0 0 1.2em 0;
      text-align: justify;
    }
    code, pre {
      font-family: 'Fira Mono', 'Consolas', 'Courier New', monospace;
      background: #f3f3f3;
      color: #c7254e;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.95em;
    }
    pre {
      background: #f3f3f3;
      padding: 1em;
      overflow-x: auto;
      border-radius: 6px;
      margin: 1em 0;
    }
    .math.display {
      display: block;
      background: #f3f3f3;
      border-radius: 6px;
      padding: 1em;
      margin: 1.2em 0;
      direction: ltr;
      text-align: left;
      overflow-x: auto;
    }
    .math.inline {
      background: #f3f3f3;
      border-radius: 4px;
      padding: 0 4px;
      font-size: 0.95em;
      direction: ltr;
      display: inline-block;
    }
    ul, ol {
      margin: 1em 2em 1em 0;
      padding: 0 1.5em 0 0;
    }
    li { margin-bottom: 0.5em; }
    blockquote {
      border-right: 4px solid #3a6073;
      background: #f0f4f8;
      color: #555;
      margin: 1.5em 0;
      padding: 1em 1.5em;
      border-radius: 6px;
      font-size: 1em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 2em 0;
      background: #fff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 0.7em 1em;
      text-align: center;
    }
    th {
      background: #3a6073;
      color: #fff;
      font-weight: 700;
    }
    tr:nth-child(even) { background: #f7f7f7; }
    a { color: #3a6073; text-decoration: none; transition: color 0.2s; }
    a:hover { color: #16222a; text-decoration: underline; }
    .nodecor { text-decoration: none !important; color: inherit !important; }
    @media (max-width: 700px) {
      body { font-size: 18px; }
      header { padding: 25px 0 10px 0; }
      h1.title { font-size: 1.3em; }
      h1 { font-size: 1.2em; }
      h2 { font-size: 1em; }
      table, th, td { font-size: 0.95em; }
      nav.toc ul { flex-direction: column; gap: 0.4em; }
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">تَدَفُّقات التَّطْبِيعِ المُعَدَّلة زَمَنِيًّا لنمذجةِ المُعادَلاتِ التَّفاضُلِيَّةِ العَشْوائِيَّةِ بِدِقَّة</h1>
  <p class="author"><span class="nodecor">Naoufal El Bekri</span>, <span class="nodecor">Lucas Drumetz</span>, <span class="nodecor">Franck Vermet</span></p>
</header>

<nav class="toc" aria-label="جدول المحتويات">
  <ul>
    <li><a href="#ملخص">المُلَخَّص</a></li>
    <li><a href="#مقدمة">المُقَدِّمَة</a></li>
    <li><a href="#الخلفية">الخلفيّة</a></li>
    <li><a href="#tcnf">التدفّق المُعَدَّل زمنيًّا (TCNF)</a></li>
    <li><a href="#quantResults">التجارب</a></li>
    <li><a href="#conclusion">الخُلاصة</a></li>
  </ul>
</nav>

<main>
<h1 id="ملخص">المُلَخَّص</h1>
<p>أَصبحت النماذجُ التوليدية ذاتَ أهمّيةٍ متزايدة في تعلُّم الآلة ونماذج التعلُّم العميق. من بين هذه النماذج تبرز تدفُّقاتُ التطبيع، التي تُتيح تقديرَ الاحتمالية بدقّة عبر تحويل توزيعٍ أساسي بواسطة تحويلاتٍ تقابلية قابلة للاشتقاق. وقد تمّ توسيع إطارِ عمل تدفّق التطبيع ليشمل تدفّقاتٍ مُفهرسةً بالزمن، ما أدى إلى ظهور تدفّقاتِ التطبيع الديناميكية، وهي أداةٌ قوية لنمذجة السلاسل الزمنية والعمليات العشوائية والمعادلات التفاضلية العشوائية العصبية. في هذا العمل نقترح مُتغيِّرًا جديدًا من تدفّقات التطبيع الديناميكية، هو التدفّق المُعَدَّل زمنيًّا (TCNF)، قائمٌ على تغييرٍ زمنيٍّ لحركة براونية، وهو ما يُنتِج عائلةً غنيّة ومتنوّعة من العمليات الغاوسية. يُمكِّننا هذا النهج من نمذجة بعض المعادلات التفاضلية العشوائية التي تعجز النُّهُج الأخرى عن نمذجتها، بما في ذلك الحالات القياسية مثل عملية أورنشتاين–أولنبيك المعروفة، كما يُعمِّم المنهجيات السابقة ويؤدّي إلى نتائج مُحسّنة وقدرة أفضل على الاستدلال والتنبّؤ.</p>

<h1 id="مقدمة">المُقَدِّمَة</h1>
<p>تُستَخدَم الأنظمةُ الديناميكية على نطاقٍ واسع في مجالاتٍ علميةٍ متعدّدة مثل المالية وعلوم الأرض والفيزياء. ويشتمل تمثيلُ هذه الأنظمة عادةً على معادلاتٍ تفاضليةٍ عادية أو عشوائية (<span class="nodecor">oksendal2013stochastic</span>) لأخذ الضوضاء والاضطرابات في الحسبان إلى جانب المكوّن الحتمي. من تطبيقاتها الحاسمة نمذجةُ التقلّبات في البيانات المالية، أو تقديرُ الشكوك ونشرُها في علوم الأرض. ويُعَدُّ التعامُل مع هذه الأنظمة عبر نمذجة السلاسل الزمنية وتعلُّم الآلة نهجًا ازدادَت شعبيته مؤخرًا، بفضل النماذج التوليدية، لأغراض التنبّؤ والتصفية والاستيفاء مع مراعاة الشك.</p>
<p>تشمل النماذجُ التوليدية الشائعة الشبكاتِ العصبيةَ التوليديةَ الخصمية (<span class="nodecor">conf/nips/GoodfellowPMXWOCB14</span>) والمُشَفِّراتِ التلقائيةَ الاختلافية (<span class="nodecor">journals/corr/KingmaW13</span>)، وكذلك تدفّقات التطبيع (<span class="nodecor">jmlr/PapamakariosNRM21, journals/pami/KobyzevPB21</span>) والنماذجَ المبنيّة على الانتشار/التسجيل (<span class="nodecor">conf/nips/SongE19</span>). وعلى الرغم من إمكان تطبيق هذه النماذج لتوليد السلاسل الزمنية، فإنها ليست الأنسب لهذه المهمّة لأنها تتعامل مع هذه البيانات كمتجهات في <span class="math inline">\(\mathbb{R}^{T}\)</span>، حيث <span class="math inline">\(T\)</span> هو عددُ الخُطوات الزمنية، من دون مراعاة البنية السببية. وقد أُجريت تكييفات للشبكات العصبية التوليدية الخصمية وللمُشَفِّرات التلقائية الاختلافية ولتدفّقات التطبيع لبيانات السلاسل الزمنية في (<span class="nodecor">conf/nips/YoonJS19, kidger2021neural</span>)، و(<span class="nodecor">li2020scalable, zeng2023latent</span>)، و(<span class="nodecor">mehrasa2019point, conf/iclr/ShchurBG20</span>) على التوالي. نركّز في هذا العمل على تدفّقات التطبيع لقدرتها على إتاحة احتمالاتٍ صريحة، وهو أمرٌ حاسم للتطبيقات التي تتطلّب تقدير الشكوك أو كشف الشذوذ.</p>
<p>تعتمد تدفّقات التطبيع على صيغةِ تغيير المتغيّرات المعروفة التي تُوفِّر تعبيرًا عن دالّة الكثافة الاحتمالية لتحويلٍ تقابلي قابل للاشتقاق لمتغيّرٍ عشوائي. وباختيار التحويلات (أو تراكيبها) بعناية، إذا كانت الكثافةُ الأساسية قابلةً للتعامل معها (احتمالٌ صريح وأخذُ عيناتٍ سهل، في معظم الحالات غاوسية)، أمكن التلاعب بالكثافة المحوَّلة والأخذُ منها بسهولة أيضًا، شريطة إمكان حساب يعقوبي التحويل بكفاءة. وعند النظر في الحدّ النظري حيث يُطبَّق عددٌ لا نهائي من التحويلات، نحصل على تدفّق التطبيع المستمر (<span class="nodecor">DBLP:conf/iclr/GrathwohlCBSD19</span>). في هذه الحالة يُوصَف تدفّقُ التطبيع بمعادلةٍ تفاضليةٍ عادية يمكن تكاملُها للحصول على الكثافة الناتجة، ما يزيد كفاءةَ الحساب لهذه الفئة من النماذج عبر استبدال مُحدَّد اليعقوبي بتكامل أَثَرِه.</p>
<p>تمّ توسيع تدفّقات التطبيع إلى الإعداد الديناميكي باستبدال التوزيع الأساسي القابل للتعامل بعمليةٍ <em>عشوائية</em> قابلةٍ للتعامل، هي حركة براونية (<span class="nodecor">deng2020modeling</span>)، ما يجعل هذا النوع من النماذج أكثر ملاءمةً لتوليد السلاسل الزمنية. ومع ذلك، لوحظ في (<span class="nodecor">deng2021continuous</span>) أنّ هذه النماذج غيرُ قادرةٍ نظريًّا على تمثيل بعض العمليات الأساسية والشائعة، مثل عملية أورنشتاين–أولنبيك الكلاسيكية.</p>
<p>لذلك نقترح في هذه الورقة تعميمًا لهذا النهج عبر استخدام عائلةٍ كبيرة من العمليات الغاوسية كعمليةٍ أساسية بدلًا من الحركة البراونية التقليدية. تُبنى هذه العمليات الغاوسية عبر تغييرٍ زمني للحركة البراونية القياسية، ما يؤدّي إلى التدفّق المُعَدَّل زمنيًّا (TCNF)، وهو نموذج يمتلك خصائصَ رياضيةً تُمكِّنه من وصف الديناميكيات والمعادلات التفاضلية العشوائية التي تعجز النماذجُ السابقة المبنيّة على التدفّق عن التقاطها، مع الحفاظ على تعبيرية تدفّقات التطبيع الديناميكية. نؤكّد هذه النتائج من خلال تجارب عديدة على عملياتٍ معروفة.</p>
<p>تُنظَّم بقيةُ الورقة على النحو الآتي: نقدّم أولًا، في القسم [background]، لمحةً عن المعادلات التفاضلية العشوائية العصبية، حيث الانجراف والانتشار كلاهما شبكاتٌ عصبية، ونهجَ عملية التدفّق بالزمن المستمر (CTFP) ومناقشةً لقيود هذه النماذج الجوهرية. بعد ذلك، في القسم [tcnf]، نعرض نموذجنا ونصفُ خصائصه وخوارزمية التدريب. أخيرًا، نعرض النتائجَ الكمية في القسم [quantResults] ونقارنها بنماذجَ أخرى مبنيّةٍ على التدفّق، ثم نقدّم الملاحظات الختامية في القسم [conclusion].</p>

<h1 id="الخلفية">الخلفيّة</h1>
<h2 id="الأعمال-ذات-الصلة">الأعمال ذات الصلة</h2>

<h2 id="معادلات-التفاضلية-العشوائية-العصبية">المعادلاتُ التفاضليةُ العشوائيةُ العصبية</h2>
<p>نعتبر فضاءً احتماليًّا مُفلترًا <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> وأفقًا زمنيًّا <span class="math inline">\(T\)</span>. وتُعرَّف عمليةُ الانتشار <span class="math inline">\(X = \{X_t\}_{t\in [0, T]}\)</span> بواسطة معادلةِ إيتو التفاضلية العشوائية (SDE): <span class="math display">\[
\begin{aligned}
\label{eq:EDS_X}
    dX_t = \mu(X_t, t)dt + \sigma(X_t,t)dW_t, \quad t\in [0, T]
\end{aligned}
\]</span> حيث <span class="math inline">\(W = \{W_t\}_{t\in [0, T]}\)</span> عمليةُ فاينر (حركة براونية) معيارية متكيفة ذات أبعاد <span class="math inline">\(m\)</span>. والدالتان <span class="math inline">\(\mu:\mathbb{R} ^d \times [0,T] \longrightarrow \mathbb{R} ^d\)</span> و<span class="math inline">\(\sigma:\mathbb{R} ^d \times [0,T] \longrightarrow \mathbb{R} ^{d\times m}\)</span> هما مُعامِلا الانجراف والانتشار على التوالي. وعندما يُمثَّل <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> بواسطة الشبكات العصبية يُسمّى الـ SDE عصبيًّا (<span class="nodecor">tzen2019neural</span>, <span class="nodecor">liu2019neural</span>).</p>
<p>اقتُرحت أعمالٌ عديدة لتعلُّم الـ SDEs العصبية باستعمال أطر نمذجةٍ توليدية مختلفة تشمل المُشَفِّراتِ التلقائيةَ الاختلافية (VAEs) (<span class="nodecor">li2020scalable</span>, <span class="nodecor">zeng2023latent</span>) والشبكاتِ التوليديةَ الخصمية (GANs) (<span class="nodecor">kidger2021neural</span>). نركّز في هذه الورقة على نموذج تدفّق التطبيع.</p>

<h2 id="تدفقات-التطبيع">تدفّقات التطبيع</h2>
<p>تدفّقُ التطبيع (<span class="nodecor">jmlr/PapamakariosNRM21</span>, <span class="nodecor">journals/pami/KobyzevPB21</span>, <span class="nodecor">DBLP:conf/iclr/GrathwohlCBSD19</span>) هو تحويلٌ مُصمَّم لنمذجة متغيّرٍ عشوائي <span class="math inline">\(X\)</span> وتوزيعِه المعقّد <span class="math inline">\(p_X\)</span> عبر توزيعٍ أساسي <span class="math inline">\(p_Z\)</span> ودالّةٍ تقابلية قابلةٍ للاشتقاق <span class="math inline">\(f:\mathbb{R} ^d  \longrightarrow \mathbb{R} ^d\)</span>. وتُتيح هذه النمذجة تقديرَ الكثافة بدقّة وأخذَ عيناتٍ بكفاءة، باستخدام صيغة تغيير المتغيّرات لـ <span class="math inline">\(X=f(Z)\)</span>:</p>
<p><span class="math display">\[
\log p_X(x) = \log p_Z(z) - \log \left|\det J_{f}(z)\right|
\]</span></p>
<p>حيث اليعقوبي <span class="math inline">\(J_f(z) = \left[\frac{\partial f_i}{\partial z_j} \right]_{1\leq i,j \leq d}\)</span> هو مصفوفة <span class="math inline">\(d\times d\)</span> لجميع المشتقات الجزئية لـ <span class="math inline">\(f\)</span>.</p>
<p>وقد وَسَّعت الأعمالُ السابقةُ هذا الإطارَ لنمذجة السلاسل الزمنية والعمليات العشوائية باستخدام تحويلٍ مستمرٍّ مُفهرسٍ بالزمن <span class="math inline">\(F(., t)\)</span> إلى جانب حركة براونية كعمليةٍ أساسية، ما أفضى إلى «عملية التدفّق بالزمن المستمر» (<span class="nodecor">deng2020modeling</span>): <span class="math display">\[
\begin{aligned}
    X_t = F(W_t, t).
\end{aligned}
\]</span></p>
<p>وتقترح طريقةٌ أخرى (<span class="nodecor">deng2021continuous</span>) دمجَ الديناميكيات الكامنة لعملية أورنشتاين–أولنبيك مع تدفّق التطبيع لنمذجة المعادلات التفاضلية العشوائية بفاعلية.</p>
<p>لقد برهنت هذه النماذجُ على فاعلية تدفّقات التطبيع الديناميكية في التقاط السلوك المعقّد لأنواعٍ مختلفة من العمليات العشوائية والمعادلات التفاضلية العشوائية. غير أنّ لهذه النماذج قيودًا جوهريةً مهمّة. إذ تنشأ إحدى القيود عند تطبيق لِمَّا إيتو على عملية التدفّق بالزمن المستمر لاشتقاق عملية أورنشتاين–أولنبيك الأحادية الموصوفة بالمعادلة:</p>
<p><span class="math display">\[
\begin{aligned}
\label{eq:ou}
    dY_t = -a(Y_t - b)dt + \sigma dW_t
\end{aligned}
\]</span></p>
<p>فإنّ تطبيق لِمَّا إيتو على <span class="math inline">\(F(W_t,t)\)</span> يعطي: <span class="math display">\[
\begin{aligned}
\label{eq:NF-OU}
\begin{split}
 dF(W_t,t) = & \frac{\partial F}{\partial t}(W_t,t)dt + \frac{\partial F}{\partial x}(W_t,t)dW_t  \\
 & + \frac{1}{2}\frac{\partial^2 F}{\partial x^2}(W_t,t)dt
\end{split}
\end{aligned}
\]</span></p>
<p>وبالمقارنة بين المعادلتين نَستلزم لنمذجة عملية أورنشتاين–أولنبيك أن يكون <span class="math inline">\(\frac{\partial F}{\partial x}(W_t,t) = \sigma \)</span>، ما يعني أنّ <span class="math inline">\(F(W_t, t) = \sigma W_t + g(t)\)</span> حيث <span class="math inline">\(g\)</span> دالةٌ قابلةٌ للاشتقاق. لكن باشتقاق هذه العلاقة بالنسبة إلى <span class="math inline">\(t\)</span> وإدخالها في المعادلة ينتج الشرط التالي: <span class="math display">\[
\begin{aligned}
\label{OUabsurde}
    \frac{dg}{dt}(t) +a g(t) -a b= -a\sigma W_t
\end{aligned}
\]</span> وهو شرطٌ غيرُ قابلٍ للتحقيق لأن الطرف الأيسر دالةٌ حتمية في <span class="math inline">\(t\)</span>، بينما الطرف الأيمن دالةٌ عشوائية تعتمد على <span class="math inline">\(W_t\)</span>. وعليه تُظهِر عمليةُ التدفّق بالزمن المستمر قيودًا وتفشل في نمذجة بعض العمليات العشوائية بفاعلية.</p>
<p>في القسم التالي نقترح نموذجًا يُعالِج هذا القيد ويُحقِّق نتائجَ مُحسّنة.</p>

<h1 id="tcnf">تدفّق التطبيع الديناميكي مع تغيير الزمن</h1>
<h2 id="تدفق-التطبيع-المتغير-بالزمن">تدفّق التطبيع المُتغيِّر بالزمن</h2>
<p>نقترح نمذجةَ عمليةٍ عشوائيةٍ مُلاحَظة، نرمز لها بـ <span class="math inline">\(X = \{X_t\}_{t\in [0, T]}\)</span>، عبر دمج تدفّق التطبيع مع حركة براونية مُغَيَّرة زمنيًّا لِالتقاط سلوك المتغيّر <span class="math inline">\(X_t\)</span> استنادًا إلى سلسلةٍ زمنيةٍ مُلاحَظة <span class="math inline">\(\{(x_{t_i},t_i)\}_{i=1}^n\)</span>. نتناول صراحةً الحالة أحاديةَ البعد، مع الإشارة إلى أنّ الإطار يمتدّ بسهولة إلى الحالة متعدّدة الأبعاد حيث يتطلّب كلُّ بُعدٍ تغييرًا زمنيًّا خاصًّا. نقدّم مفهوم «تدفّق التطبيع المُتغيِّر بالزمن» (TCNF) المُعرَّف كما يلي:</p>
<p><span class="math display">\[
\begin{aligned}
    X_t = f_\theta \left(W_{\phi(t)},\phi(t)\right), \quad \forall t \in [0,T],
\end{aligned}
\]</span></p>
<p>حيث <span class="math inline">\(f_\theta(.,t):\mathbb{R}  \longrightarrow \mathbb{R}\)</span> تحويلٌ قابلٌ للاشتقاق مُعلَّمٌ بـ <span class="math inline">\(\theta\)</span>، و<span class="math inline">\(W_{\phi(t)}\)</span> حركةٌ براونية مع تغييرٍ زمني (<span class="nodecor">revuz2013continuous</span>). ويُعطى التغييرُ الزمني بدالّة <span class="math inline">\(\phi : \mathbb{R} ^{+} \longrightarrow \mathbb{R} ^{+}\)</span> قابلةٍ للقياس، موجبةٍ ومتزايدةٍ غيرِ ناقصة. تضمن القابليةُ للقياس والإيجابيةُ سلامةَ تعريف <span class="math inline">\(W_{\phi(t)}\)</span>، بينما يضمن التزايدُ عدمَ سلبية فروق الأوقات ومن ثمّ سلامةَ التباينات. للتغيير الزمني تطبيقاتٌ مهمّة إذ يُنتج عائلةً من العمليات الغاوسية أعمَّ من الحركة البراونية. كما تؤكّد نظريةُ دامبيس–دوبينز–شوارتز (<span class="nodecor">revuz2013continuous</span>) هذه الخاصيّة إذ تنصّ على أنّ كلَّ مارتينجالٍ محليٍّ مُستمر يمكن تمثيلُه كحركةٍ براونية مُغَيَّرةٍ زمنيًّا.</p>
<p>وعليه، بجعل العملية الأساسية في نموذجنا حركةً براونية مُغَيَّرةً زمنيًّا، نلتقط طيفًا واسعًا يشمل جميع المارتينجالات المحلية المُستمرة، ونُعمِّم إعداد CTFP. في الواقع، يمكن كتابة حلّ عملية أورنشتاين–أولنبيك كما يلي: <span class="math display">\[
\begin{aligned}
    Y_t = Y_0e^{-at} + b(1-e^{-at}) + \frac{\sigma e^{-at}}{\sqrt{2a}}W_{e^{2at}-1}
\end{aligned}
\]</span> وهو تمثيلٌ ملائم يمكن لنموذج TCNF التقاطُه بصورةٍ صحيحة. كما يمكن التعبيرُ عن حالاتٍ أكثر عمومية — مثل العمليات ذات التقلب المعتمد على الزمن — عبر تغييرٍ زمني، وبالتالي يمكن نمذجتُها بواسطة TCNF. وأخيرًا، لأجل <span class="math inline">\(\phi(t) = t\)</span> نستعيد إعدادَ CTFP، المناسبَ لنمذجة المعادلات التفاضلية العشوائية التي لا تتطلّب تغييرًا زمنيًّا مثل الحركة البراونية الهندسية (<span class="nodecor">oksendal2013stochastic</span>).</p>

<h2 id="دالة-تغيير-الوقت">دالّةُ تغيير الزمن</h2>
<p>للتعامُل مع دالّة تغيير الزمن نستخدم شبكةً عصبيةً أحاديةَ النِّسْب (Monotone) تضمن مُشتقًّا موجبًا، أي إخراجًا أحاديَّ الاتجاه. على وجه التحديد نستخدم بنية (<span class="nodecor">M-MGN</span>) (<span class="nodecor">chaudhari2023learning</span>) المبنيّة على وحدات شبكة عددُها <span class="math inline">\(K\)</span> ومعرّفة كما يلي: <span class="math display">\[
\begin{aligned}
\begin{split}
    \Tilde{t}_k &= W_k\times t + b_k, \\
    \text{M-MGN}(t) &= a + V^\top V t + \sum_{k=1}^K s_k(\Tilde{t}_k) \times W_k^\top \sigma_k(\Tilde{t}_k)
\end{split}
\end{aligned}
\]</span></p>
<p>حيث <span class="math inline">\(W_k, b_k \in \mathbb{R} ^{l \times 1}\)</span> هما — على التوالي — مُتَّجهَا الوزن والانحياز للطبقة <span class="math inline">\(k^{\text{th}}\)</span>، و<span class="math inline">\(\sigma_k:\mathbb{R} ^l \longrightarrow \mathbb{R} ^l\)</span> دالّةُ التنشيط، و<span class="math inline">\(s_k :\mathbb{R} ^l \longrightarrow \mathbb{R}\)</span> مُكاملُها الأوّلي. كذلك <span class="math inline">\(a  \in \mathbb{R}\)</span> و<span class="math inline">\(V \in \mathbb{R} ^{l \times 1}\)</span> مُعامِلان إضافيان للشبكة. وبما أنّ خرج (<span class="nodecor">M-MGN</span>) ليس موجبًا بالضرورة، نُطبِّق إزاحةً للخرج لضمان أن يكون التغييرُ الزمني موجبًا.</p>

<h2 id="خوارزميه-التدريب">خوارزميةُ التدريب</h2>
<p>الهدف هو تدريب <span class="nodecor">TCNF</span> لتعظيم دالّة الاحتمال اللوغاريتمية لمجموعة البيانات المُلاحَظة <span class="math inline">\(\{(x_{t_i},t_i)\}_{i=1}^n\)</span>: <span class="math display">\[
\begin{aligned}
\label{eq:LL}
    L = \log p_{X_{t_1}, ..., X_{t_n}}(x_{t_1}, ..., x_{t_n})
\end{aligned}
\]</span> لحساب هذه الكميّة نستخدم صيغةَ تغيير المتغيّر ونستفيد من استقلالية زيادات <span class="math inline">\(W_{\phi(t_i)} - W_{\phi(t_{i-1})}\)</span>. وعليه تُكتَب دالّةُ الاحتمال اللوغاريتمية كما يلي: <span class="math display">\[
\begin{aligned}
\begin{split}
    L = \sum_{i=1}^n & \log p_{W_{\phi(t_i)}|W_{\phi(t_{i-1})}}\left(w_{\phi(t_i)}\right) \\
    &- \log \left|\det \frac{\partial f_\theta \left(w_{\phi(t_i)},\phi(t_i)\right)}{\partial W_{\phi(t_i)}} \right|,
\end{split}
\end{aligned}
\]</span> حيث <span class="math inline">\(w_{\phi(t_i)} = f_\theta ^{-1} \left(x_{t_i}; \phi(t_i)\right)\)</span> و<span class="math inline">\(p_{W_{\phi(t_i)}|W_{\phi(t_{i-1})}}\)</span> يرمز إلى التوزيع الغاوسي الشرطي بمتوسط <span class="math inline">\(W_{\phi(t_{i-1})}\)</span> وتباين <span class="math inline">\(\phi(t_i)- \phi(t_{i-1})\)</span>. وهذا يُشكِّل فرقًا بارزًا عن دالّة الاحتمال اللوغاريتمية لـ <span class="nodecor">CTFP</span> التي تستخدم تباينًا <span class="math inline">\(t_i - t_{i-1}\)</span> بدلًا من <span class="math inline">\(\phi(t_i)- \phi(t_{i-1})\)</span>.</p>

<h1 id="quantResults">التجارب</h1>
<h2 id="مجموعات-البيانات-التجريبية">مجموعاتُ البيانات التجريبية</h2>
<p>لتقييم أداء النموذج المقترَح أجرينا تجاربَ على ثلاث مجموعات بياناتٍ تجريبية تتكوّن من سلاسل زمنية أحادية البعد (دون وحدات). جرى توليد هذه المجموعات بأخذ عيناتٍ من ثلاث عملياتٍ عشوائية مختلفة. كما استخدمنا في تجاربنا هيكلًا مماثلًا لهندسة عملية التدفّق بالزمن المستمر (CTFP)، مستفيدين من تحويلاتٍ طبيعيةٍ مستمرة.</p>
<p>تمّ إنشاء المجموعة الأولى (<strong>Toy-SDE1</strong>) بتقطيع عمليةِ أورنشتاين–أولنبيك، وفق المعادلة: <span class="math inline">\(dX_t = -\theta(X_t - \mu)dt + \sigma dW_t\)</span>، حيث يمثّل <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> المُعامِلين الثابتين لمصطلحي الانجراف والتقلب على التوالي، ويُعبِّر <span class="math inline">\(\theta\)</span> عن سرعة تقارُب مسار العيّنة نحو مستوى الانجراف. وتهدف هذه المجموعة إلى تقييم قدرة النموذج على التقاط ديناميكياتٍ ذات تغيّر زمني.</p>
<p>تمّ إنشاء المجموعة الثانية (<strong>Toy-SDE2</strong>) استنادًا إلى المعادلة: <span class="math inline">\(dX_t = -\theta(X_t - \mu)dt + \sigma \sqrt{t}dW_t\)</span>، التي تصف أورنشتاين–أولنبيك بمعاملِ انتشارٍ مُعتمِدٍ على الزمن، وتُستَخدَم لاختبار قدرة النموذج على التقاط تحوّلاتٍ زمنيةٍ أعلى تعقيدًا. وتكتسب هذه الـ SDE أهمّيةً لأنّها شائعةُ الاستعمال في النماذج القائمة على الدرجات (<span class="nodecor">yang2022diffusion</span>)، حيث تُدخَل الضوضاء تدريجيًّا خلال التدريب.</p>
<p>أخيرًا، تشمل المجموعة الثالثة (<strong>Toy-SDE3</strong>) حركةً براونيةً هندسية، وفق المعادلة: <span class="math inline">\(dX_t = \mu X_t dt + \sigma X_t dW_t\)</span>، حيث يمثّل <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> المُعامِلين الثابتين للانجراف والتقلب على التوالي. وقد صُمِّمت هذه المجموعة لإظهار قدرة CTFP على التعامل مع الـ SDEs التي لا تتطلّب تغييرًا زمنيًّا، وبالتالي تعلُّم الدالة البسيطة <span class="math inline">\(\phi(t) = t\)</span>، ما يُبيّن أنّ نهجنا يُحيط بإطار CTFP كحالةٍ خاصّة.</p>
<p>أجرينا المقارنةَ الكمية بمقارنة تقديرات المتوسط <span class="math inline">\(m_{X_t}\)</span>، والانحراف المعياري <span class="math inline">\(\sigma_{X_t}\)</span>، ومجال الربيعين IQR (<span class="math inline">\(=Q_{3} - Q_{1}\)</span>)، وكذلك الكثافة <span class="math inline">\(p_{X_t}\)</span>. ولكل نموذج نحسب الأخطاءَ المطلقةَ المتوسطة (MAE) مقابل القيم الحقيقية. يُقدَّر المتوسطُ والانحرافُ المعياري والربيعيّات بالاعتماد على <span class="nodecor">1000</span> مسار عيّنة عبر <span class="nodecor">1000</span> تكرار، بينما تُقدَّر الكثافةُ بصيغة تغيير المتغيّر على شبكةٍ من <span class="nodecor">1000</span> نقطةٍ مكانية و<span class="nodecor">500</span> نقطةٍ زمنية ضمن الفترة <span class="math inline">\([0, T = 1.5]\)</span>. وتُظهِر النتائجُ الكميةُ المُبلَّغ عنها في الجدول [tab:quant_error_toy12] أولًا أنّ CTFP لا يفقد عموميته في الحالات التي لا تتطلّب تغييرًا زمنيًّا، وثانيًا أنّ نموذجنا يُبدي قدرةً تقديريةً متفوّقة إذ يلتقط سلوكَ الحلول الحقيقية المتغيّرة زمنيًّا.</p>

<h2 id="مجموعات-البيانات-الواقعية">مجموعاتُ البيانات الواقعية</h2>
<p>لتقييم قدرة نموذجنا على التقاط ديناميكياتٍ أكثر تعقيدًا، درّبناه على مجموعتَين من البيانات الواقعية: التنبؤُ بالعملات المشفَّرة (<strong>Crypto</strong>) (<span class="nodecor">g-research-crypto-forecasting</span>) واستهلاكُ الطاقة الكهربائية (<strong>ECL</strong>) (<span class="nodecor">zhou2021informer</span>). تحتوي مجموعةُ العملات المشفَّرة على أسعارٍ تاريخية لعدّة عُملاتٍ مشفَّرة؛ وركّزنا على نمذجة عوائد لوغاريتم سعر الإيثريوم خِلال عام <span class="nodecor">2020</span>. أمّا مجموعةُ استهلاك الطاقة الكهربائية فتضمّ بياناتِ استهلاكٍ لعملاء متعدّدين بفواصلَ قدرُها <span class="nodecor">15</span> دقيقة؛ واخترنا نمذجةَ استهلاك العميل «200» لطول سلسلته الزمنية.</p>
<p>تتضمّن النتائجُ أخطاءً مطلقةً متوسطة (MAE) لتقدير المتوسط <span class="math inline">\(m_{X_t}\)</span> والانحراف المعياري <span class="math inline">\(\sigma_{X_t}\)</span> لمجموعة العملات المشفَّرة، كما استخدمنا أخطاءً نسبيةً متوسطة (MRE) لمجموعة استهلاك الطاقة الكهربائية لِعرض النتائج على نحوٍ مناسب. وقد أُبلِغ عن هذه النتائج في الجدول [tab:real-world] مع مقارنتها بـ CTFP.</p>

<h1 id="conclusion">الخُلاصة</h1>
<p>قدّمنا نهجًا مُعمَّمًا لنمذجة المعادلات التفاضلية العشوائية عبر الشبكات العصبية الديناميكية وتغيير الزمن. فمن خلال تغيير زمن عملية فاينر نحصل على طيفٍ واسع من العمليات الغاوسية، والتي نُسقِطها بعد ذلك على العملية المُلاحَظة بتطبيق تحويلٍ أحادي. ويُمكِّننا تغييرُ الزمن بالاقتران مع الشبكة العصبية الديناميكية من نمذجة عملياتٍ يُعسِر اشتقاقُها ضمن القيود التقليدية للتكامل والاشتقاق. والمهم أنّ هذا التوسيع يحتفظ بمزايا تدفّقات التطبيع الديناميكية، مثل تقدير الكثافة بدقّة وأخذ العينات بكفاءة.</p>
<p>أظهرت التجارب أنّ نموذجنا يُحقّق أداءً أفضل وقدرةً أعلى على التعميم. ونرى أنّ دمج تغييراتٍ زمنيةٍ مُحدَّدةٍ لكل بُعد يُتيح توسيعَ الطريقة إلى أبعادٍ أعلى. بالإضافة إلى ذلك يمكن تحسينُ مُعامِلات تغيير الزمن بربطها إمّا بالتباين التربيعي للعملية أو بلحظاتها.</p>
</main>
</body>
</html>