<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ar" xml:lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="M. B. Nielsen" />
  <meta name="author" content="G. R. Davies" />
  <meta name="author" content="W. H. Ball" />
  <meta name="author" content="A. J. Lyttle" />
  <meta name="author" content="T. Li (李坦达)" />
  <meta name="author" content="O. J. Hall" />
  <meta name="author" content="W. J. Chaplin" />
  <meta name="author" content="P. Gaulme" />
  <meta name="author" content="L. Carboneau" />
  <meta name="author" content="J. M. J. Ong (王加冕)" />
  <meta name="author" content="R. A. García" />
  <meta name="author" content="B. Mosser" />
  <meta name="author" content="I. W. Roxburgh" />
  <meta name="author" content="E. Corsaro" />
  <meta name="author" content="O. Benomar" />
  <meta name="author" content="A. Moya" />
  <meta name="author" content="M. N. Lund" />
  <title>PBjam: حزمة بايثون لأتمتة علم الزلازل النجمي للنجوم ذات الاهتزازات الشبيهة بالشمس</title>
  <style>
    html {
      line-height: 1.6;
      font-family: 'Noto Naskh Arabic', 'Amiri', 'Georgia', serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
      direction: rtl;
    }
    body {
      margin: 0 auto;
      max-width: 40em;
      padding: 3em 2em 3em 2em;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
      direction: rtl;
      background: #fdfdfd;
    }
    @media (max-width: 600px) {
      body {
        font-size: 1em;
        padding: 1em;
      }
      h1 {
        font-size: 1.5em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1.2em 0;
      line-height: 1.7;
    }
    a {
      color: #1a1a1a;
      text-decoration: underline;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
      display: block;
      margin: 1.5em auto;
      border-radius: 8px;
      box-shadow: 0 2px 8px #e0e0e0;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.6em;
      margin-bottom: 0.7em;
      font-family: 'Noto Naskh Arabic', 'Amiri', 'Georgia', serif;
      font-weight: bold;
      color: #2a2a2a;
    }
    h1 {
      font-size: 2.1em;
      text-align: center;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.3em;
      margin-bottom: 1.2em;
    }
    h2 {
      font-size: 1.4em;
      border-right: 4px solid #e0e0e0;
      padding-right: 0.5em;
      margin-top: 2.2em;
    }
    h3 {
      font-size: 1.15em;
      color: #444;
      margin-top: 1.5em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-right: 2em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 2em 1em 0;
      padding-right: 1em;
      border-right: 3px solid #e6e6e6;
      color: #606060;
      background: #fafafa;
      border-radius: 6px;
    }
    div.abstract {
      margin: 2em 0 2em 0;
      text-align: right;
      font-size: 1em;
      background: #f7f7f7;
      border-radius: 8px;
      padding: 1.2em 1.5em;
      border-right: 5px solid #b0c4de;
      box-shadow: 0 1px 6px #e0e0e0;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      font-size: 1.1em;
      color: #2a2a2a;
      margin-bottom: 0.7em;
      letter-spacing: 0.05em;
    }
    code {
      font-family: 'Fira Mono', 'Consolas', 'Menlo', 'Monaco', 'Lucida Console', monospace;
      font-size: 90%;
      background: #f3f3f3;
      color: #b30000;
      padding: 0.1em 0.3em;
      border-radius: 4px;
    }
    pre {
      margin: 1.2em 0;
      overflow: auto;
      background: #f3f3f3;
      border-radius: 6px;
      padding: 1em;
      font-size: 0.95em;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
      background: none;
      color: #b30000;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 2em 0;
    }
    table {
      margin: 2em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
      direction: rtl;
      background: #fafbfc;
      border-radius: 8px;
      box-shadow: 0 1px 6px #e0e0e0;
    }
    table caption {
      margin-bottom: 0.75em;
      font-weight: bold;
      color: #2a2a2a;
      text-align: center;
    }
    thead {
      background: #e6eaf0;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th, td {
      padding: 0.5em 1em;
      text-align: right;
      border-bottom: 1px solid #e0e0e0;
    }
    th {
      border-top: 1px solid #1a1a1a;
      font-weight: bold;
      color: #2a2a2a;
      background: #f3f6fa;
    }
    tr:last-child td {
      border-bottom: none;
    }
    header {
      margin-bottom: 3em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-right: 1.3em;
    }
    #TOC > ul {
      padding-right: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-right: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    figure {
      margin: 2em auto;
      text-align: center;
    }
    figcaption {
      font-size: 0.95em;
      color: #555;
      margin-top: 0.5em;
      text-align: center;
    }
    .footnotes {
      font-size: 0.95em;
      color: #444;
      margin-top: 3em;
      border-top: 1px solid #e0e0e0;
      padding-top: 1.5em;
    }
    .footnotes ol {
      padding-right: 1.5em;
    }
    .footnote-ref {
      font-size: 0.8em;
      vertical-align: super;
      color: #b30000;
      text-decoration: none;
    }
    .math.inline, .math.display {
      direction: ltr;
      unicode-bidi: embed;
      font-family: 'Latin Modern Math', 'Cambria Math', 'Times New Roman', serif;
      font-size: 1em;
      background: #f7f7f7;
      padding: 0.1em 0.3em;
      border-radius: 4px;
      color: #1a1a1a;
    }
    .math.display {
      display: block;
      margin: 1.2em auto;
      text-align: center;
      font-size: 1.08em;
    }
    mjx-container[jax="SVG"] {
      direction: ltr !important;
      unicode-bidi: embed !important;
      text-align: left !important;
    }
  </style>
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">PBjam<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>:<br />حزمة بايثون لأتمتة علم الزلازل النجمي للنجوم ذات الاهتزازات الشبيهة بالشمس</h1>
<p class="author">M. B. Nielsen</p>
<p class="author">G. R. Davies</p>
<p class="author">W. H. Ball</p>
<p class="author">A. J. Lyttle</p>
<p class="author">T. Li (李坦达)</p>
<p class="author">O. J. Hall</p>
<p class="author">W. J. Chaplin</p>
<p class="author">P. Gaulme</p>
<p class="author">L. Carboneau</p>
<p class="author">J. M. J. Ong (王加冕)</p>
<p class="author">R. A. García</p>
<p class="author">B. Mosser</p>
<p class="author">I. W. Roxburgh</p>
<p class="author">E. Corsaro</p>
<p class="author">O. Benomar</p>
<p class="author">A. Moya</p>
<p class="author">M. N. Lund</p>
<div class="abstract">
<div class="abstract-title">الملخّص</div>
<p>يُعَدّ علمُ الزلازل النجمي أداةً مميّزة لدراسة النجوم عبر خصائص أنماط الاهتزاز المرصودة. حتّى الآن، ظلّت عمليّة إجراء تحليلٍ زلزاليّ نجميّ لِنجمٍ ما مُلتبسةً إلى حدٍّ ما وصعبة المنال لغير المتخصّصين. في هذه الورقة البرمجية نصف <code>PBjam</code>، وهي حزمة بايثون مفتوحة المصدر لتحليل أطياف التردد للنجوم ذات الاهتزازات الشبيهة بالشمس بطريقةٍ بسيطة ومنهجيّة وآليّة. يهدف <code>PBjam</code> إلى توفير أدواتٍ سهلة الاستخدام لاستخلاص معلومات عن الأنماط الشعاعية والثنائية القطب في النجوم الشبيهة بالشمس، تُستَخدَم لاحقاً لاستنتاج خصائص كلّية مثل الكتلة ونصف القطر والعمر، بل والبنية الداخلية أيضاً. ومع وفرة البيانات الجديدة من المراصد الفوتومترية الفضائية، تزداد أهمية علم الزلازل النجمي وطرائق تحليل بياناته، إذ يتيح تطبيقات واسعة في سياقاتٍ مثل دراسات الكواكب الخارجية، وبنية وتطوّر النجوم، ودراسات البنية التجميعية للمجرة.</p>
</div>
</header>
<h1 id="introduction">مقدّمة</h1>
<p>خلال العقود القليلة الماضية أصبح علمُ الزلازل النجمي<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> أداةً مهمّةً لتوصيف النجوم. إنّ ترددات الأنماط التي تهتزّ بها نجومٌ كثيرة تُعَدّ مجسّات حسّاسة لخصائصها الفيزيائية <span class="citation" data-cites="Aerts2010 Chaplin2013"></span>. تُستَخدم هذه الترددات كقيودٍ رصديةٍ في نمذجة النجوم <span class="citation" data-cites="Appourchaux2012 Davies2016a Lund2017"></span>، فتُمكِّن بصورةٍ روتينية من تقديراتٍ دقيقةٍ لخصائص النجوم حتى مستوى النسبة المئوية <span class="citation" data-cites="Metcalfe2012 Lebreton2014 SilvaAguirre2017"></span>. تختلف أنواع الاهتزازات التي قد تظهر في نجمٍ ما اختلافاً كبيراً بحسب خصائصه الفيزيائية <span class="citation" data-cites="Handler2013"></span>، وسنركّز في ما يلي على النجوم الشبيهة بالشمس، أي تلك التي تمتلك طبقات حَملٍ حراري عند السطح.</p>
<p>يعتمد علم الزلازل النجمي على سلاسل زمنية تُستمد إمّا من السرعة الشعاعية أو من شدّة الإضاءة الفوتومترية. وتأتي هذه الرصديات من مراصد ومشاريع أرضية وفضائية، منها GONG <span class="citation" data-cites="Harvey1996"></span> وBiSON <span class="citation" data-cites="Hale2016"></span> وSONG <span class="citation" data-cites="Grundahl2017"></span>، ومهام فضائية مثل SOHO <span class="citation" data-cites="Domingo1995"></span> وCoRoT <span class="citation" data-cites="Baglin2009"></span> و<em>Kepler</em> <span class="citation" data-cites="Borucki2010"></span> وTESS <span class="citation" data-cites="Ricker2014"></span>. من حيث المبدأ يمكن تحليل هذه الرصديات في نطاق الزمن <span class="citation" data-cites="celerite"></span>، لكنه مكلف حسابياً؛ لذا يُجرى علمُ الزلازل النجمي للنجوم الشبيهة بالشمس غالباً في نطاق التردد حيث تظهر الأنماط بوضوحٍ أكبر.</p>
<p>في النجوم الباردة من النسق الأساسي (MS) مثل الشمس، وكذلك في النجوم تحت-العملاقة (SG) والعمالقة الحمراء (RG)، تكون الاهتزازات الأوضح هي أنماط الضغط الصوتية (p-modes) <span class="citation" data-cites="Garcia2019"></span>. تُثار هذه الاهتزازات عشوائيّاً وتُخمَد، وتبدو كمجموعةٍ من القمم شبه المنتظمة ذات شكلٍ لورنتزيّ تقريباً في طيف القدرة <span class="citation" data-cites="Tassoul1980 Anderson1990"></span>. تمثّل الترددات المركزية لهذه القمم تردداتِ رنين النجم، ويمكن مقارنتها بترددات نماذج بنية النجوم لوضع قيودٍ على خصائص النجم <span class="citation" data-cites="Brown1994 SilvaAguirre2015 Angelou2017"></span>.</p>
<p>الهدفُ الأساسي من قياس ترددات أنماط الاهتزاز، والمعروف أيضاً باسم «قياس القِمَم» (peakbagging)، هو ما يسعى إليه <code>PBjam</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. ويتم ذلك عادةً عبر ملاءمة نموذجٍ معلميّ لطيف القدرة لسلسلةٍ زمنية فوتومترية لكل نجمٍ على حدة <span class="citation" data-cites="Appourchaux2003b Davies2014b Corsaro2014"></span>. وتتضمن هذه العملية جزأين رئيسين: تحديد الأنماط وملاءمة النموذج؛ إذ يحدّد الجزءُ الأول شكلَ النموذج المعلمي لطيف الاهتزاز الذي ستتم ملاءمته مع الطيف المرصود.</p>
<p>غالباً ما يُجرى تحديدُ الأنماط يدوياً ويستلزم معرفةً بكيفية ظهورها في مرحلةٍ تطورية معيّنة من حياة النجم. تُوصَف الأنماط في معظم النجوم الشبيهة بالشمس باستخدام التوافقيات الكروية بدرجة <span class="math inline">\(l\)</span> وترتيبٍ سمتي <span class="math inline">\(m\)</span>، ولكلٍّ منها عدد من التوافقيات ذات ترتيبٍ شعاعي <span class="math inline">\(n\)</span>. ويتطلّب تحديدُ الأنماط تعيين تسميات فريدة <span class="math inline">\((n,l,m)\)</span> للأنماط المرئية في الطيف. ويكون ذلك صعباً خصوصاً في النجوم تحت-العملاقة والعمالقة الحمراء حيث تبدأ الأنماط بالاقتران مع أنماط الجاذبية الداخلية <span class="citation" data-cites="Mosser2012b"></span>، ما يفضي إلى تغيّراتٍ سريعة في التردد مع تطوّر النجم. أمّا في النجوم من النوع الطيفي F فتزداد عُروض الأنماط كثيراً مقارنةً بالنجوم الأبرد <span class="citation" data-cites="Appourchaux2014"></span>، ممّا يؤدي إلى تداخُل أنماط <span class="math inline">\(l=0,2\)</span> وظهورها قريباً جدّاً من أنماط <span class="math inline">\(l=1\)</span> بما يصعِّب التفريق بينها <span class="citation" data-cites="Appourchaux2008 Benomar2009 White2012"></span>، وتتفاقم الصعوبة عند انخفاض نسبة الإشارة إلى الضجيج.</p>
<p>بعد تحديد الأنماط تأتي خطوةُ ملاءمة النموذج المختار مع طيف ترددات الاهتزاز. وغالباً ما يكون إيجادُ النموذج الأكثر احتمالاً لشرح الطيف المرصود مكلفاً حسابياً، لا سيّما مع بيانات <em>Kepler</em> التي تضمّ أكثر من <span class="math inline">\(20,000\)</span> نجم نابض رُصدت على مدى سنوات بفاصلٍ زمنيٍّ <span class="math inline">\(\approx 30\)</span> دقيقة <span class="citation" data-cites="Yu2018"></span>، ومئاتٍ أخرى بفاصلٍ أقصر <span class="math inline">\(\approx 1\)</span> دقيقة <span class="citation" data-cites="Lund2017 Serenelli2017"></span>. ولا تزال أطيافُ كثيرٍ من هذه النجوم بحاجةٍ إلى تحليلٍ مُفصّل. علاوةً على ذلك، تُنتج TESS حالياً سلاسل زمنية جديدة لنجومٍ عبر السماء كلّها تقريباً، ومع الإطلاق المستقبلي لمهمة PLATO <span class="citation" data-cites="Rauer2014"></span> تتزايد أهميةُ وجود طريقةٍ سريعة وآليّة لقياس القمم.</p>
<p>مع <code>PBjam</code> نركّز على حلّ هاتين المشكلتين للنجوم الشبيهة بالشمس آليّاً. وهذه النجوم هي الأكثر عدداً وتشمل نجوم النسق الأساسي ذات الكتل <span class="math inline">\(\lesssim 1.6\,\mathrm{M}_\odot\)</span> وغالبية النجوم تحت-العملاقة والعمالقة الحمراء. أمّا الأولى فذات أهميةٍ خاصّة في دراسات الكواكب الخارجية <span class="citation" data-cites="Lundkvist2016 Huber2019"></span>، والثانية مهمّةٌ لدراسة البنية التجميعية للمجرة لإمكانية رصدها على مسافاتٍ بعيدة <span class="citation" data-cites="Miglio2013 Mathur2016"></span>. وإلى جانب ذلك تهدف الأتمتة في <code>PBjam</code> إلى جعل علم الزلازل النجمي مُتاحاً لغير المتخصّصين، بما يسمح بتوسيع نطاق التطبيقات. ما يلي يُشير إلى الإصدار v1.0.0 من <code>PBjam</code><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<h1 id="peakbagging-with-pbjam">قياس القمم باستخدام <code>PBjam</code></h1>
<figure>
  <img src="PBjam_diagram.png" alt="مخطط عامّ لتدفّق العمل في PBjam" />
</figure>
<p>الهدف من «قياس القمم» هو تحديد ترددات أنماط الاهتزاز في النجم. يُظهر الشكل <a href="#fig:example" data-reference-type="ref" data-reference="fig:example">[fig:example]</a> مثالاً لطيفٍ تُعرَض فيه أنماط النجم العملاق الأحمر KIC4448777 على هيئة نسبة الإشارة إلى الضجيج (SNR)، أي ارتفاع قمم الأنماط نسبةً إلى مستوى الضجيج المحيط. تتجمّع الأنماط حول تردّدٍ مميّز <span class="math inline">\(\nu_{\mathrm{max}}\)</span>، وتنخفض SNR سريعاً عند الترددات الأعلى والأدنى. ويُعرَف هذا عادةً بغلاف أنماط الضغط (p-mode envelope).</p>
<p>تختلف الأنماط التي تُثار بما يكفي لتصبح مرئيةً تبعاً لخصائص النجم الفيزيائية، وكذلك ترددات الأنماط نفسها. يعتمد عددُ التوافقيات الشعاعية المرئية على SNR، ويتراوح عادةً من عددٍ قليل في الحالات الضعيفة SNR إلى <span class="math inline">\(\approx 10{-}15\)</span> في أفضل الحالات <span class="citation" data-cites="Lund2017 Chaplin2020"></span>. كما تتضاءل قابليةُ رصد الأنماط مع زيادة <span class="math inline">\(l\)</span> <span class="citation" data-cites="Christensen-Dalsgaard1982"></span>، لذا كثيراً ما تُرصَد فقط أنماط <span class="math inline">\(l=0,1,2\)</span> ونادراً <span class="math inline">\(l=3\)</span> <span class="citation" data-cites="Appourchaux2012"></span>. ولكل <span class="math inline">\(l\)</span> يوجد <span class="math inline">\(2l+1\)</span> نمطاً بترتيبٍ سمتي <span class="math inline">\(-l \leq m \leq l\)</span> قد تنقسم ترددياً بفعل الدوران <span class="citation" data-cites="Gizon2003 Ballot2007"></span>. لذا غالباً ما يحتوي نموذج الطيف على عددٍ كبيرٍ من المتغيّرات، ومن المعتاد استخدام تمثيلٍ معلميّ للنموذج.</p>
<p>استُخدِمت عِدّةُ طرقٍ للتمثيل المعلمي في دراسة أطياف القدرة النجمية <span class="citation" data-cites="Ballot2011a Appourchaux2012 Handberg2011 Lund2017 Corsaro2019"></span>. في هذا الإصدار من <code>PBjam</code> الهدفُ هو قياس ترددات أنماط <span class="math inline">\(l=0,\,m=0\)</span> و<span class="math inline">\(l=2,\,m=0\)</span>، والمميّزة في الشكل <a href="#fig:example" data-reference-type="ref" data-reference="fig:example">[fig:example]</a>. تحمل هذه الأنماط معلوماتٍ مهمّة عبر نطاقٍ واسع من الأنواع الطيفية والمراحل التطورية. لذا فالتمثيلُ المعلمي المستخدم في <code>PBjam</code> مبسّطٌ مقارنةً بدراساتٍ أخرى؛ إذ تُهمل تأثيراتٌ مثل الدوران وعدم تماثُل الأنماط <span class="citation" data-cites="Davies2015 Benomar2018a Benomar2018b"></span>. والأهمّ أنّ أنماط <span class="math inline">\(l=1\)</span> غيرُ مشمولةٍ حالياً في قياس القمم ضمن <code>PBjam</code>، لأن ملاءمتها آليّاً على امتداد المراحل التطورية تتطلب معالجةً خاصة، خصوصاً في النجوم تحت-العملاقة والعمالقة الحمراء حيث تقترن أنماط الجاذبية الداخلية بأنماط الضغط <span class="math inline">\(l=1\)</span> فتُنتِج نمطاً مُعقّداً من الترددات المختلطة يجعل حتى التحديد اليدوي صعباً فضلاً عن الآلي <span class="citation" data-cites="Appourchaux2020"></span>. نسعى إلى تضمين معالجة <span class="math inline">\(l=1\)</span> في الإصدارات القادمة، إذ تحمل معلوماتٍ مهمّة عن الدوران وتساعد في تقييد الأعمار <span class="citation" data-cites="Metcalfe2010 Deheuvels2011"></span>. ومع ذلك لا يمكن لأنماط <span class="math inline">\(l=0\)</span> أن تقترن بأنماط الجاذبية، ونادراً ما يُشاهَد اقترانٌ قوي بين أنماط <span class="math inline">\(l=2\)</span> الضغطية والجاذبية (Mosser وآخرون 2020، قيد الإعداد)، لذا تظهر أزواج <span class="math inline">\(l=0,2\)</span> بنمطٍ شبه منتظم عند فاصلٍ يُسمّى الفاصل الترددي الكبير <span class="math inline">\(\Delta\nu\)</span>. وهذا يُيسِّر تحديدها آليّاً، كما أن استخدام ترددات هذه الأنماط وحدها يكفي لتحديد كتلة النجم ونصف قطره بدقةٍ من رتبة عدّة بالمئة وتقدير عمره ضمن <span class="math inline">\(\sim 10{-}20\%\)</span> <span class="citation" data-cites="Davies2016b McKeever2019 Buldgen2019"></span>. يوضح الشكل <a href="#fig:example" data-reference-type="ref" data-reference="fig:example">[fig:example]</a> طيف KIC4448777 حيث تُبرز أزواج <span class="math inline">\(l=0,2\)</span>. ويتبدّى النمط المتكرر بوضوح عند عرض ترددات الأنماط مع باقي القسمة على الفاصل الكبير؛ إذ تصطفّ أنماط <span class="math inline">\(l=0\)</span> و<span class="math inline">\(l=2\)</span> كأعرافٍ متوازية، بينما قد تنزاح بعض أنماط <span class="math inline">\(l=1\)</span> بفعل الاقتران مع موجات الجاذبية الداخلية.</p>
<p>يُحدِّد اختيارُ نموذج الطيف مع تحديد الأنماط مجموعةَ معلمات الملاءمة <span class="math inline">\(\boldsymbol{\theta}\)</span>، ولإيجاد النموذج الأمثل نرسم توزيع الاحتمال الخلفي
<span class="math display">\[
P(\boldsymbol{\theta}|D)\propto
P(D|\boldsymbol{\theta})P(\boldsymbol{\theta}),
\label{eq:posterior}
\]</span>
حيث <span class="math inline">\(P(\boldsymbol{\theta})\)</span> هو القيد السابق على المعلمات بناءً على المعرفة السابقة، و<span class="math inline">\(P(D|\boldsymbol{\theta})\)</span> هو احتمال رصد البيانات <span class="math inline">\(D\)</span> بالنظر إلى النموذج. بعبارةٍ غير رسمية: <span class="math inline">\(P(\boldsymbol{\theta})\)</span> يمثّل ما نعرفه مسبقاً عن ترددات الأنماط، و<span class="math inline">\(P(D|\boldsymbol{\theta})\)</span> يمثّل ما يخبرنا به طيف القدرة (أو أيّ رصدٍ آخر) عنها. أمّا الاحتمال الخلفي <span class="math inline">\(P(\boldsymbol{\theta}|D)\)</span> فهو ما نهتمّ به في النهاية: مزيج معرفتنا السابقة والجديدة.</p>
<figure>
<img src="PBjam_flow_chart.png" id="fig:flow" alt="مخطط خطوة بخطوة لعملية قياس القمم في PBjam" />
<figcaption aria-hidden="true">مخطط عملية قياس القمم في PBjam. تظهر معلمات الإدخال في الجدول <a href="#tab:asypars" data-reference-type="ref" data-reference="tab:asypars">1</a>. وتشمل معلماتُ أنماط الاهتزاز الناتجة الترددات والارتفاعات والعُروض مع عدم يقيناتها.</figcaption>
</figure>
<h1 id="sec:modules">الصفوف (Classes) الأساسيّة في <code>PBjam</code></h1>
<p>الوظيفة الرئيسة في <code>PBjam</code> هي تحديد الأنماط وملاءمة النموذج، وتتكوّن حالياً من ثلاث صفوفٍ مترابطة: <code>KDE</code> و<code>Asy_peakbag</code> لتحديد الأنماط وترميز المعرفة السابقة عنها، و<code>Peakbag</code> الذي يُجري الملاءمة النهائية للنموذج مع أقل تأثيرٍ ممكن للمعرفة السابقة. عند تزويدها بالمدخلات الأساسية الموضّحة في الجدول <a href="#tab:asypars" data-reference-type="ref" data-reference="tab:asypars">1</a> تُشغَّل هذه الصفوف بالتسلسل لإنتاج تقديرٍ لترددات الأنماط في الطيف. يمكن تنفيذ الخطوات الثلاث آليّاً بواسطة <code>PBjam</code>، كما يمكن تنفيذ كلٍّ منها على حدة عند الحاجة. يوضّح الشكل <a href="#fig:flow" data-reference-type="ref" data-reference="fig:flow">1</a> العملية الآلية، وتفصيلها يأتي في الأقسام التالية. وتُلخَّص مخرجات كل خطوة في الشكل <a href="#fig:pbjamjoint" data-reference-type="ref" data-reference="fig:pbjamjoint">[fig:pbjamjoint]</a>.</p>
<figure>
  <img src="PBjam_corner.png" alt="مثال لتوزيعات لاحقة (Corner plot) لمعلمات الملاءمة" />
</figure>
<figure>
  <img src="PBjam_joint.png" alt="مثال لملاءمة مشتركة للنماذج عبر الأزواج" />
</figure>
<h2 id="sec:kde">KDE - ترميز المعرفة السابقة</h2>
<p>يناقش هذا القسم تفاصيل <code>KDE</code>. تتمثّل وظيفتاه الرئيسيتان في بناء دالةٍ تقرِّب معرفتنا السابقة، وتوفير تخميناتٍ أولية لمعلمات الملاءمة المستخدمة في الخطوة التالية <code>Asy_peakbag</code> (انظر القسم <a href="#sec:asypeakbag" data-reference-type="ref" data-reference="sec:asypeakbag">3.2</a>). لذا فالمعلمات <span class="math inline">\(\boldsymbol{\theta}\)</span> التي يحدَّد لها <code>KDE</code> معرفةٌ سابقة تعتمد على مدخلات <code>Asy_peakbag</code> (انظر الجدول <a href="#tab:asypars" data-reference-type="ref" data-reference="tab:asypars">1</a>). ومع ذلك، يمكن تطبيق المنهجيّة على تمثيلاتٍ معلمية متنوّعة لنموذج الطيف، لذا نبقي الترميز هنا عاماً.</p>
<h3 id="using-a-kernel-density-estimate-as-a-prior">استخدام تقدير كثافة النواة معرفةً سابقة</h3>
<p>الجزء الأول من <code>KDE</code> هو بناء دالة معرفةٍ سابقة تُرمِّز فهمنا لسلوك ترددات الأنماط عبر مراحل التطوّر النجمي المختلفة.</p>
<p>يُنجَز ذلك بحساب تقدير كثافة نواة متعدّد المتغيّرات (KDE) لـ<span class="math inline">\(\boldsymbol{\theta}\)</span> استناداً إلى ملاءماتٍ لأهداف مرصودة سابقاً من <em>Kepler</em><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. تظهر هذه العيّنة في الشكل <a href="#fig:kdecorner" data-reference-type="ref" data-reference="fig:kdecorner">[fig:kdecorner]</a> لجزءٍ من المعلمات المستخدمة في <code>Asy_peakbag</code>. إذا غطّت العيّنة السابقة النطاق الفيزيائي الممكن في فضاء المعلمات فإن <code>KDE</code> الناتج يلتقط التغاير بين معلمات الملاءمة المختلفة. وبهذا تنتج دالةٌ مستمرّة تقرِّب المعرفة السابقة <span class="math inline">\(P(\boldsymbol{\theta})\)</span>.</p>
<p>بناءُ KDE هو في جوهره مسألةُ تنعيمٍ للبيانات. هنا نستخدم KDE متعدّد المتغيّرات مع عرض نطاق (bandwidth) لكل معلمة من معلمات <span class="math inline">\(\boldsymbol{\theta}\)</span> الخاصة بالعلاقة التقاربية وبعض المعلمات الأخرى (انظر القسم <a href="#sec:asypeakbag" data-reference-type="ref" data-reference="sec:asypeakbag">3.2</a>)، ما يمنح تحكّماً كاملاً بدرجة تنعيم بيانات المعرفة السابقة. ويُبنَى KDE كالتالي:
<span class="math display">\[
P(\boldsymbol{\theta}) \propto
\frac{1}{K}\sum_{i=1}^{K}\textbf{Q}_\textbf{H}(\boldsymbol{\theta}-\boldsymbol{\theta}_i),
\label{eq:prior}
\]</span>
حيث <span class="math inline">\(\boldsymbol{\theta}_i\)</span> هي معلمات أحد النجوم <span class="math inline">\(K\)</span> المستخدمة لبناء المعرفة السابقة. و<span class="math inline">\(\textbf{Q}_\textbf{H}\)</span> هي نواة غاوسية متعدّدة المتغيّرات يُحدِّدها مصفوفةُ عرض النطاق <span class="math inline">\(\textbf{H}\)</span>، ونستخدم هنا تغايراً قطريّاً (kernel من النوع D):
<span class="math display">\[
\textbf{Q}_\textbf{H}(\boldsymbol{\theta})=(2\pi)^{-\frac{d}{2}}\left|\textbf{H}\right|^{-\frac{1}{2}}\exp\left(-\frac{1}{2}\boldsymbol{\theta}^T\textbf{H}^{-1}\boldsymbol{\theta}\right),
\]</span>
حيث <span class="math inline">\(d\)</span> هو عدد أبعاد KDE، و<span class="math inline">\(\textbf{H}\)</span> مصفوفةٌ قطريّة <span class="math inline">\(d \times d\)</span>:
<span class="math display">\[
\textbf{H}=\mathrm{diag}(q_1^2,\ldots,q_d^2),
\]</span>
و<span class="math inline">\(q_i\)</span> عددٌ حقيقي يمثّل عرض النطاق لإحدى معلمات النموذج.</p>
<p>يُحسب KDE باستخدام حزمة بايثون <code>statsmodels</code><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> <span class="citation" data-cites="Seabold2010"></span>. وتحدِّد هذه الحزمة أيضاً عرض النطاق الأمثل لكل معلمة ملاءمة باستخدام التحقق المتقاطع بالاحتمال الأقصى. يُجرى التحقق المتقاطع على مجموعةٍ فرعية من أقرب <span class="math inline">\(\sim 100\)</span> جارٍ للنجم الهدف في <span class="math inline">\(\nu_{\mathrm{max}}\)</span>، تُختار من نطاقٍ يصل إلى <span class="math inline">\(\pm 20\sigma\)</span> حيث <span class="math inline">\(\sigma\)</span> هو عدمُ اليقين في <span class="math inline">\(\nu_{\mathrm{max}}\)</span> المُدخل. ويفضي هذا إلى KDE يتغيّر فيه عرض النطاق عكسياً مع كثافة نقاط البيانات السابقة المحلية تبعاً للنجم الهدف: يقلّ في المناطق المكتظة بالنجوم السابقة ويزداد حيث الشواهد قليلة (أي حيث المعرفة ضعيفة). ويُعاد تحسين عرض النطاق عند كل ملاءمةٍ جديدة، لذلك يُنتظر أن تصبح المعرفة السابقة أكثر إفادةً بازدياد عدد النجوم المرصودة. ومع ذلك يستطيع المستخدم تعديل عرض النطاق، وهو أمرٌ ضروري في المناطق الشحيحة بالسوابق، مثل الترددات المنخفضة <span class="math inline">\(\nu_{\mathrm{max}}\lesssim 20\,\mu\mathrm{Hz}\)</span>.</p>
<p>يُعرَض مثال على التوزيعات الاحتمالية الناتجة لأنماط <span class="math inline">\(l=0\)</span> التي يُنتجها صف <code>KDE</code> في الإطار العلوي من الشكل <a href="#fig:pbjamjoint" data-reference-type="ref" data-reference="fig:pbjamjoint">[fig:pbjamjoint]</a>.</p>
<h3 id="estimating-the-most-probable-starting-point">تقدير نقطة البداية الأكثر احتمالاً</h3>
<p>الوظيفة الثانية لـ<code>KDE</code> هي تقديرُ المنطقة الأكثر احتمالاً في فضاء المعلمات لبدء <code>Asy_peakbag</code>. يتمّ ذلك عبر أخذ عيّناتٍ من <span class="math inline">\(P(\boldsymbol{\theta}|D)\)</span> الموضّحة في المعادلة <a href="#eq:posterior" data-reference-type="ref" data-reference="eq:posterior">[eq:posterior]</a>. تُقرَّب المعرفة السابقة <span class="math inline">\(P(\boldsymbol{\theta})\)</span> باستخدام KDE كما سبق، وتبقى لدينا دالة الاحتمال <span class="math inline">\(P(D|\boldsymbol{\theta})\)</span>. في هذه المرحلة نستخدم معلمات الإدخال الموضّحة في الجدول <a href="#tab:asypars" data-reference-type="ref" data-reference="tab:asypars">1</a> بوصفها البياناتَ الرصدية <span class="math inline">\(D\)</span>، وهي: تردّد القدرة العُظمى لغلاف أنماط الضغط <span class="math inline">\(\nu_{\mathrm{max}}\)</span>، والفاصل الترددي الكبير <span class="math inline">\(\Delta\nu\)</span> بين التوافقيات الشعاعية المتتالية، ودرجةُ الحرارة الفعّالة للنجم <span class="math inline">T_\mathrm{eff}</span>، ومؤشر اللون الفوتومتري من <em>Gaia</em> وهو <span class="math inline">G_{\mathrm{BP}}-G_{\mathrm{RP}}</span> <span class="citation" data-cites="Evans2018"></span>. تُحسَب دالة الاحتمال كمحصّلة احتمالاتٍ مشتركة لسلسلة توزيعاتٍ طبيعية بهذه المعلمات وعدم يقيناتها، وبذلك يُؤخَذ عدم اليقين في المدخلات بالحسبان عند تقدير نقطة البداية. ولأنّ <span class="math inline">T_\mathrm{eff}</span> و<span class="math inline">G_{\mathrm{BP}}-G_{\mathrm{RP}}</span> يحملان معلوماتٍ متقاربة، يكفي تزويد أحدهما؛ فإذا توافَر واحدٌ فقط يفترض <code>PBjam</code> معرفةً سابقةً عريضة وغير مُقيّدة للآخر.</p>
<p>يُؤخذ من الاحتمال الخلفي <span class="math inline">\(P(\boldsymbol{\theta}|D)\)</span> عيّناتٌ باستخدام خوارزمية MCMC ذات الترميز الأفيني-اللاإبدالي (affine-invariant) من حزمة <code>emcee</code><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> <span class="citation" data-cites="Foreman-Mackey2013"></span>. ثم تُمرَّر القيمُ المئوية للتوزيع الخلفي لكل معلمة إلى <code>Asy_peakbag</code> كنقطة بداية في فضاء المعلمات.</p>
<h2 id="sec:asypeakbag">Asy_peakbag - تخمينات أوليّة من العلاقة التقاربية</h2>
<p>يناقش هذا القسم تفاصيل <code>Asy_peakbag</code>، الذي يملاءم العلاقةَ التقاربية <span class="citation" data-cites="Mosser2015"></span> مع الطيف، اعتماداً على مخرجات صف <code>KDE</code>. ويوفّر ذلك بدوره الفواصلَ الترددية الأكثر احتمالاً للمرحلة النهائية من قياس القمم (انظر القسم <a href="#sec:peakbag" data-reference-type="ref" data-reference="sec:peakbag">3.3</a>).</p>
<p>يُجري <code>Asy_peakbag</code> في جوهره ملاءمةً مقيّدةً جدّاً لأنماط الاهتزاز، ويمكن من حيث المبدأ استخدامُه منفرداً لتقدير ترددات الأنماط. غير أنّ العلاقة التقاربية ليست وصفاً كاملاً لترددات الأنماط؛ فهي لا تلتقط مثلاً التغيّرات التفصيلية المرتبطة بالانقطاعات الصوتية <span class="citation" data-cites="Mazumdar2014 Vrard2019"></span> أو الاقتران مع أنماط الجاذبية في أعماق النجم <span class="citation" data-cites="Mosser2017"></span>. علاوةً على ذلك ستكون تقديراتُ عدم اليقين في معلمات الملاءمة التقاربية مترابطةً بشدّة. لذا يُفضَّل استخدام <code>Asy_peakbag</code> فقط لتحديد نطاقٍ ترددي موثوق للأنماط الفردية وتعيين درجاتها <span class="math inline">\(l\)</span> تمهيداً لقياس القمم التفصيلي لاحقاً (مثلاً باستخدام صف <code>Peakbag</code>).</p>
<p>في هذه الحالة يتكوّن نموذج الطيف <span class="math inline">\(M(\boldsymbol{\theta}, \nu)\)</span> من مجموع دوالّ لورنتزية، واحدةٍ لكل نمطٍ مرئي في الطيف <span class="citation" data-cites="Anderson1990"></span>. ولأغراض <code>PBjam</code> نُعامِل أزواج <span class="math inline">\((n,l=0)\)</span> و<span class="math inline">\((n-1,l=2)\)</span> كزوجٍ واحد، حيث <span class="math inline">\(n\)</span> يمثّل التوافقيات الشعاعية المرئية.</p>
<p>يصبح النموذج لـ<code>Asy_peakbag</code> كالتالي:
<span class="math display">\[
M\left(\boldsymbol{\theta},\nu\right)=b+\sum\limits_{n=1}^{N}\frac{h_{n,0}}{1+\frac{4}{w^2}(\nu-\nu_{n,0})^2}  +\frac{h_{n-1,2}}{1+\frac{4}{w^2}(\nu-\nu_{n-1,2})^2}.
    \label{eq:asymod}
\]</span></p>
<p>نُلاءِم المعادلة <a href="#eq:asymod" data-reference-type="ref" data-reference="eq:asymod">[eq:asymod]</a> مع طيف SNR للنجم، مع افتراض الحدّ الثابت <span class="math inline">\(b=1\)</span>. طيف SNR هو طيف القدرة مقسوماً على مستوى الخلفية الضجيجية، والذي يُقرَّب بوسيطٍ متحرّك لطيف القدرة<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>. قد يؤثّر التعاملُ الدقيق مع مستوى الخلفية الناتج عن التَحَبُّب والتغيّرات طويلة الأمد في قياس ترددات الأنماط؛ غير أنّ المنهجية المطبّقة هنا كافية لتعريف نطاقاتٍ تردديّة موثوقة لملاءماتٍ تفصيلية لاحقة.</p>
<p>بدلاً من ملاءمة سلسلة معلماتٍ حرّة لكل نمط في المعادلة <a href="#eq:asymod" data-reference-type="ref" data-reference="eq:asymod">[eq:asymod]</a>، نستخدم العلاقة التقاربية لترميز توقّعنا للنمط في النجوم الشبيهة بالشمس. وتُعطى ترددات الأنماط بـ:
<span class="math display">\[
\begin{array}{ll}
\nu_{n,0}  &
=\left(n+\,\varepsilon+\frac{\alpha}{2}\left(n-n_{\mathrm{max}}\right)^2\right)\Delta\nu\\
\nu_{n-1,2} & =\nu_{n,0}-\delta\nu_{02},
\end{array}
\label{eq:asymptotic}
\]</span>
حيث <span class="math inline">\(\,\varepsilon\)</span> هو ما يُعرف غالباً بالإزاحة الطورية (أو حدّ الطور)، و<span class="math inline">\(n_{\mathrm{max}}=\nu_{\mathrm{max}}/\Delta\nu-\,\varepsilon\)</span> <span class="citation" data-cites="Kjeldsen2005"></span>. وتمثّل <span class="math inline">\(\alpha\)</span> مصطلحَ الانحناء من الدرجة الثانية لتغيّر التردد مع <span class="math inline">\(n\)</span>. وتنزاح ترددات أنماط <span class="math inline">\(l=2\)</span> عن الأنماط الشعاعية بمقدارٍ ثابت <span class="math inline">\(\delta\nu_{02}\)</span> في الملاءمة.</p>
<p>تُقَرَّب ارتفاعات الأنماط النسبية (من حيث SNR) بغلافٍ غاوسي:
<span class="math display">\[
\begin{array}{ll}
    h_{n,0} & =
H_{\mathrm{max}}\exp\left(-0.5\left(\nu-\nu_{\mathrm{max}}\right)^2 /
W^2_{\mathrm{env}}\right), \\
    h_{n-1,2} & = 0.7\,h_{n,0},
\end{array}
\]</span>
حيث <span class="math inline">\(W_{\mathrm{env}}\)</span> عرضُ غلاف أنماط الضغط، و<span class="math inline">\(H_{\mathrm{max}}\)</span> ارتفاعُه عند الذروة. وتُخفَّض ارتفاعاتُ أنماط <span class="math inline">\(l=2\)</span> إلى <span class="math inline">\(0.7\)</span> من ارتفاعات <span class="math inline">\(l=0\)</span> <span class="citation" data-cites="Ballot2011b"></span> تقريباً لتمثيل تناقص وضوح الأنماط مع زيادة <span class="math inline">\(l\)</span>.</p>
<p>من المعروف أنّ عرض الأنماط اللورنتزية يعتمد على <span class="math inline">\(T_\mathrm{eff}\)</span> و<span class="math inline">\(\nu_{\mathrm{max}}\)</span> وتردد النمط <span class="citation" data-cites="Appourchaux2014"></span>. غير أنّ نمذجته بدقّة تتطلّب معلماتٍ إضافية تزيد تعقيد النموذج بلا حاجةٍ هنا؛ لذا نُقرّب عرض الأنماط بقيمةٍ ثابتة <span class="math inline">\(w\)</span> لجميع الأنماط.</p>
<p>مع <code>Asy_peakbag</code> نقيم أيضاً الاحتمال الخلفي في المعادلة <a href="#eq:posterior" data-reference-type="ref" data-reference="eq:posterior">[eq:posterior]</a>، مع إضافة قيودٍ من طيف القدرة نفسه.</p>
<p>أي أنّ لوغاريتم الاحتمال الخلفي يُكتب:
<span class="math display">\[
\ln{P(\boldsymbol{\theta}|D)}\propto
\ln{\mathcal{L}(\boldsymbol{\theta})} +
\ln{P(\boldsymbol{\theta})},
\]</span>
حيث <span class="math inline">\(P(\boldsymbol{\theta})\)</span> معطى بالمعادلة <a href="#eq:prior" data-reference-type="ref" data-reference="eq:prior">[eq:prior]</a>، و<span class="math inline">\(\mathcal{L}(\boldsymbol{\theta})\)</span> تمثّل القيود الرصدية:
<span class="math display">\[
\ln{\mathcal{L}(\boldsymbol{\theta})} =
\ln{\mathcal{L}_{\mathrm{S}}(\boldsymbol{\theta})} +
\ln{\mathcal{L}_{\mathrm{O}}(\boldsymbol{\theta})}.
\]</span></p>
<p>لوغاريتمُ دالة الاحتمال <span class="math inline">\(\ln{\mathcal{L}_{\mathrm{S}}(\boldsymbol{\theta})}\)</span> هو القيدُ من طيف القدرة. القدرة في كل خانة تردد موزّعةٌ غاما بمعامل شكل <span class="math inline">\(\alpha=1\)</span> ومعامل مقياس <span class="math inline">\(\beta=1/M(\boldsymbol{\theta},\nu)\)</span>، ومن ثم:
<span class="math display">\[
\ln{\mathcal{L}_{\mathrm{S}}\left(\boldsymbol{\theta}
\right)} = - \sum\limits_{j=1}^J {\left(\ln M\left( {\boldsymbol{\theta}
,\nu _j } \right) + \frac{{S_j }}{{M\left( {\boldsymbol{\theta} ,\nu _j
} \right)}}\right)},
\]</span>
حيث <span class="math inline">\(S_j\)</span> القدرة في خانة التردد <span class="math inline">\(j\)</span>، و<span class="math inline">\(J\)</span> هو العدد الكلّي للخانات.</p>
<p>أمّا <span class="math inline">\(\ln{\mathcal{L}_{\mathrm{O}}(\boldsymbol{\theta})}\)</span> فيجمع القيود من المعلمات الرصدية الإضافية: يستخدم <code>Asy_peakbag</code> أيضاً <span class="math inline">\(T_\mathrm{eff}\)</span> و<span class="math inline">\(G_{\mathrm{BP}}-G_{\mathrm{RP}}\)</span> كما في <code>KDE</code>، لكن تُعامَل <span class="math inline">\(\nu_{\mathrm{max}}\)</span> و<span class="math inline">\(\Delta\nu\)</span> الآن كمعلمات ملاءمة، يُقيَّدان فقط بالمعرفة السابقة والطيف ذاته، وليس بمدخلات المستخدم، تفادياً لعدّ المعلومات مرّتين (إذ غالباً ما تُستخرَج تلك المدخلات من الطيف الجاري ملاءمته). أمّا القيود من <span class="math inline">\(T_\mathrm{eff}\)</span> و<span class="math inline">\(G_{\mathrm{BP}}-G_{\mathrm{RP}}\)</span> فهي مجموع توزيعاتٍ طبيعية بمتوسّطاتٍ وانحرافاتٍ معياريّة تساوي القيمَ المدخلة من المستخدم.</p>
<p>يُبنَى KDE الذي يمثّل المعرفة السابقة <span class="math inline">\(P(\boldsymbol{\theta})\)</span> من عيّنة مؤلّفة من <span class="math inline">\(13\,288\)</span> نجماً من <em>Kepler</em> تتراوح من عمالقةٍ حمراء ذات <span class="math inline">\(\nu_{\mathrm{max}}\approx 30\,\mu\mathrm{Hz}\)</span> إلى نجوم النسق الأساسي عند <span class="math inline">\(\nu_{\mathrm{max}}\approx 4000\,\mu\mathrm{Hz}\)</span> (انظر الشكل <a href="#fig:kdecorner" data-reference-type="ref" data-reference="fig:kdecorner">[fig:kdecorner]</a>) والتي مُلاءِمَت سابقاً باستخدام المعادلة <a href="#eq:asymod" data-reference-type="ref" data-reference="eq:asymod">[eq:asymod]</a>. هذه العيّنة<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> مُجمّعة من <span class="citation" data-cites="White2011"></span> و<span class="citation" data-cites="SilvaAguirre2015"></span> و<span class="citation" data-cites="Serenelli2017"></span> و<span class="citation" data-cites="Lund2017"></span> و<span class="citation" data-cites="Yu2018"></span>، مع نيّة الإضافة عند توفّر بياناتٍ جديدة.</p>
<p>لأخذ عيّناتٍ من فضاء المعلمات <span class="math inline">\(\boldsymbol{\theta}\)</span> يمكن لـ<code>PBjam</code> استخدام أيٍّ من حزمتَي <code>emcee</code> أو <code>CPNest</code><a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> <span class="citation" data-cites="Veitch2017"></span>، وكِلتا الحزمتين تُنتجان تقديراً لتوزيع الاحتمال الخلفي <span class="math inline">\(P(\boldsymbol{\theta}|D)\)</span>. ثم تُمرَّر التوزيعات الخلفية الهامشية لمعلمات الملاءمة إلى الخطوة التالية <code>Peakbag</code>.</p>
<p>يُعرض مثالٌ لملاءمة العلاقة التقاربية مع طيف KIC4448777 في الإطار الأوسط من الشكل <a href="#fig:pbjamjoint" data-reference-type="ref" data-reference="fig:pbjamjoint">[fig:pbjamjoint]</a>.</p>
<div id="tab:asypars">
<table>
<caption>معلماتُ الملاءمة في <code>KDE</code> و<code>Asy_peakbag</code>. المعلمات الموسومة بـ<span class="math inline">\(\dagger\)</span> قيمُ إدخالٍ مطلوبة يجب أن يُوفّرها المستخدم (محسوبةً أو مُقدّرة) لبدء <code>KDE</code>. والمتغيّرات الموسومة بـ<span class="math inline">\(\ast\)</span> تُستخدم فقط لإزالة الالتباسات في العلاقة التقاربية، وليست جزءاً من نموذج الطيف نفسه.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">المعلمة</th>
<th style="text-align: right;">الوصف</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(T_\mathrm{eff}\)</span><span class="math inline">\(^{\ast\dagger}\)</span></td>
<td style="text-align: right;">درجةُ حرارة السطح الفعّالة للنجم.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(G_{\mathrm{BP}}-G_{\mathrm{RP}}\)</span><span class="math inline">\(^{\ast\dagger}\)</span></td>
<td style="text-align: right;">مؤشّر اللون الفوتومتري من <em>Gaia</em>.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\Delta\nu\)</span><span class="math inline">\(^{\dagger}\)</span></td>
<td style="text-align: right;">الفاصلُ الترددي الكبير بين الأنماط ذات <span class="math inline">\(l\)</span> نفسه وتوافقياتٍ شعاعية متتالية <span class="math inline">\(n\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(\nu_{\mathrm{max}}\)</span><span class="math inline">\(^{\dagger}\)</span></td>
<td style="text-align: right;">تردّدُ القدرة العظمى لغلاف أنماط الضغط.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\,\varepsilon\)</span></td>
<td style="text-align: right;">الإزاحةُ الطورية (حدُّ الطور) في ترتيب <span class="math inline">\(n\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(\delta\nu_{02}\)</span></td>
<td style="text-align: right;">الفارقُ الترددي بين أنماط <span class="math inline">\(l=0\)</span> و<span class="math inline">\(l=2\)</span>.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: right;">مصطلحُ الانحناء من الدرجة الثانية لتغيّر التردد مع <span class="math inline">\(n\)</span>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(H_{\mathrm{max}}\)</span></td>
<td style="text-align: right;">ارتفاعُ غلاف أنماط الضغط.</td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(W_{\mathrm{env}}\)</span></td>
<td style="text-align: right;">عرضُ غلاف أنماط الضغط بالتردد.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(w\)</span></td>
<td style="text-align: right;">عرضُ الأنماط بالتردد.</td>
</tr>
</tbody>
</table>
</div>
<p><span id="tab:asypars" label="tab:asypars"></span></p>
<h2 id="sec:peakbag">Peakbag - ملاءمة الأنماط زوجاً بزوج</h2>
<p>الجزء الأخير من العملية هو تحريرُ معظم القيود المعلمية المستخدمة في <code>Asy_peakbag</code>، لتقديم تقديرٍ أقلّ تقييداً لترددات الأنماط وعدم يقيناتها. يُتيح ذلك لـ<code>PBjam</code> التقاطَ التغيّرات الصغيرة في ترددات الأنماط التي لا تحتسبها العلاقةُ التقاربية.</p>
<p>نبدأ وصف نموذج طيف <code>Peakbag</code> بالنظر إلى أزواج <span class="math inline">\(l=0,2\)</span> كما في <code>Asy_peakbag</code> باستخدام المعادلة <a href="#eq:asymod" data-reference-type="ref" data-reference="eq:asymod">[eq:asymod]</a>. لكنّ نموذج <code>Peakbag</code> يركّز فقط على النطاق الترددي القريب من أزواج <span class="math inline">\(l=0,2\)</span>، وليس النطاقَ الفاصل بينها الذي تشغله عادةً أنماط <span class="math inline">\(l=1\)</span>، وذلك لتسريع هذه الخطوة النهائية. في ما يلي تُعامَل أزواج <span class="math inline">\(l=0,2\)</span> بصورةٍ مستقلّة، وللتبسيط نرمز إلى كل زوجٍ <span class="math inline">\((n,0),(n,2)\)</span> حيث <span class="math inline">\(n\)</span> هو رقم الزوج (لا الترتيب الشعاعي). ومن ثمّ لدينا نموذج <span class="math inline">\(M_n(\nu)\)</span> لكلّ زوجٍ ونطاقٍ صغير حوله (انظر الإطار السفلي من الشكل <a href="#fig:pbjamjoint" data-reference-type="ref" data-reference="fig:pbjamjoint">[fig:pbjamjoint]</a>).</p>
<p>يستخدم <code>Peakbag</code> حزمة <code>PyMC3</code><span class="citation" data-cites="Salvatier2016"></span> لأخذ العينات من التوزيع الاحتمالي الخلفي. وبوصفها لغةَ برمجةٍ احتمالية نعتمد ترميزاً متسقاً للمتغيّرات العشوائية التي تصف معلمات النموذج. تُعطى ترددات الأنماط للزوج <span class="math inline">\(n\)</span> بـ:
<span class="math display">\[
\nu_{n,l} \sim
\mathcal{N}(\nu^{\mathrm{asy}}_{n,l},\left(0.03\Delta\nu\right)^2) \quad
\mathrm{لـ}\quad l=0,2,
\label{eq:Nnu}
\]</span>
أي أنّ <span class="math inline">\(\nu_{n,0}\)</span> و<span class="math inline">\(\nu_{n,2}\)</span> موزّعتان طبيعياً بمتوسطٍ يساوي ترددات <span class="math inline">\(\nu^{\mathrm{asy}}_{n,l}\)</span> من <code>Asy_peakbag</code> وتباينٍ <span class="math inline">\((0.03\Delta\nu)^2\)</span>.</p>
<p>لو حوّلنا المعادلة <a href="#eq:Nnu" data-reference-type="ref" data-reference="eq:Nnu">[eq:Nnu]</a> إلى نموذج <code>PyMC3</code> وأخذنا عيناتٍ منه لوجدنا توزيعاتٍ خلفيةً طبيعيةً بمتوسّطات تساوي توقّعات <code>Asy_peakbag</code> وانحرافٍ معياري يساوي <span class="math inline">\(3\%\)</span> من <span class="math inline">\(\Delta\nu\)</span>.</p>
<p>نستخدم النهج نفسه لارتفاعات الأنماط وعروضها، غير أنّ هذه المعلمات موجبة بالضرورة، لذا نستخدم توزيعاتٍ لوغاريتمية-طبيعية لترميز ذلك. ونتّخذ كمتوسّطاتٍ سابقة تقديرات <code>Asy_peakbag</code>، لكن لانحرافاتٍ معيارية نستخدم <span class="math inline">\(0.4\)</span> عَقْداً (decade) لارتفاعات الأنماط، و<span class="math inline">\(1\)</span> عَقْد لعُروض الأنماط، بسبب التغيّر الكبير للأخيرة عبر الغلاف وقد تكون أصغر أو أكبر بكثير من المتوسّط المُقدّر بواسطة <code>Asy_peakbag</code>.</p>
<p>ارتفاعات الأنماط:
<span class="math display">\[
h_{n,l} \sim
\log{\mathcal{N}\left(\log{h^{\mathrm{asy}}_{n,l}}, 0.16\right)} \quad
\mathrm{لـ}\quad l=0,2.\\
\]</span></p>
<p>وبالمثل لعُروض الأنماط:
<span class="math display">\[
w_{n,l}
\sim \log{\mathcal{N}\left(\log{w^{\mathrm{asy}}},1.0\right)}\quad
\mathrm{لـ}\quad l=0,2 .
\]</span></p>
<p>وتُبنى معرفةٌ سابقة للخلفية <span class="math inline">\(b_{n}\)</span> بالطريقة نفسها. وبما أنّنا نعمل على طيف SNR ينبغي أن تساوي الخلفية واحداً؛ غير أنّ هذه المقاربة تقلّ دقّتها مع ازدياد SNR للأنماط. وغالباً ما يكون هذا الأثر صغيراً، لكن لإنتاج نتائج أكثر متانة نسمح لحدّ الخلفية لكل زوج أنماط أن يتغيّر مستقلاً ضمن توزيعٍ لوغاريتمي-طبيعي:
<span class="math display">\[
b_n \sim \log{\mathcal{N}\left(0,
0.16\right)}.
\]</span></p>
<p>الخطوة الأخيرة في بناء نموذج <code>PyMC3</code> هي إضافةُ القيد من الطيف نفسه. كما في <code>Asy_peakbag</code> نفترض أنّ القدرة في كلّ خانة تردّد مُتّبعة لتوزيع غاما، لكن مع معامل مقياس <span class="math inline">\(\beta=1/M_n(\nu)\)</span> الذي يحدّد نموذجاً لكل زوج أنماط <span class="math inline">\(n\)</span>. وفي ترميز <code>PyMC3</code> يُكتب القيد الطيفي:
<span class="math display">\[
S_n \sim
\gamma(1,1/M_{n}(\nu)).
\]</span></p>
<p>بهذا يكتمل نموذج <code>PyMC3</code>، ونستخدم خوارزمية NUTS لأخذ العينات من التوزيع الخلفي. يُعرَض مثال على النماذج المأخوذة بواسطة <code>Peakbag</code> في الإطار السفلي من الشكل <a href="#fig:pbjamjoint" data-reference-type="ref" data-reference="fig:pbjamjoint">[fig:pbjamjoint]</a>. وتكون المخرجات على هيئة إحصاءاتٍ مُلخّصة لكل توزيعٍ خلفي للمعلمات. وكدليلٍ للمستخدم نُقدِّم مقياساً هو نسبةُ عرض المعرفة السابقة (المعادلة <a href="#eq:Nnu" data-reference-type="ref" data-reference="eq:Nnu">[eq:Nnu]</a>) إلى عرض التوزيع الخلفي لترددات الأنماط: فإذا كانت النسبة <span class="math inline">\(\sim 1\)</span> كان الاستدلال محكوماً أساساً بالمعرفة السابقة، وإذا كانت <span class="math inline">\(&gt;1\)</span> كان للطيف الإسهامُ الأكبر. الحالةُ الأولى شائعةٌ للأنماط منخفضة SNR، والثانية للأنماط العالية SNR. لا يقوم <code>PBjam</code> باختيارٍ آليٍّ بناءً على هذا المقياس، لكن نقترح أنّ الأنماط ذات نسبةٍ تزيد على <span class="math inline">\(\approx 2\)</span> قد تكون مناسبةً للاعتماد على المعلومات الطيفية. ومع ذلك، حتى عندما يَغلِب أثرُ المعرفة السابقة يمكن استخدام تردد النمط الناتج قيداً على نماذج النجوم، إذ يعكس حينها تقديراً مستمداً من العلاقة التقاربية (المعادلة <a href="#eq:asymptotic" data-reference-type="ref" data-reference="eq:asymptotic">[eq:asymptotic]</a>) لكن مع عدم يقينٍ أكبر ممّا لو أسهم الطيف أيضاً في الاستدلال.</p>
<h1 id="sec:conclusion">الخلاصة</h1>
<p>الإصدارُ الحالي من <code>PBjam</code> مناسبٌ لقياس ترددات أنماط <span class="math inline">\(l=0\)</span> و<span class="math inline">\(l=2\)</span> لنجوم النسق الأساسي حتى العمالقة الحمراء. ويتم ذلك باستخدام النمط المتوقع لترددات الأنماط كما تقدّمه العلاقة التقاربية، وبالاستفادة من وفرة بيانات الزلازل النجمية من مهمّاتٍ فضائية مثل <em>Kepler</em>. وباستثناء تزويد بعض معلمات الإدخال، تُقاس ترددات الأنماط آليّاً بالكامل، ما يُتيح لغير المتخصّصين الحصولَ على قيودٍ زلزالية في مجموعةٍ واسعة من المسائل المتعلقة بالنجوم الشبيهة بالشمس.</p>
<p>تضمّ عيّنةُ الأهداف السابقة المستخدمة في <code>PBjam</code> <span class="math inline">\(13\,288\)</span> نجماً من <em>Kepler</em>. وكما يظهر في الشكل <a href="#fig:kdecorner" data-reference-type="ref" data-reference="fig:kdecorner">[fig:kdecorner]</a>، تغلب العمالقةُ الحمراء على هذه العيّنة حالياً مع قلّةٍ من نجوم النسق الأساسي، وذلك بسبب القيود التقنية في <em>Kepler</em> التي حدّت من عدد الأهداف المرصودة بفاصلٍ زمنيّ قصير. ولأنّ ترددات اهتزاز نجوم النسق الأساسي عادةً <span class="math inline">\(\gtrsim 1000\,\mu\mathrm{Hz}\)</span> لم تُكتشف الاهتزازات إلا في بضع مئاتٍ من هذه النجوم. هدفُنا تحديثُ العيّنة باستمرار مع توفّر بياناتٍ جديدة، ومن المنتظر أن تُسهم TESS بشكلٍ كبير بفضل تغطيتها شبه الكاملة للسماء ووفرة نجوم تحت-العملاقة والنسق الأساسي الساطعة.</p>
<p>القيد الرئيس في الإصدار الحالي من <code>PBjam</code> هو عدمُ إدراج أنماط <span class="math inline">\(l=1\)</span>. ورغم أنّ أزواج <span class="math inline">\(l=0,2\)</span> وحدها كافية لتقييد نماذج النجوم بدقّةٍ من رتبة بضعة بالمئة في الكتلة ونصف القطر، و<span class="math inline">\(10{-}20\%\)</span> في العمر، فإن ترددات <span class="math inline">\(l=1\)</span> توفّر قيوداً أشدّ إحكاماً. إنّ الاقتران بين أنماط الضغط <span class="math inline">\(l=1\)</span> والاهتزازات المُسيطَر عليها بالجاذبية الداخلية وتغيّر ذلك مع تطوّر النجم هو المشكلة الرئيسة في ملاءمتها آليّاً. وقد حاولت أعمالٌ سابقة مثل <span class="citation" data-cites="Kallinger2019"></span> و<span class="citation" data-cites="Corsaro2020"></span> و<span class="citation" data-cites="Appourchaux2020"></span> معالجةَ هذه المشكلة آليّاً. وغالباً ما تستخدم هذه الطرق اختباراتِ دلالةٍ نمطاً بنمطٍ للقمم في الطيف، تعقبها مقارنةٌ مع العلاقة التقاربية لتحديد أزواج <span class="math inline">\(l=0,2\)</span> ثم أنماط <span class="math inline">\(l=1\)</span>.</p>
<p>يهدف <code>PBjam</code> إلى بناء نموذجٍ توليدي يستثمر المعلومات من كامل غلاف أنماط الضغط دفعةً واحدة، ويتدرّج بسلاسة من النسق الأساسي حتى فرع العمالقة الحمراء. وقد تحقق ذلك إلى حدٍّ بعيد لأزواج <span class="math inline">\(l=0,2\)</span> في الإصدار الحالي عبر تحديد نطاقٍ ترددي مبدئي من العلاقة التقاربية، ثم تحرير هذه القيود لاحقاً. غير أنّ تطبيق هذا النهج على أنماط <span class="math inline">\(l=1\)</span> يستلزم معرفةً دقيقة بالنمط المتوقع. ورغم أنّ ذلك يسيرٌ نسبياً في نجوم النسق الأساسي، وإلى حدٍّ ما في العمالقة الحمراء <span class="citation" data-cites="Vrard2016"></span>، إلّا أنّه أقلّ يسراً في النجوم تحت-العملاقة؛ ففي هذه النجوم قد تؤثر أخطاءٌ صغيرة في قياس القمم <span class="math inline">\(l=1\)</span> كثيراً في المعلمات النجمية الناتجة <span class="citation" data-cites="Li2020"></span>. إنّ توسيع ترميز المعرفة السابقة على غرار ما في <code>PBjam</code> ليشمل الأساليب المذكورة أعلاه يمثّل حلاً ممكناً، ونترك هذا للتحقيق في الإصدار القادم من <code>PBjam</code>.</p>
<p>يشكر المؤلفون الجهاتَ الداعمة: يَشكر MBN وWHB وWJC وكالةَ الفضاء البريطانية. ويَشكر GRD وOJH وWJC مجلسَ مرافق العلوم والتكنولوجيا البريطاني (STFC). ويَشكر EC دعمَ اتفاقية PLATO ASI-INAF رقم 2015-019-R.1-2018 ودعمَ برنامج Horizon 2020 التابع للاتحاد الأوروبي بموجب منحة Marie Sklodowska-Curie رقم 664931. ويَشكر P. Gaulme تمويلَ مركز الفضاء الألماني (DLR) بموجب منحة مركز بيانات PLATO رقم 50OO1501. ويَشكر JO دعمَ منحة TESS GI رقم G022092. ويَشكر RAG دعمَ منح GOLF وPLATO/CNES. وقد تلقّى هذا البحث تمويلاً من المجلس الأوروبي للبحوث (ERC) بموجب برنامج Horizon 2020 للاتحاد الأوروبي (CartographY GA. 804752). ويَشكر المؤلفون استخدامَ خدمة BlueBEAR HPC في جامعة برمنغهام. وتمويلُ مركز الفيزياء الفلكية النجمية مُقدَّم من مؤسسة الأبحاث الوطنية الدنماركية (اتفاقية المنحة رقم: DNRF106). ويتضمّن هذا البحث بياناتٍ جمعتها مهمة Kepler وحُصِل عليها من أرشيف بيانات MAST في معهد علوم تلسكوب الفضاء (STScI). وتمويلُ مهمة Kepler مُقدَّم من مديرية العلوم في ناسا. ويدير STScI اتحادَ الجامعات لأبحاث الفلك بموجب عقد ناسا NAS 5–26555. كما استخدم هذا العمل بياناتٍ من مهمة <span><em>Gaia</em></span> التابعة لوكالة الفضاء الأوروبية (<a href="https://www.cosmos.esa.int/gaia" class="uri">https://www.cosmos.esa.int/gaia</a>)، والتي عالجها اتحادُ معالجة وتحليل بيانات <span><em>Gaia</em></span> (DPAC، <a href="https://www.cosmos.esa.int/web/gaia/dpac/consortium" class="uri">https://www.cosmos.esa.int/web/gaia/dpac/consortium</a>). وتمويلُ DPAC مُقدَّم من مؤسساتٍ وطنية، ولا سيّما المؤسسات المشاركة في اتفاقية <span><em>Gaia</em></span> متعددة الأطراف.</p>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>الإصدار 1.0.0. <a href="https://doi.org/10.5281/zenodo.4300079" class="uri">https://doi.org/10.5281/zenodo.4300079</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>ويُسمّى عند الاقتصار على الشمس «علم الشمس الزلزالي».<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>التوثيق وتعليمات الاستخدام متاحة على <a href="https://pbjam.readthedocs.io" class="uri">https://pbjam.readthedocs.io</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>للحصول على أحدث إصدار انظر <a href="https://github.com/grd349/PBjam" class="uri">https://github.com/grd349/PBjam</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>يمكن العثور على أمثلة إضافية في مستودع GitHub الخاص بـ<code>PBjam</code>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p>ستشمل الإصداراتُ المستقبلية من <code>PBjam</code> رصدياتِ CoRoT وTESS.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p><a href="https://www.statsmodels.org/stable/index.html" class="uri">https://www.statsmodels.org/stable/index.html</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p><a href="https://emcee.readthedocs.io/en/stable/" class="uri">https://emcee.readthedocs.io/en/stable/</a><a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9" role="doc-endnote"><p>انظر <a href="https://docs.lightkurve.org/api/lightkurve.periodogram.Periodogram.html" class="uri">https://docs.lightkurve.org/api/lightkurve.periodogram.Periodogram.html</a><a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10" role="doc-endnote"><p>متوفّرة بصيغة قابلة للقراءة آليّاً على <a href="https://github.com/grd349/PBjam/blob/master/pbjam/data/prior_data.csv" class="uri">https://github.com/grd349/PBjam/blob/master/pbjam/data/prior_data.csv</a>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11" role="doc-endnote"><p><a href="https://johnveitch.github.io/cpnest/" class="uri">https://johnveitch.github.io/cpnest/</a><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>