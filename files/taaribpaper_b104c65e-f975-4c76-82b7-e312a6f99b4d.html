<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Gabriella Holden, Daniel Shiu, Lauren Strutt">
  <title>تحديد مجموعات \(k\) من المتجهات القابلة للاختزال باستخدام التجزئة/التصفية الحسّاسة لقُرْب الفضاء الجزئي</title>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
    html, body {
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      background: #f8f9fa;
      color: #222;
      font-size: 22px;
      line-height: 1.7;
      margin: 0;
      padding: 0;
      direction: rtl;
    }
    header {
      background: linear-gradient(90deg, #3a6073 0%, #16222a 100%);
      color: #fff;
      padding: 2.5rem 1.5rem 1.5rem 1.5rem;
      text-align: center;
      border-bottom-left-radius: 30px;
      border-bottom-right-radius: 30px;
      box-shadow: 0 2px 8px rgba(60,60,60,0.08);
      margin-bottom: 2.5rem;
    }
    h1.title {
      font-size: 2.3rem;
      font-weight: 700;
      margin-bottom: 0.7rem;
      letter-spacing: 0.01em;
      line-height: 1.3;
    }
    .author {
      font-size: 1.1rem;
      font-weight: 400;
      margin-top: 0.5rem;
      color: #e0e0e0;
      letter-spacing: 0.03em;
    }
    h1, h2, h3, h4 {
      color: #2a3b4c;
      font-weight: 700;
      margin-top: 2.2rem;
      margin-bottom: 1.1rem;
      line-height: 1.2;
    }
    h1 {
      font-size: 1.7rem;
      border-right: 6px solid #3a6073;
      padding-right: 0.7rem;
      background: #eaf0f6;
      border-radius: 12px 0 0 12px;
      display: inline-block;
      margin-bottom: 1.5rem;
    }
    h2 {
      font-size: 1.3rem;
      border-right: 4px solid #3a6073;
      padding-right: 0.5rem;
      background: #f3f6fa;
      border-radius: 10px 0 0 10px;
      display: inline-block;
      margin-bottom: 1.2rem;
    }
    h3 {
      font-size: 1.1rem;
      color: #3a6073;
      margin-bottom: 1rem;
    }
    p {
      margin: 1.1em 0;
      text-align: justify;
    }
    ul, ol {
      margin: 1.2em 2.5em 1.2em 0;
      padding-right: 1.5em;
    }
    ul li, ol li {
      margin-bottom: 0.7em;
      font-size: 1em;
    }
    li p {
      margin: 0.2em 0 0.2em 0;
    }
    code, pre {
      font-family: 'Fira Mono', 'Consolas', 'Courier New', monospace;
      background: #f4f4f4;
      color: #2a3b4c;
      border-radius: 6px;
      padding: 0.2em 0.5em;
      font-size: 0.95em;
    }
    pre {
      padding: 1em;
      overflow-x: auto;
      background: #f0f3f7;
      border: 1px solid #e0e0e0;
      margin: 1.5em 0;
    }
    .math.display {
      display: block;
      background: #f7fafc;
      border-right: 4px solid #3a6073;
      border-radius: 10px 0 0 10px;
      padding: 1em 1.5em;
      margin: 1.5em 0;
      font-size: 1.1em;
      direction: ltr;
      text-align: left;
      overflow-x: auto;
    }
    .math.inline {
      background: #f3f6fa;
      border-radius: 6px;
      padding: 0.1em 0.4em;
      font-size: 1em;
      direction: ltr;
      display: inline-block;
      vertical-align: middle;
    }
    .nodecor {
      text-decoration: none;
      color: inherit;
      font-weight: 500;
    }
    blockquote {
      border-right: 4px solid #3a6073;
      background: #f3f6fa;
      margin: 1.5em 0;
      padding: 1em 1.5em;
      border-radius: 10px 0 0 10px;
      color: #444;
      font-size: 1em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 2em 0;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(60,60,60,0.06);
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 0.7em 1em;
      text-align: center;
    }
    th {
      background: #eaf0f6;
      color: #2a3b4c;
      font-weight: 700;
    }
    @media (max-width: 700px) {
      html, body {
        font-size: 18px;
      }
      header {
        padding: 1.5rem 0.5rem 1rem 0.5rem;
      }
      h1.title {
        font-size: 1.3rem;
      }
      h1, h2 {
        font-size: 1.1rem;
        padding-right: 0.3rem;
      }
      .math.display {
        font-size: 1em;
        padding: 0.7em 0.7em;
      }
    }
    body {
      animation: fadein 0.7s;
    }
    @keyframes fadein {
      from { opacity: 0; }
      to   { opacity: 1; }
    }
    strong, b {
      color: #3a6073;
    }
    h1:not(:first-child), h2 {
      border-top: 1px solid #e0e0e0;
      padding-top: 1.2em;
      margin-top: 2.5em;
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">تحديد <span class="nodecor"><span class="math inline">\(k\)</span></span> مجموعات من المتجهات القابلة للاختزال باستخدام التجزئة/التصفية الحسّاسة لقُرْب الفضاء الجزئي</h1>
  <p class="author"><span class="nodecor">Gabriella Holden</span>, <span class="nodecor">Daniel Shiu</span>, <span class="nodecor">Lauren Strutt</span></p>
</header>

<h1 id="ملخص">مُلَخَّص</h1>
<p>نُقدِّم ونُحلِّل عائلةً من دوالّ التجزئة والتصفية التي تُرجِّح حدوث تصادُمات لتكوينات صغيرة قابلة للاختزال من المتجهات. قد تُوفِّر هذه الدوال تحسيناتٍ عمليّةً لعمليات غربلة الشَبكات بحثاً عن متجهات قصيرة. وعلى وجه الخصوص، تُظهِر هذه العائلة، ضمن نظام تقارُبيّ بعينه، سلوكاً تقارُبياً يختلف على نحوٍ ملحوظ عن دوالّ التجزئة/التصفية المتداولة حالياً.</p>

<h1 id="مقدمة">مُقَدِّمَة</h1>
<p>تعتمد خوارزميات ما بعد الكم مثل Kyber وDilithium وFALCON وFrodo وNTRU وغيرها على صعوبة إيجاد متجه قصير في شَبكة؛ لذا فإن فهم صعوبة هذه المسألة في الأبعاد الكبيرة مهمٌّ جدّاً لاختيار معاملات هذه الخوارزميات. ووفقاً للفهم الحالي، يُعتقَد أن الطريقة الأكثر فاعلية لإيجاد متجهات قصيرة في شَبكة ذات بُعد كبير <span class="math inline">\(d\)</span> هي «الغربلة». طُرِح مفهوم غربلة متجهات الشَبكة القصيرة لأول مرة بواسطة أجتاي–كومار–سيفاكومار (<span class="nodecor">AKS</span>). في خوارزميات الغربلة هذه، تُنتَج أعداد كبيرة من المتجهات (بحجم أُسِّي في <span class="math inline">\(d\)</span>) بطول متقارب، عن طريق أخذ تراكيب خطيّة صغيرة من متجهات الأساس. ثم تُقارَن أزواج المتجهات للتحقق ممّا إذا كان جمع أحدهما أو طرحه من الآخر يُنتج متجهاً أقصر. بعد ذلك يُستبدَل المتجه الأطول بمتجه أقصر داخل المجموعة، وتُكرَّر العملية حتى لا يعود بالإمكان العثور على متجه أقصر. وتُستخدم استدلالات هندسية لتبرير حجم العيّنة اللازم كي نضمن الاستمرار في إيجاد متجهات أقصر.</p>
<p>كانت الفكرة الأولى في (<span class="nodecor">AKS</span>) تعتمد على مقارنة كل الأزواج الممكنة من المتجهات، لكن التحسينات اللاحقة خفّضت زمن التشغيل عبر النظر فقط في الأزواج «القريبة»، إذ هي الأرجح في إنتاج متجهات أقصر. ما زال حساب المسافة بين كل زوج يستغرق زمناً تربيعياً في عدد المتجهات، لكن تجزئة كل متجه بدالّة تحتفظ بجزء من معلومات موقعه تتيح الفرز بحسب قيمة التجزئة لإيجاد أزواج قريبة. تُعرَف هذه الدوال بـ«التجزئة الحسّاسة للمسافة» (<span class="nodecor">LSH</span>)؛ انظر (<span class="nodecor">polytope</span>) مثالاً. نهجٌ مُشابِه (<span class="nodecor">filter</span>) هو عائلة دوالّ تصفية تُنتج مخرجاً ثنائياً لكل متجه، بحيث تعبر المتجهات القريبة سلسلةً من المعايير بنجاح.</p>
<p>تَمتدّ خوارزميات الغربلة لتشمل ليس فقط الأزواج، بل أيضاً الثلاثيات أو، بوجهٍ عام، مجموعات من الحجم <span class="math inline">\(k\)</span> تُنتِج تركيبةً خطيّة أقصر (<span class="nodecor">tuple</span>). وإيجاد مثل هذه التركيبات أكثر تعقيداً من حالة الأزواج (التي تُناظِر خطوة خفض إقليدس)، غير أنّ هناك خوارزمياتٍ سريعةً مُخصَّصة لإيجاد أقصر تركيبة خطية من ثلاثة (<span class="nodecor">semaev</span>) أو أربعة (<span class="nodecor">nguyen</span>) متجهات. ونظراً لأنّ تعقيد الغربلة يتأثّر ضعيفاً جداً بخطوة الخفض، يمكن فحص مجموعات أكبر بحثاً عن تراكيب أقصر (مثل تعداد Schnorr–Euchner (<span class="nodecor">schnorr</span>) أو حتى غربلة على أبعادٍ أقلّ). وطالما وُجِدَت تركيبة أقصر بنسبةٍ موجبة، تَستمر الغربلة. تصير التكوينات القابلة للاختزال من مجموعات <span class="math inline">\(k\)</span> أكثر شيوعاً كلما ازداد <span class="math inline">\(k\)</span>، ما يُقلِّل عدد المتجهات الأولية المطلوبة ويُخفِّض تكلفة الذاكرة. في هذه الورقة ننظر في مسألة إيجاد التكوينات القابلة للاختزال لمجموعات <span class="math inline">\(k\)</span>، مع التركيز على الحالة <span class="math inline">\(k=3\)</span>.</p>
<p>لتسريع الغربلة الحاسوبية لمجموعات <span class="math inline">\(k\)</span>، نحتاج إلى دالّة تصفية تحدّد التكوينات القابلة للاختزال بكلفةٍ أقلّ من فحص كل مجموعة على حدة. يتطلّب ذلك توصيف عائلةٍ واسعة من الثلاثيات/المجموعات القابلة للاختزال، إضافةً إلى اختبارٍ رخيصٍ لكن قويّ لانتقاء هذه المجموعات ضمن عيّنة ضخمة. المناهج الحالية (<span class="nodecor">klist, fast_tuple</span>) تبني مجموعة <span class="math inline">\(k\)</span> تدريجياً: من متجه إلى زوج إلى ثلاثي ... حتى مجموعة من الحجم <span class="math inline">\((k-1)\)</span>، حيث يُختار كل متجه جديد إمّا من تصادمات تجزئة ثنائية أو عبر اجتياز تصفيةٍ ثنائية.</p>
<p>في هذه الورقة نستكشف نهجاً مباشراً يُحدِّد مجموعات <span class="math inline">\(k\)</span> القابلة للاختزال عبر تصادمات <span class="math inline">\(k\)</span>-طُرُق في دوالّ التجزئة، أو عبر عائلاتٍ من <span class="math inline">\(k\)</span> ناجياتٍ من التصفية. نقترح تعميماً لـ«تجزئة الزاوية» (<span class="nodecor">angular, polytope</span>) يمكن استخدامه كاختبارٍ إحصائيّ لتعيين التكوينات القابلة للاختزال. يرتبط هذا التعريف بمشكلة إيجاد مجموعات من المتجهات تقع جميعُها قريباً من فضاءٍ جزئيّ ذي بُعد <span class="math inline">\((k-1)\)</span>. في هذه الحالة قد تصلح طرائقُنا أيضاً للتصنيف والتجميع في بياناتٍ عالية الأبعاد بوجهٍ عام. ويُقدّم تعميمُنا تجزئاتٍ حسّاسةً للمسافة لحالة <span class="math inline">\(k=2\)</span>، تُظهِر سلوكاً تقارُبياً مختلفاً عن التجزئات الحالية وقد يكون مفيداً لتطبيقات الغربلة. تشير تحليلاتُنا كذلك إلى إمكان تكييف التصفية لعائلات ناجياتٍ من الحجم <span class="math inline">\(k\)</span>، وإلى عائلةٍ جديدة من دوالّ التصفية تستحقّ مزيداً من البحث.</p>

<h2 id="تجزئات-متعدد-السطوح-المتصالب-وتجزئات-الإسقاط-العشوائي">تجزئات مُتعدَّد السطوح المتصالِب وتجزئات الإسقاط العشوائي</h2>
<p>تُعرَّف دالّة التجزئة الخاصة بمُتعدّد السطوح المتصالِب (<span class="nodecor">cross‑polytope LSH</span>) كما في (<span class="nodecor">polytope</span>) باختيار <span class="math inline">\(d\)</span> متجهات غاوسية مستقلّة <span class="math inline">\(\vv r_i\)</span>. لكل متجه <span class="math inline">\(\vv v\)</span> نَحسب <span class="math inline">\(\pm\,\vv r_i\!\cdot\!\vv v\)</span>، ثم نختار الفهرس غير الموقّع <span class="math inline">\(\pm i\)</span> الذي يُحقِّق أكبر قيمةٍ مطلقة للجداء الداخلي. وقيمة التجزئة هي
<span class="math display">
\[
H(\vv v)=(-1)^b\, i:\; b\in\{0,1\},\; (-1)^b\,\vv r_i\!\cdot\!\vv v\;\ge\;|\vv r_j\!\cdot\!\vv v|\quad \forall\,1\le j\le d.
\]
</span>
وبسبب الارتفاع في البُعد، يكون المتجه <span class="math inline">\(\vv r_i\)</span> تقريباً متعامداً مع الباقين وبالطول نفسه، ما يجعله على نحوٍ تقريبيّ محوراً في مُتعدِّد سطوحٍ متصالِبٍ عشوائي. وعندها تُقارِب أشكالُ التجزئة اختيارَ أقرب رأسٍ في ذلك المجسّم، فتُساق المتجهات القريبة إلى تصادمٍ مُشترَك.</p>
<p>نُورِد ملاحظاتٍ تمهيداً لاختيارنا لتجزئةٍ تعمل كاختبارٍ إحصائيّ لتكويناتٍ قابلة للاختزال لحجم <span class="math inline">\(k\)</span>:</p>
<ul>
<li><p>أولاً، التجزئة تختبر الزوج <span class="math inline">\(\vv v_1,\vv v_2\)</span> القريب بما يجعل <span class="math inline">\(\vv v_1-\vv v_2\)</span> أقصر. ويمكن أيضاً تعريف تجزئة تختبر التقارب «المتعاكس» بحيث يصبح <span class="math inline">\(\vv v_1+\vv v_2\)</span> أقصر. حدْسُنا أنّ اختيار الفهرس ذي القيمة المطلقة الأكبر يُحقِّق تماثلاً على <span class="math inline">\(\pm\vv v\)</span>.</p></li>
<li><p>ثانياً، يمكن استخدام عددٍ أقلّ من المتجهات العشوائية مع الحفاظ على قدرة الاختبار. فمجموعةٌ من <span class="math inline">\(h\)</span> متجهاتٍ عشوائية تمتدّ فضاءً جزئيّاً ذا بُعد <span class="math inline">\(h\)</span>، ونَتوقّع أن تُحافِظ إسقاطاتُ الأزواج على القُرب (أو على «التعاكس»). هذا يُخفِّض كلفة التقييم، مع احتمال زيادة التصادمات لكلٍّ من الإيجابيات الحقيقية والخاطئة.</p></li>
<li><p>ثالثاً، يمكن اختيار أكثر من فهرسٍ واحد. فبجمع مجموعةٍ من <span class="math inline">\(a\)</span> فهارس بأعلى إسقاطات نُحدِّد فضاءً جزئيّاً بُعدُه <span class="math inline">\(a\)</span> يُحاكي توجّه المتجه. وبدلاً من ذلك، إذا كتبنا <span class="math inline">\(h=a+b\)</span> أمكننا جمع <span class="math inline">\(b\)</span> فهارس بأصغر إسقاطات لتحديد المُتمِّم المُتعامِد.</p></li>
</ul>
<p>لهذه الأسباب، نُعرِّف عائلة «تجزئات الإسقاط العشوائي» كما يلي:</p>
<p>لتكن <span class="math inline">\(\mathcal R=\{\vv r_1,\ldots,\vv r_h\}\subset\mathbb R^d\)</span> مجموعةً من المتجهات المستقلّة مُكوِّناتُها موزّعة <span class="math inline">\(\mathcal N(0,1)\)</span>. ولكل <span class="math inline">\(a,b\)</span> حيث <span class="math inline">\(a+b=h\)</span>، نُعرِّف دوالّ التجزئة <span class="math inline">\(H_{\mathcal R,a,b}(\vv v)\)</span> باختيار مجموعة <span class="math inline">\(A\)</span> من الفهارس، حجمُها <span class="math inline">\(a\)</span>، التي تُعطي أعلى <em>قيمٍ مطلقة</em> للجداءات <span class="math inline">\(\vv r_i\!\cdot\!\vv v\)</span>:
<span class="math display">
\[
H_{\mathcal R,a,b}(\vv v)
=\Bigl\{A:\#A=a,\;|\vv r_i\!\cdot\!\vv v|\ge|\vv r_j\!\cdot\!\vv v|\;\forall\,i\in A,\;j\notin A\Bigr\}.
\]
</span>
ويُفضّ التعادل باختيار الفهرس الأصغر عند تساوي القيم.</p>
<p>نهتمّ بمُعدّل التصادم <span class="math inline">\(k\)</span>-الطُرُقي لعائلة التجزئة هذه على أنماطٍ من <span class="math inline">\(k\)</span> متجهات. عند عدم ترابُط القيم، نتوقّع مُعدّلاً بدائيّاً <span class="math inline">\(\binom{h}{a}^{-(k-1)}\)</span>. سنُبيّن لاحقاً ارتباط مُعدّل التصادم بالجداءات الداخلية الزوجيّة للأنماط. ونُجري في قسمٍ لاحق تحقيقاتٍ تجريبية للمُعدّل الثلاثي لتكويناتٍ قابلةٍ للاختزال وأخرى غير قابلة. كما نُقدّم تعابير تحليلية للحالات <span class="math inline">\(a=1\)</span> أو <span class="math inline">\(b=1\)</span> عبر تكاملٍ عدديّ في فضاءٍ ذي <span class="math inline">\(k+1\)</span> أبعاد. وفي دراسة السلوك التقارُبي لمعدل التصادم حين <span class="math inline">\(b\to\infty\)</span> مع ثبات <span class="math inline">\(a\)</span>، نُثبِت تعميماً لنتائج (<span class="nodecor">angular</span>) حيث كان <span class="math inline">\(h=d\)</span>، <span class="math inline">\(a=1\)</span>، <span class="math inline">\(b=d-1\)</span>. في (<span class="nodecor">angular</span>) يُظهَر أن المعدّل السالب اللوغاريتمي للتصادم الثنائي التقارُبي هو <span class="math inline">\((\alpha-1)\log h\)</span> مع <span class="math inline">\(\alpha(\tau)=\tfrac{4}{\,4-\tau^2\,}\)</span> إذا كانت <span class="math inline">\(\tau\)</span> مسافة المتجهين، ويمكن كتابتها أيضاً <span class="math inline">\(\alpha(\vv v_1\!\cdot\!\vv v_2)=\tfrac{2}{\,1-|\vv v_1\!\cdot\!\vv v_2|\,}\)</span>. في الحالة العامة نصل إلى
<span class="math display">
\[
\log\frac{B\bigl((1+o(1))\,\alpha\,a,\;b\bigr)}{B(a,b)},
\]
</span>
حيث <span class="math inline">\(B\)</span> دالّة بيتا و<span class="math inline">\(\alpha\)</span> دالّة في الجداءات الداخلية الزوجيّة للأنماط، ونُسمّي <span class="math inline">\(\alpha\)</span> «القطرَ المُزْدَوِج الأقصر المُربَّع». كما ندرس سلوك التصادمات عند <span class="math inline">\(a\to\infty\)</span> مع ثبات <span class="math inline">\(b\)</span>، فنحصل على
<span class="math display">
\[
\Delta^{-b}\,\binom{a+b}{b}^{-(k-1)},
\]
</span>
حيث <span class="math inline">\(\Delta\)</span> هو «الجيب القطبي» للأنماط. ونُقدِّم أيضاً مُعدّلات بقاء الأنماط تحت اختبار «تصفية الإسقاط العشوائي» فوق أو تحت حدود مطلقة كبيرة، ما يُمكِّن من تصميم مخططات تصفية مُلائمة للغربلة.</p>

<h1 id="تكوينات-المتجهات-القابلة-للاختزال">تكوينات المتجهات القابلة للاختزال</h1>
<p>في هذا القسم نسعى لتوصيف عائلات من مجموعات المتجهات متساوية الطول حيث تُوفِّر بعض تراكيبها الخطيّة متجهاتٍ أقصر من الأصلية.</p>
<p>نَتصوّر ابتداءً تكويناً من <span class="math inline">\(k\)</span> متجهاتٍ نموذجية على كرة ذات بُعد <span class="math inline">\((d-1)\)</span>. إذا كان <span class="math inline">\(k\)</span> صغيراً مقارنةً بـ<span class="math inline">\(d\)</span>، كانت الأزواج شبه متعامدة، فينشأ مكعّبٌ فائق تقريباً بأضلاعٍ طولُها يساوي قطر الكرة وموازيةٍ لمتجهات التكوين. نرغب في «ضغط» هذا المكعّب الفائق على طول قطرٍ رئيسي بحيث يقلّ طولُ ذلك القطر عن طول الأضلاع، الأمر الذي يضمن وجود تركيب خطيّ أقصر. إذا كانت رؤوس القطر الرئيسي هي <span class="math inline">\(\vv u_1,\ldots,\vv u_k\)</span> (والرؤوس المقابلة هي نُظائرها السالبة)، فإن المتجه
<span class="math display">
\[
\vv d=\vv u_1+\vv u_2+\cdots+\vv u_k
\]
</span>
يمثّل هذا القطر. وبمطابقة قانون التوزيع نجد
<span class="math display">
\[
\|\vv d\|^2=\ell^2\Bigl(k+\sum_{i\neq j}\cos(\vv u_i,\vv u_j)\Bigr),
\]
</span>
حيث <span class="math inline">\(\ell\)</span> طول ضلع متوازي السطوح و<span class="math inline">\(\cos(\vv u_i,\vv u_j)\)</span> جيب تمام زاوية المتجهين. ولجعل <span class="math inline">\(\|\vv d\|^2<\ell^2\)</span> يجب أن يكون <span class="math inline">\(\sum_{i\neq j}\cos(\vv u_i,\vv u_j)<-k+1\)</span>. يتحقّق أقلّ طولٍ للقطر عندما تتساوى كل الزوايا بحيث <span class="math inline">\(\cos(\vv u_i,\vv u_j)=-1/k\)</span>؛ ومن ثمّ تتجمّع المتجهات حول تكوينٍ متناظر تكون فيه الزاوية بين كل زوج <span class="math inline">\(\arccos(-1/k)\)</span>. هذا هو التكوين الذي نركّز عليه وتهدف اختباراتُنا إلى التقاطه.</p>
<p>في الحالة <span class="math inline">\(k=3\)</span> نهتمّ بالثلاثيات التي تُشكِّل متوازياتِ سطوحٍ مُسطَّحة، أي تكويناتٍ تقارب «متوازي أضلاع»، وهو ما يرتبط ارتباطاً وثيقاً بالتبعية الخطية الجزئية أو التسطّح. تُستهدَف هذه التكوينات بدوالّنا؛ إذ من المرجّح أن تُشارِك المتجهاتُ العشوائية التي تُحقِّق إسقاطاتٍ داخليةً كبيرةً على الفضاء الجزئي ثنائي الأبعاد الذي تولِّده الثلاثية، بينما تتّجه المتجهات الأخرى نحو المُتمِّم المُتعامِد، فيزداد احتمال التصادم <span class="math inline">\(k\)</span>-الطُرُقي.</p>

<h1 id="معدلات-التصادم-الثلاثية-التجريبية">مُعدّلات التصادم الثلاثية: نتائجٌ تجريبية</h1>
<p>إذا اقتصرنا على التراكيب الخطيّة لمتجهاتنا <span class="math inline">\(k\)</span> بمعاملات <span class="math inline">\(\pm1\)</span>، فإن قابليّة اختزال تكوينٍ من متجهاتٍ وحدويّة تعتمد على مجموع الجداءات الزوجيّة: يكون التكوين قابلاً للاختزال إذا كان <span class="math inline">\(\sum_{i\neq j}\vv u_i\!\cdot\!\vv u_j<-k+1\)</span>. من المثالي أن يعتمد مُعدّل التصادم فقط على هذا المجموع، لكن تماثُل التجزئة تحت الدوران يجعلنا نتوقّع اعتمادَه على مجموعة الجداءات الداخلية الزوجيّة كاملةً، وهو ما سنراه تجريبياً.</p>
<p>لبُعدٍ مُعيّن <span class="math inline">\(d\)</span>، يمكن توليد تكوينٍ عشوائي من الحجم <span class="math inline">\(k\)</span> بجداءاتٍ داخليّةٍ زوجيّة مُحدَّدة عبر إنشاء ثلاثيٍّ عشوائي ثم تطبيق خوارزمية غرام–شميدت لإعادة التحجيم. يمكن تقدير مُعدّل التصادم الثلاثي التجريبي لعائلة التجزئة الإسقاطية العشوائية <span class="math inline">\(H_{\mathcal R,a,b}\)</span>. نظرياً نتوقّع مُعدّل تصادم تقريبي <span class="math inline">\(p\approx\binom{a+b}{b}^{-(k-1)}\)</span>؛ ولعينةٍ حجمُها <span class="math inline">\(N\)</span> نتوقّع توزيعاً ثنائي الحدّين <span class="math inline">\(\mathcal B(N,p)\)</span>. ولتقدير المتوسّط بدقة 1% عند ثقة 95% نحتاج تقريباً <span class="math inline">\(N\approx10^5 p^{-2}\)</span>، ما يحدّ عمليّاً من دراسة الحالات التي يكون فيها <span class="math inline">\(p\)</span> صغيراً للغاية. ومع ذلك، لعددٍ مُحدود من قيم <span class="math inline">\(k\)</span> و<span class="math inline">\(h\)</span> نستطيع تأكيد أن الاحتمالات تعتمد أساساً على الجداءات الداخلية الزوجية، وأن النتائج مُستقرّة عددياً. اخترنا بُعداً كبيراً كفايةً لعكس المبدأ دون إثقال الحوسبة.</p>

<h2 id="النتائج-التجريبية">النتائج التجريبية</h2>
<p>نركِّز على <span class="math inline">\(k=3\)</span> ونُمثِّل الجداء الداخلي بين أزواج الثلاثية بـ <span class="math inline">\(\alpha,\beta,\gamma\)</span> بحيث <span class="math inline">\(\sigma=2(\alpha+\beta+\gamma)\)</span>. نعمل عند <span class="math inline">\(d=20\)</span> (ولم تتغيّر الخلاصات بتغيير البُعد)، ونستخدم <span class="nodecor">100,000</span> تجربة للحصول على دقّة في حدود رقمين إلى ثلاثة. نعرض عائلة التجزئة <span class="math inline">\(H_{\mathcal R,1,2}\)</span>، مع التركيز على الحالات ذات <span class="math inline">\(\alpha,\beta,\gamma<0\)</span> (حيث يكون خفض الأزواج الثنائي أفضل من الثلاثي).</p>
<p>نُلاحِظ تماثُل مجموعة النقاط تحت زمرة <span class="math inline">\(S_3\)</span> في البيانات، ويتحقّق توقّعُنا بارتفاع مُعدّل التصادم كلّما تناقصت <span class="math inline">\(\sigma\)</span>. القيَم الوسطى للتكوينات الثلاث هي تقريباً <span class="math inline">0.125, 0.134, 0.144</span>، أي أعلى بنحو 12.5% و20.5% و28.9% من المُعدّل الساذج <span class="math inline">\(1/9\)</span>. أمّا نِسَب اللوغاريتم لاحتمالات التصادم بين القيَم <span class="math inline">\(\sigma=-2.0\)</span> و<span class="math inline">\(-2.4\)</span> مثلاً فهي نحو <span class="math inline">\(1.034\)</span>، وسواها كما يلي:
<span class="math display"> 
\[
\rho(-2.0,-2.4)\approx1.034,\quad \rho(-2.0,-3.0)\approx1.035,\quad \rho(-2.4,-3.0)\approx1.070.
\]
</span></p>
<p>برفع عدد المتجهات العشوائية إلى <span class="nodecor">4</span> (أي استخدام <span class="math inline">\(H_{\mathcal R,1,3}\)</span>)، يُتوقَّع أن ينخفض المُعدّل الساذج من <span class="math inline">\(1/9\)</span> إلى <span class="math inline">\(1/16\)</span>.</p>
<p>نرى سلوكاً مُشابهاً في هذه الحالة. القيَم الوسطى الآن تقريباً <span class="math inline">0.0705, 0.0765, 0.0763</span> (تفوقٌ على السذاجة بنسبة 12.8% و22.4% و22% على التوالي). ونجد نِسَب اللوغاريتم:
<span class="math display">
\[
\rho(-2.0,-2.4)\approx1.032,\quad \rho(-2.0,-3.0)\approx1.031,\quad \rho(-2.4,-3.0)\approx0.999.
\]
</span></p>
<p>يشير هذا إلى أنّ إبقاء <span class="math inline">\(h\)</span> صغيراً لا يُقلِّل الكلفة فحسب، بل قد يُعزِّز التمييز، على الرغم من بعض الضوضاء العددية.</p>
<p>نختبر أيضاً تصادمات تجزئة «أصغر قيمةٍ مُطلقة» للفهارس (أي اختيار الفهارس ذات أصغر إسقاطاتٍ مُطلقة). لم يتغيّر نمط البيانات، لكن القيَم الوسطى أصبحت تقريباً <span class="math inline">0.126, 0.141, 0.183</span>، أي أعلى بـ 13.4% و12.7% و64.5% من المُعدّل الساذج، مع نِسَب لوغاريتم:
<span class="math display">
\[
\rho(-2.0,-2.4)\approx1.058,\quad \rho(-2.0,-3.0)\approx1.219,\quad \rho(-2.4,-3.0)\approx1.152.
\]
</span></p>
<p>يبدو أنّ «تجزئة القيمة الدنيا» أكثر قوّة من اختيار القيم الكُبرى، ما يستحقّ تحقيقاً أعمق.</p>
<p>وعند استخدام <span class="nodecor">4</span> متجهات عشوائية في تجزئة القيمة الدنيا (أي <span class="math inline">\(H_{\mathcal R,3,1}\)</span>)، نجد القيَم الوسطى <span class="math inline">\(\approx 0.0727, 0.0848, 0.127\)</span> (تفوقٌ على السذاجة بنسبة 16.3% و35.7% و103%) ونِسَب لوغاريتم:
<span class="math display">
\[
\rho(-2.0,-2.4)\approx1.063,\quad \rho(-2.0,-3.0)\approx1.270,\quad \rho(-2.4,-3.0)\approx1.196.
\]
</span></p>
<p>هذا يُشير إلى أنّ عائلة <span class="math inline">\(H_{\mathcal R,3,1}\)</span> قد تتفوّق عمليّاً على <span class="math inline">\(H_{\mathcal R,2,1}\)</span>، وهو ما يُبرّر تحرِّياً أعمق.</p>

<h1 id="تحديد-احتمالية-التصادم-المتعدد-عددياً">تحديد احتمالية التصادم المتعدِّد عدديّاً</h1>
<p>نُطوِّر في هذا القسم تعبيراً تكامليّاً لاحتمالية التصادم الثلاثي عند <span class="math inline">\(b=1\)</span>، ويمكن تعميمُه لحالات <span class="math inline">\(k\)</span> أكبر بسهولة. بالنظر إلى ثلاثية مستقلةٍ خطيّاً <span class="math inline">\((\vv v_1,\vv v_2,\vv v_3)\)</span>، نُسقِط المتجهات على الفضاء الجزئي ثلاثي الأبعاد الذي تمتدّه. وبفضل تماثُل التوزيع الكُروي، يمكن اعتبار إسقاطات <span class="math inline">\(\vv r_i\)</span> على هذا الفضاء مستقلةً وموزّعةً غاوسيّاً <span class="math inline">\(\mathcal N(0,1)\)</span> بالنسبة لأيّ قاعدةٍ مُتعامدة <span class="math inline">\(\vv i,\vv j,\vv k\)</span>. سنستخدم الرمز <span class="math inline">\(\vv r_i\)</span> للإشارة إلى تلك الإسقاطات، مع المحافظة على الجداءات الداخلية بينها وبين <span class="math inline">\(\vv v_n\)</span>.</p>
<p>وبسبب التماثُل وتجاهُل الأحداث ذات الاحتمال الصفري،
<span class="math display">
\[
\mathbb P\bigl(H(\vv v_1)=H(\vv v_2)=H(\vv v_3)\bigr)
=h\,\mathbb P\bigl(H(\vv v_1)=H(\vv v_2)=H(\vv v_3)=1\bigr).
\]
</span>
نُعرِّف <span class="math inline">\(G(\vv w;\vv v_1,\vv v_2,\vv v_3)\)</span> على أنّه احتمال أن يحقّق متجهٌ غاوسيّ عشوائي <span class="math inline">\(\vv r\)</span> الشرط
<span class="math inline">\(|\vv v_n\!\cdot\!\vv w|\le|\vv v_n\!\cdot\!\vv r|\)</span> لكل <span class="math inline">\(1\le n\le3\)</span>. وبالاستقلالية،
<span class="math display">
\[
\mathbb P\bigl(H(\vv v_1)=H(\vv v_2)=H(\vv v_3)=1\bigr)
=\int_{\vv w}G(\vv w;\vv v_1,\vv v_2,\vv v_3)^{\,h-1}\,d\mu(\vv w),
\]
</span>
حيث <span class="math inline">\(d\mu\)</span> هو القياس الغاوسي القياسي.</p>
<p>في الواقع، تعتمد <span class="math inline">\(G\)</span> فقط على الجداءات الداخلية الزوجيّة لمتجهات الإدخال <span class="math inline">\(\vv v_n\)</span>. إذا كتبنا <span class="math inline">\(\lambda_n=\vv w\!\cdot\!\vv v_n\)</span>، وكانت <span class="math inline">\(\mu_m\)</span> ترمُز إلى الجداءات الداخلية بين أزواج <span class="math inline">\(\vv v_i\)</span>، أمكننا ربط <span class="math inline">\(G\)</span> بأحجام زوايا صلبة في متوازي سطوح تُحدِّده المعادلات <span class="math inline">\(\vv r\!\cdot\!\vv v_n=\pm\lambda_n\)</span>.</p>

<h2 id="حساب-g">حساب <span class="math inline">\(G\)</span></h2>
<p>يمكن التعبير عن «كتلة» القياس الغاوسي ضمن الزوايا الصلبة المقابلة لرؤوس متوازي السطوح (المُعطاة بإحداثيات <span class="math inline">\(\vv w^{(c)}\)</span>) على هيئة تكاملاتٍ على أَرْبعياتٍ من أنصاف الفضاءات. عمليّاً، نُحوِّل المسألة إلى جهاز إحداثياتٍ يكون فيه <span class="math inline">\(\{\vv v_1,\vv v_2,\vv v_3\}\)</span> مُعيَّرةً، ثم نكتب <span class="math inline">\(\vv r\)</span> توزيعاً غاوسيّاً معيارياً على <span class="math inline">\(\mathbb R^3\)</span> مع مصفوفة تباينٍ هي المصفوفة الغرامية للثلاثية. عندئذٍ يصير <span class="math inline">\(G\)</span> تكاملاً للاحتمال فوق مُتعددة مناطق مُعرَّفة بقيودٍ من الشكل <span class="math inline">\(|\lambda_n|\le|\vv v_n\!\cdot\!\vv r|\)</span>. هذا يُختزل عددياً إلى تكاملٍ على أَثمان الفضاء بحدودٍ تعتمد فقط على الجداءات الداخلية الزوجيّة، ويمكن تقديره بدقّةٍ عالية بمُربّعات غاوسيّة أو بالعينات المُهمّة. هذا الإطار يعمّم مباشرةً إلى <span class="math inline">\(k>3\)</span> مع زيادةٍ بُعديّة محدودة.</p>

</body>
</html>