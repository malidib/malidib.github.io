<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Liwen Zhu Peking University liwenzhu@pku.edu.cn Peixi Peng Peking University pxpeng@pku.edu.cn Zongqing Lu Peking University zongqing.lu@pku.edu.cn Yonghong Tian Peking University yhtian@pku.edu.cn">
  <title>MTLight: تَعَلُّمٌ تَعْزِيزِيٌّ مُتَعَدِّدُ المَهامّ فَعّال لِلتَّحكُّمِ فِي إِشاراتِ المُرور</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
    body {
      direction: rtl;
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      font-size: 22px;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding: 0;
      line-height: 1.7;
    }
    header {
      background: linear-gradient(90deg, #3a6073 0%, #16222a 100%);
      color: #fff;
      padding: 40px 0 30px 0;
      text-align: center;
      margin-bottom: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    }
    h1.title {
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 20px;
      letter-spacing: 1px;
      line-height: 1.3;
    }
    .author {
      font-size: 1.1em;
      margin-top: 10px;
      color: #e0e0e0;
      line-height: 1.5;
    }
    .author span {
      display: inline-block;
      margin: 0 8px 0 0;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 20px 60px;
    }
    h1, h2 {
      color: #2c3e50;
      font-weight: 700;
      margin-top: 40px;
      margin-bottom: 18px;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 6px;
      letter-spacing: 0.5px;
    }
    h2 {
      font-size: 1.3em;
      margin-top: 30px;
    }
    p {
      margin: 18px 0;
      text-align: justify;
    }
    ul {
      margin: 18px 40px 18px 0;
      padding: 0 20px 0 0;
    }
    li {
      margin-bottom: 12px;
    }
    code, pre {
      background: #f3f3f3;
      color: #c7254e;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.95em;
      font-family: 'Cairo', 'Consolas', 'monospace';
    }
    .math.display, .math.inline {
      direction: ltr;
      unicode-bidi: embed;
      font-size: 1.1em;
      background: #f3f3f3;
      padding: 4px 8px;
      border-radius: 4px;
      display: block;
      margin: 12px 0;
      color: #1a237e;
      overflow-x: auto;
    }
    .nodecor {
      text-decoration: none;
      color: inherit;
    }
    @media (max-width: 700px) {
      body {
        font-size: 18px;
      }
      header {
        padding: 25px 0 18px 0;
      }
      h1.title {
        font-size: 1.5em;
      }
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">MTLight: تَعَلُّمٌ تَعْزِيزِيٌّ مُتَعَدِّدُ المَهامّ فَعّال لِلتَّحكُّمِ فِي إِشاراتِ المُرور</h1>
  <p class="author">
    <span class="nodecor">Liwen Zhu</span> |
    <span class="nodecor">Peking University</span> |
    <span class="nodecor">liwenzhu@pku.edu.cn</span><br>
    <span class="nodecor">Peixi Peng</span> |
    <span class="nodecor">Peking University</span> |
    <span class="nodecor">pxpeng@pku.edu.cn</span><br>
    <span class="nodecor">Zongqing Lu</span> |
    <span class="nodecor">Peking University</span> |
    <span class="nodecor">zongqing.lu@pku.edu.cn</span><br>
    <span class="nodecor">Yonghong Tian</span> |
    <span class="nodecor">Peking University</span> |
    <span class="nodecor">yhtian@pku.edu.cn</span>
  </p>
</header>

<main class="container">
  <h1 id="ملخص">مُلَخَّص</h1>
  <p>لِلتحكُّم في إشاراتِ المُرور أثرٌ كبير في تخفيفِ الازدحامِ المروريّ في المُدنِ الحديثة. استُخدِمَ التعلُّمُ التعزيزيّ العميق على نطاقٍ واسع لهذه المهمّة في السنوات الأخيرة، وقد أظهر أداءً واعدًا، لكنه واجه أيضًا تحدّياتٍ عدّة مثل محدوديّة الأداء وضعف كفاءة العيِّنات. لمواجهة هذه التحدّيات، نقترح <span class="nodecor">MTLight</span> لتعزيز تمثيل الحالة الكامنة عبر تتبُّع طيفٍ واسع من مَقاييسِ حركةِ المرور. وفي الوقت ذاته، نبني مهامّ مُساعِدة وإشرافيّة متعدّدة لتعلُّم هذه الحالة الكامنة، مع استخدام نوعَيْن من ميزات التضمين: ميزات خاصّة بالمهمّة وأُخرى مشتركة، بغية إغناء التمثيل الكامن. تُظهر التجارب الموسَّعة على <span class="nodecor">CityFlow</span> أنّ <span class="nodecor">MTLight</span> يمتاز بسرعةِ تقارُبٍ رائدة وأداءٍ مُنافِس. كما حاكَيْنا نمط ساعة الذروة في سيناريوهاتٍ متنوّعة مع ازدياد صعوبة التحكُّم، وأظهرت النتائج أن <span class="nodecor">MTLight</span> يتمتّع بقدرةٍ عالية على التكيُّف.</p>

  <h1 id="sec:introduction">مُقَدِّمَة</h1>
  <p>يهدف التحكُّم في إشارات المرور إلى تنسيق الإشارات عبر التقاطعات لتحسين كفاءة المرور على مستوى منطقةٍ أو مدينة، وهو ما يؤدّي دورًا هامًّا في النقل الفعّال. تَركّز الطرائق التقليدية للتحكُّم بالإشارات إمّا على التوقيت الثابت (<span class="nodecor">koonce2008traffic</span>) أو على خوارزميات حدسيّة مُصمَّمة يدويًّا (<span class="nodecor">kouvelas2014maximum</span>) وتعتمد اعتمادًا كبيرًا على الخبرة والتنقيب العميق في بيانات المرور التاريخيّة على مستوى الإقليم، ممّا يحدّ من قابليّتها للنقل. في الآونة الأخيرة، باتت الأساليب المعتمِدة على التعلُّم التعزيزي العميق (<span class="nodecor">DRL</span>) (<span class="nodecor">guo2021urban,jintao2020learning,pan2020spatio,he2020spatio,tong2021combinatorial,wang2020deep,gu2020exploiting,liu2021urban,xu2021hierarchically,zhang2021periodic</span>) تستخدم الشبكات العصبيّة العميقة لتعلُّم سياسات التحكُّم في كلّ تقاطع من خلال التفاعل المباشر مع البيئة. ومع ذلك، وبسبب كثرة المقاييس المروريّة (عدد المركبات، أطوال الطوابير، أزمنة الانتظار، السرعات، إلخ) وتعقيد الملاحظات والبيئة الديناميكيّة، لا تزال المشكلة صعبةً وغير محسومة.</p>
  <p>نظرًا لارتباط ملاحظات كلّ إشارة ومكافآتها وديناميكياتها بعضُها ببعض، فإن تحسين التحكُّم في الإشارات ضمن شبكة طرق واسعة النطاق يُمكِن تمثيله على نحوٍ طبيعيّ كمشكلة تعلُّمٍ تعزيزيّ متعددة الوكلاء (<span class="nodecor">MARL</span>). تقترح معظم الأعمال السابقة (<span class="nodecor">wei2019presslight,zhang2020generalight,chen2020toward,zheng2019learning</span>) تعلُّم سياسة كلّ وكيل بالاعتماد فقط على ملاحظات التقاطع المحليّة الأوليّة، مع إغفال الحالة العالميّة المُتاحة في المدينة الذكيّة. وكما ذُكِر في (<span class="nodecor">zheng2019diagnosing</span>)، فإن للمقاييس المختلفة أثرًا كبيرًا في مهمّة التحكُّم بالإشارات؛ لذا يجب ألّا يقتصر تصميمُ ملاحظةِ الوكيل على المعلومات المحليّة، بل أن يشمل أيضًا الحالة العالميّة.</p>
  <p>إن تصميمَ ملاحظةٍ جيّد يمكّن من الاستفادة التامّة من العيّنات، فيحسّن ليس فقط أداءَ السياسة، بل أيضًا كفاءةَ أخذِ العيّنة. بيد أنّ الحالة العالميّة تزخر بمقاييسَ مروريّةٍ عديدة، ومن الصعب تصميمُ ملاحظةٍ مناسبة وغير مُكرّرة للوكيل من بينها. فمن جهة، قد لا يَفي التصميمُ المُختصر بتمثيل خصائص الحالة على نحوٍ كافٍ، ممّا يؤثّر في دقّة تقدير انتقال الحالة واختيار الفعل. ومن جهةٍ أخرى، إذا استُخدِمت مجموعةٌ مُعقَّدة من المقاييس، فقد يصعُب ضبط أوزانها بدقّة، ما يؤدّي إلى تكرار البيانات وانفجار الأبعاد، وزيادة استهلاك الموارد الحاسوبيّة وتعقيد تعلُّم الوكيل.</p>
  <p>وعليه، ومن أجل توفير تمثيلٍ وافٍ لمهمّة التحكُّم بالإشارات، نُقَدِّم مفهوم الحالة الكامنة. بدايةً، نأخذ في الاعتبار الملاحظةَ المحليّة الأوليّة لكلّ تقاطع، ثم نُعزِّز هذه الملاحظة بجزءٍ كامن يُتعلَّم من الحالة العالميّة. ولِبناء هذا الجزء الكامن، نضع مهامّ مُساعِدة وإشرافيّة متعدّدة ذات صلة بأنماط حركة المرور؛ حيث تُعالج شبكةٌ متكرّرة (<span class="nodecor">RNN</span>) تسلسلًا من إحصاءات التاريخ العالمي، ثم تتفرّع إلى تنبّؤاتٍ مختلفة مثل توزيع التدفق المروري وأزمنة السفر. ولإثراءِ الفضاء الكامن، تستخرج البنية نوعَيْن من ميزات التضمين: ميزاتٍ خاصّة بالمهمّة وأخرى مشتركة، بحيث يُكَمِّل بعضُها بعضًا عند تعزيز الملاحظة الأوليّة. وأخيرًا، وبناءً على الملاحظة المُعزَّزة، نتعلّم السياسة باستخدام <span class="nodecor">DRL</span> (<span class="nodecor">mnih2015human</span>)، حيث تُدرَّب المهامّ المتعدّدة بالتوازي مع تعلُّم السياسة، ممّا يجعل التمثيل الكامن أكثر تكيُّفًا.</p>

  <h1 id="sec:related_work">الأَعْمالُ ذاتُ الصِّلة</h1>
  <p>تتنوّعُ أعمالُ التحكُّم في إشارات المرور بين الطرائق القائمة على التوقيت الثابت (<span class="nodecor">koonce2008traffic</span>) والحلول الحدسيّة المُصمَّمة يدويًّا (<span class="nodecor">kouvelas2014maximum</span>)، وصولًا إلى أساليب التعلُّم التعزيزي العميق (<span class="nodecor">DRL</span>) التي تتعلّم سياسات التحكُّم مباشرةً من التفاعل مع البيئة (<span class="nodecor">guo2021urban,jintao2020learning,pan2020spatio,he2020spatio,tong2021combinatorial,wang2020deep,gu2020exploiting,liu2021urban,xu2021hierarchically,zhang2021periodic</span>). يَنظر خطٌّ واسع من الأعمال إلى المشكلة على أنّها تعلُّمٌ تعزيزيّ متعدد الوكلاء (<span class="nodecor">MARL</span>) بسبب الترابط بين التقاطعات (<span class="nodecor">wei2019presslight,zhang2020generalight,chen2020toward,zheng2019learning</span>)، إلا أنّ كثيرًا منها يكتفي بالملاحظات المحليّة، مُهمِلًا الحالة العالميّة التي ثبت تأثيرها الكبير (<span class="nodecor">zheng2019diagnosing</span>). يُعالِج <span class="nodecor">MTLight</span> هذه الفجوة عبر تعلُّم حالةٍ كامنةٍ غنيّة تُدمِج المقاييس المحليّة والعالميّة مع مهامّ مُساعِدة مُشتركة وخاصّة.</p>

  <h1 id="sec:problem_statement">بَيانُ المُشْكِلَة</h1>
  <h2 id="sec:problem_definition">تَعْرِيفُ المُشْكِلَة</h2>
  <p>نَعُدّ مشكلةَ التحكُّم في إشارات المرور متعدّدةَ الوكلاء، ونُمثِّلُها كلعبةِ ماركوف (<span class="nodecor">Markov Game</span>) (<span class="nodecor">littman1994markov</span>)، والتي يمكن توصيفُها بالمجموعة <span class="math inline">\(\mathcal{G}=\langle \mathcal{N},\mathcal{S}, \mathcal{A}, \mathcal{O}, \mathcal{P}, \mathcal{R}, \mathcal{H}, \gamma\rangle\)</span>. <span class="math inline">\(\mathcal{N}=\{1, \ldots, n\}\)</span> هي مجموعةُ الوكلاء، ويُتحكَّم في كلّ تقاطع بواسطة وكيلٍ منفرد. <span class="math inline">\(\mathcal{S}\)</span> هو فضاءُ الحالة العالميّة، و<span class="math inline">\(\mathcal{A}\)</span> فضاءُ الأفعال الفردي. يمثّل الفعلُ المُشترَك <span class="math inline">\(\boldsymbol{a}\in \mathbf{A}\equiv\mathcal{A}^{n}\)</span> مجموعةَ الأفعال الفرديّة <span class="math inline">\([a_i]_{i=1}^n\)</span>. في كلّ خطوةٍ زمنيّة، يتلقّى الوكيل <span class="math inline">\(i\)</span> ملاحظة <span class="math inline">\(o_i\in\mathcal{O}\)</span>، ويختار فعلًا <span class="math inline">\(a_i\)</span>، وينتقل النظام إلى الحالة التالية <span class="math inline">\(s'\)</span> وفقًا لدالّة الانتقال <span class="math inline">\(\mathcal{P}(s'\mid s,\boldsymbol{a})\)</span>، ويحصل كلّ وكيلٍ على مكافأة <span class="math inline">\(r_i=\mathcal{R}(s,\boldsymbol{a})\)</span>. <span class="math inline">\(\mathcal{H}\)</span> هو الأفقُ الزمنيّ و<span class="math inline">\(\gamma\in[0,1)\)</span> عاملُ الخصم.</p>

  <h2 id="sec:agent_design">تَصْمِيمُ الوَكِيل</h2>
  <p>يُدير كلَّ تقاطعٍ وكيلٌ مستقل. فيما يلي نُبيِّن تصميم الملاحظة والفعل والمكافأة لوكيل التعلُّم التعزيزي.</p>
  <ul>
    <li>
      <p><strong>المُلاحَظَة.</strong> تتكوّن ملاحظةُ الوكيل الأوّليّة من جزأَيْن: (1) عدد المركبات على كلّ حارةٍ واردة <span class="math inline">\(\mathbf{f}_t^v\)</span>؛ (2) طور الإشارة الحالي <span class="math inline">\(\mathbf{f}_t^s\)</span>. يمكن الحصول على كلا الجزأين مباشرةً من المُحاكي. وتُعرَّف الملاحظةُ الأوّليّة للوكيل <span class="math inline">\(i\)</span> بـ
      <span class="math display">\[
        o_{i} = \{ \mathbf{f}_t^v, \mathbf{f}_t^s \},
      \]</span>
      حيث <span class="math inline">\(\mathbf{f}_t^v = \{V_{l_{1}^{in}}, V_{l_{2}^{in}}, \ldots, V_{l_{m}^{in}}\}\)</span> و<span class="math inline">\(\{l_{1}^{in}, \ldots, l_{m}^{in}\}\)</span> هي الحاراتُ الواردة للتقاطع، وأطوار الإشارة الحالية <span class="math inline">\(\mathbf{f}_t^s=p_k, k\in\{1,\ldots,K\}\)</span> تُمثَّل بمتجه ترميز واحد-ساخن. هدفُنا تعلُّمُ فضاءٍ كامنٍ لتعزيز هذه الملاحظة والاستفادةِ على نحوٍ أفضل من العيِّنات.</p>
    </li>
    <li>
      <p><strong>الفِعْل.</strong> فعلُ كلِّ وكيل هو اختيارُ طورِ الإشارة للفترة الزمنيّة التالية. وعلى الرغم من أنّ الأطوار قد تُنظَّم تسلسليًّا في الواقع، فإنّ الاختيار المباشر يوفّر مرونةً أكبر. ويُعرَّف فعلُ الوكيل <span class="math inline">\(i\)</span> بـ
      <span class="math display">\[
        a_{i} = \{ \mathbf{f}_t^s\},
      \]</span>
      حيث <span class="math inline">\(\mathbf{f}_t^s=p_k, k\in\{1,\ldots,K\}.\)</span></p>
    </li>
    <li>
      <p><strong>المُكافَأَة.</strong> نُعرِّف المكافأة كسالب مجموع أطوال الطوابير على الحارات الواردة، وهو معيارٌ شائع في الأعمال السابقة (<span class="nodecor">zheng2019diagnosing</span>, <span class="nodecor">huang2021modellight</span>, <span class="nodecor">zang2020metalight</span>, <span class="nodecor">zheng2019learning</span>, <span class="nodecor">wei2019colight</span>). وتُعرَّف مكافأةُ الوكيل <span class="math inline">\(i\)</span> بـ
      <span class="math display">\[
        r_{i} = -\sum_{m=1}^{M} q_{l^{in}_{m}},
      \]</span>
      حيث <span class="math inline">\(q_{l^{in}_{m}}\)</span> طولُ الطابور على الحارةِ الواردة <span class="math inline">\(l^{in}_{m}\)</span>.</p>
    </li>
  </ul>
</main>
</body>
</html>