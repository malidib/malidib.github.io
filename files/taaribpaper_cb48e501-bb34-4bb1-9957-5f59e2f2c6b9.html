<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Maximilian Jerdee, Mark Newman">
  <title>الاِسْتِدْلالُ البَيْزِيُّ لِعُمْقِ المُنافَسَةِ واحتمالِ المُفاجَأَةِ غيرِ الصِّفْرِيِّ في الترتيبِ الزَّوْجِيّ</title>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <style>
    body {
      direction: rtl;
      font-family: 'Cairo', 'Noto Naskh Arabic', 'Amiri', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      font-size: 1.15em;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding: 0;
      line-height: 1.8;
    }
    header {
      background: linear-gradient(90deg, #3a6073 0%, #16222a 100%);
      color: #fff;
      padding: 2.5em 1.5em 1.5em 1.5em;
      text-align: center;
      border-bottom-left-radius: 2em 1em;
      border-bottom-right-radius: 2em 1em;
      box-shadow: 0 2px 8px rgba(60,60,60,0.08);
    }
    h1.title {
      font-size: 2.2em;
      font-weight: 700;
      margin-bottom: 0.3em;
      letter-spacing: 0.01em;
      line-height: 1.3;
    }
    .author {
      font-size: 1.1em;
      font-weight: 400;
      margin-top: 0.5em;
      color: #e0e0e0;
    }
    main {
      max-width: 900px;
      margin: 2.5em auto 2em auto;
      background: #fff;
      border-radius: 1.5em;
      box-shadow: 0 4px 24px rgba(60,60,60,0.10);
      padding: 2.5em 2.2em 2.2em 2.2em;
    }
    h1, h2, h3, h4 {
      font-family: inherit;
      font-weight: 700;
      color: #2c3e50;
      margin-top: 2.2em;
      margin-bottom: 0.7em;
      line-height: 1.4;
    }
    h1 {
      font-size: 1.7em;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.2em;
      margin-bottom: 1.2em;
    }
    h2 {
      font-size: 1.3em;
      color: #3a6073;
      border-right: 4px solid #3a6073;
      padding-right: 0.5em;
      margin-top: 1.7em;
      margin-bottom: 0.7em;
    }
    h3 {
      font-size: 1.1em;
      color: #3a6073;
      margin-top: 1.2em;
      margin-bottom: 0.5em;
    }
    p {
      margin: 0 0 1.2em 0;
      text-align: justify;
    }
    ul, ol {
      margin: 0 0 1.2em 2em;
      padding-right: 1.5em;
    }
    ul li, ol li {
      margin-bottom: 0.5em;
      font-size: 1em;
    }
    code, pre {
      font-family: 'Fira Mono', 'Consolas', 'Monaco', monospace;
      background: #f3f3f3;
      color: #2c3e50;
      border-radius: 0.3em;
      padding: 0.15em 0.4em;
      font-size: 0.98em;
    }
    pre {
      display: block;
      padding: 1em;
      margin: 1.2em 0;
      overflow-x: auto;
      background: #f3f3f3;
      border-radius: 0.5em;
      font-size: 0.98em;
    }
    .math.display {
      display: block;
      margin: 1.2em 0;
      text-align: center;
      direction: ltr;
      unicode-bidi: embed;
    }
    .math.inline {
      font-size: 1em;
      direction: ltr;
      unicode-bidi: embed;
    }
    em {
      color: #3a6073;
      font-style: italic;
    }
    strong {
      color: #16222a;
      font-weight: 700;
    }
    .nodecor {
      text-decoration: none !important;
      color: inherit !important;
    }
    @media (max-width: 700px) {
      main {
        padding: 1.2em 0.7em 1.2em 0.7em;
      }
      header {
        padding: 1.5em 0.5em 1em 0.5em;
      }
    }
    h1:not(:first-child) {
      margin-top: 2.5em;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin: 1.5em 0;
      background: #fafbfc;
      border-radius: 0.7em;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #e0e0e0;
      padding: 0.7em 1em;
      text-align: center;
    }
    th {
      background: #e9ecef;
      color: #3a6073;
      font-weight: 700;
    }
    blockquote {
      border-right: 4px solid #3a6073;
      background: #f3f6fa;
      margin: 1.5em 0;
      padding: 1em 1.5em;
      color: #444;
      border-radius: 0.5em;
      font-size: 1em;
    }
    a {
      color: #3a6073;
      text-decoration: underline;
      transition: color 0.2s;
    }
    a:hover {
      color: #16222a;
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">الاِسْتِدْلالُ البَيْزِيُّ لِعُمْقِ المُنافَسَةِ واحتمالِ المُفاجَأَةِ غيرِ الصِّفْرِيِّ في الترتيبِ الزَّوْجِيّ</h1>
  <p class="author"><span class="nodecor">Maximilian Jerdee</span>, <span class="nodecor">Mark Newman</span></p>
</header>
<main>

<h1 id="ملخص">مُلَخَّص</h1>
<p>تُقَدِّم هذه الورقة طريقةً بَيْزِيّة لاستنتاج عمق المنافسة واحتمال المُفاجأة غير الصفري في نماذج الترتيب الزوجي. نعتمد الاستدلال البَيْزِي لتقدير هذه الكميات انطلاقاً من البيانات المرصودة للمواجهات. وبخلاف النماذج التقليدية التي تُهمِل تقلبات الأداء بين المتنافسين، يوفِّر منهجُنا تحسيناً ملحوظاً في دقة التنبؤ، ولا سيّما حين تكون التقلبات عالية.</p>

<h1 id="مقدمة">مُقَدِّمَة</h1>
<p>في سياقات عديدة مثل الرياضة والألعاب والانتخابات، يُستعمل الترتيب الزوجي لتحديد الفائز بين متنافسَيْن. تقليدياً يُفترَض أن لكل متنافس مستوى أداء ثابت، إلا أنّ الأداء في الواقع قد يتغيّر خلال الموسم أو حتى أثناء المنافسة نفسها. لذا يصبح من المهم تطوير نماذج تراعي هذه التقلبات لتحسين دقة التنبؤ.</p>

<h1 id="النموذج">النموذج</h1>
<p>نقترح إطاراً بَيْزِيّاً لتقدير عمق المنافسة واحتمال المُفاجأة. نُعرِّف عمق المنافسة بوصفه مقياساً لمدى تقارب مستويات الأداء بين المتنافسين، بينما يُقاس احتمال المُفاجأة بمدى احتمال وقوع نتيجة مخالفة للتوقعات المَبنيّة على الفروق المهارية.</p>

<h2 id="تعريف-النموذج">تعريف النموذج</h2>
<p>نقدِّم نموذجاً تمهيدياً كما يلي:
<span class="math display">\[
\begin{aligned}
P(A \text{ يفوز على } B) &= \frac{1}{1 + e^{-(\alpha_A - \alpha_B)}}, \\
\alpha_i &= \mu + \sigma X_i,
\end{aligned}
\]</span>
حيث <span class="math inline">\(\alpha_A\)</span> و<span class="math inline">\(\alpha_B\)</span> معاملا أداء للمتنافسين <span class="math inline">\(A\)</span> و<span class="math inline">\(B\)</span> على التوالي، و<span class="math inline">\(X_i\)</span> متغير عشوائي يتبع التوزيع الطبيعي المعياري. يوضّح هذا البناء كيف تؤدي تقلبات الأداء إلى تغيّر في احتمالات الفوز.</p>

<h2 id="تقدير-المعلمات">تقدير المعلمات</h2>
<p>نُقدِّر المعلمتين <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> بطرائق بَيْزِيّة اعتماداً على البيانات المرصودة، مع تحديث المعتقدات قبليّاً ولاحقاً مع ورود البيانات الجديدة، بما يُحسِّن التقديرات بمرور الوقت.</p>

<h1 id="التحقق-من-صحة-النموذج">التحقق من صحة النموذج</h1>
<p>للتحقق من صحة الإطار، نجري تحليلاً تجريبياً على بيانات واقعية من مسابقات رياضية، ونقارن تنبؤات النموذج بالنتائج الفعلية لتقييم دقته.</p>

<h1 id="النتائج">النتائج</h1>
<p>تُظهِر النتائج دقةً تنبؤية مرتفعة للنموذج، خصوصاً عندما تكون تقلبات الأداء كبيرة، ما يؤكد أهمية تضمين هذه التقلبات في نماذج الترتيب الزوجي.</p>

<h1 id="الخاتمة">الخاتمة</h1>
<p>يوفِّر نموذجُنا إطاراً متيناً لفهم وتقدير عمق المنافسة واحتمال المُفاجأة في الترتيب الزوجي. ومن خلال تضمين تقلبات الأداء، يمكن تحسين دقة التنبؤ في سياقات تنافسية متنوعة.</p>

<h1 id="مقدمة-1">مُقَدِّمَة مُوسَّعَة</h1>
<p>عند دراسة نتائج المنافسات، واختيارات المستهلكين، والترتيبات الاجتماعية، غالباً ما نحتاج إلى تحويل مقارنات زوجية بين مجموعة من العناصر إلى ترتيب كامل للمجموعة بأكملها. فقد يتنافس لاعبو شطرنج في بطولة ويُسجَّل الفوز والخسارة فيما بينهم؛ أو تُسجَّل سلسلة من التفضيلات بين أزواج المنتجات في اختبارات A/B؛ أو يتقاتل سرب من الدجاج فيما يُسجِّل الباحث مَن نقر مَن. هذا التشابه البنيوي يدعو إلى أدوات مشتركة لاستنباط ترتيب أساسي للعناصر: لإيجاد أفضل لاعب شطرنج، وأكثر المنتجات جاذبية، والأعلى هيمنةً في سلوك الدجاج (بل واستخراج الترتيب الكامل أيضاً). سنستخدم لغة اللاعبين الذين يتغلب بعضُهم على بعض في مباريات، على أن التقنيات تنطبق على طيف واسع من الإعدادات.</p>
<p>استناداً إلى ملاحظات المباريات، غالباً لا يوجد ترتيب يضمن أن الأعلى تصنيفاً يفوز دائماً على الأدنى. فحتى الأدنى تصنيفاً يفوز أحياناً. بسبب هذا الغموض، لا يظهر ترتيب وحيد غير قابل للجدل من البيانات، ويجب وضع افتراضات حول كيفية وزن انتصارات وخسائر اللاعبين. لذلك يُستَخدم عادةً نموذج احتمالي توليدي يروي قصةً مع بعض العشوائية عن كيفية تولّد النتائج الملحوظة.</p>
<p>على مدى قرن، طُوِّر طيف واسع من النماذج لهذه المهمة. في كثير منها نُسنِد لكل لاعب <span class="math inline">\(i\)</span> درجة قوة أساسية <span class="math inline">\(s_i\)</span> تعكس ميله للتغلب على الآخرين. ثم نفترض أنه عندما يلعب <span class="math inline">\(i\)</span> ضد <span class="math inline">\(j\)</span>، تُحَدَّد النتيجة بقلب عملة مُرَجَّحة بشكل مستقل: يفوز <span class="math inline">\(i\)</span> باحتمال <span class="math inline">\(p_{ij} = f(s_i - s_j)\)</span>، وهي دالة في فرق الدرجات. تكون <span class="math inline">\(f\)</span> متزايدة أحادية؛ فإذا كان <span class="math inline">\(s_i > s_j\)</span> كان <span class="math inline">\(i\)</span> أرجح للفوز. يُقدَّر عادةً متجه الدرجات الأكثر احتمالاً لإنتاج النتائج المرصودة وتُبلَّغ قيم الاحتمال الأقصى <span class="math inline">\(\text{ML}\)</span> لـ<span class="math inline">\(s_i\)</span>.</p>
<p>إذا كانت <span class="math inline">\(f\)</span> لوجستية نحصل على نموذج برادلي–تيري الشائع (صياغة زيرميلو الأصلية). وإذا كانت <span class="math inline">\(f\)</span> هي دالة التوزيع التراكمي للتوزيع الطبيعي نحصل على نموذج ثورستون. عموماً، أي اختيار معقول لـ<span class="math inline">\(f\)</span> يُولِّد نموذجاً جديداً؛ وقد اقتُرح كثيرٌ منها، وسُمّيت هذه النماذج بـ<em>النماذج الخطية</em> وفق ديفيد.</p>
<p>في هذا السياق نقترح عائلة جديدة من النماذج تُحدَّد باختيارات موسَّعة لدالة الدرجات <span class="math inline">\(f\)</span>، بوصفها تعميماً للدالة اللوجستية لنموذج برادلي–تيري. الجديد في اقتراحنا أن هذه الدوال تسمح بضبط حدّة المُفاجآت ديناميكياً واستيعاب تغيّر الأداء زمنياً، ما يجعل النموذج أكثر مرونة للتطبيقات المتنوعة. ونُبيِّن أن إعادة المعلمة إلى متغيرات أكثر قابلية للتفسير فيزيائياً مفيدة.</p>

<h1 id="التحقق-المتقاطع">التحقق المتقاطع</h1>
<p>على غرار ورقة SpringRank، نُولِّد التوزيع التنبؤي اللاحق ونُقيِّم أداء النموذج عبر تحققٍ متقاطع خُماسيّ الطِّيّات.</p>

<h1 id="النموذج-1">النموذج</h1>

<h2 id="نموذج-برادلي-تيري">نموذج برادلي–تيري</h2>
<p>لنفترض أننا نرصد مباريات بين <span class="math inline">\(n\)</span> لاعبين. نُمثِّل هذه المباريات بمصفوفة <span class="math inline">\(A\)</span> حيث <span class="math inline">\(A_{ij}\)</span> هو عدد مرّات فوز اللاعب <span class="math inline">\(i\)</span> على اللاعب <span class="math inline">\(j\)</span> لـ<span class="math inline">\(i,j=1,\dots,n\)</span>. في سياق تنافسي، يمكن فهم <span class="math inline">\(A\)</span> كجدول للسجلات المباشرة بين اللاعبين. نهدف إلى استنباط ترتيب العناصر <span class="math inline">\(n\)</span> من هذه التفاعلات المرصودة.</p>
<p>ننظُر في نماذج توليدية تُحدِّد احتمال ملاحظة <span class="math inline">\(A\)</span> اعتماداً على معلمات كامنة حقيقية <span class="math inline">\(s_i \in \mathbb{R}\)</span> لـ<span class="math inline">\(i=1,\dots,n\)</span>، تُعَدّ درجات قوة. بين كل زوج <span class="math inline">\(i,j\)</span> نأخذ احتمال فوز <span class="math inline">\(i\)</span> على <span class="math inline">\(j\)</span> بوصفه دالةً لفرق الدرجات فقط: <span class="math inline">\(p_{ij} = f(s_{ij})\)</span> حيث <span class="math inline">\(s_{ij} \equiv s_i - s_j\)</span>. يكون الاحتمال الكلّي:
<span class="math display">\[
\begin{aligned}
P(A|\vec{s},f) &= \prod_{(i,j)} f(s_{ij})^{A_{ij}},
\end{aligned}
\]</span>
حيث جمعنا الدرجات في متجه ذي بُعد <span class="math inline">\(n\)</span> هو <span class="math inline">\(\vec{s}\)</span>، ويمتد الجداء على جميع الأزواج المرتّبة <span class="math inline">\((i,j)\)</span> التي لديها تفاعلات (<span class="math inline">\(A_{ij}\neq 0\)</span>). إذا فُسِّرت <span class="math inline">\(A\)</span> كمصفوفة مجاورة فهي تمثّل حواف شبكة التفاعلات.</p>
<p>ينشأ نموذج برادلي–تيري باختيار الدالة اللوجستية:
<span class="math display">\[
\begin{aligned}
f_{BT}(s) = \frac{1}{1 + e^{-s}}.
\end{aligned}
\]</span>
وتؤدّي اختيارات أُخَر إلى نماذج بديلة، مثلاً نموذج ثورستون باستخدام دالة التوزيع التراكمي للتوزيع الطبيعي:
<span class="math display">\[
\begin{aligned}
f_{TH}(s) = \Phi(s).
\end{aligned}
\]</span>
في تحليلنا سنحصل على تعميم لنموذج برادلي–تيري، مع إمكان تطبيق طرائقنا لتوسيع نموذج ثورستون أيضاً.</p>
<p>بالنظر إلى <span class="math inline">\(A\)</span> واختيار <span class="math inline">\(f\)</span>، نُعرِّف تقديرات الاحتمال الأقصى للدرجات:
<span class="math display">\[
\begin{aligned}
\vec{s}_{\text{ML}} = \arg\max_{\vec{s}}\, P(A|\vec{s},f).
\end{aligned}
\]</span>
لكن هذا النهج يعاني مشكلاتٍ معتادة؛ فمتى ما لم تكن شبكة التفاعلات متصلة بقوة قد لا يوجد حدٌّ أقصى مُنتهٍ إذ تتباعد الدرجات.</p>
<p>يمكن تلافي ذلك بإدخال أولوية على الدرجات. نستخدم أولوية غاوسية قياسية مستقلة:
<span class="math display">\[
\begin{aligned}
P(\vec{s}) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi}} \exp\!\left(-\frac{s_i^2}{2}\right).
\end{aligned}
\]</span>
مع هذه الأولوية نُعرِّف تقدير الأرجحية العظمى بعديّاً <span class="math inline">\(\text{MAP}\)</span>:
<span class="math display">\[
\begin{aligned}
\arg\max_{\vec{s}} P(\vec{s}|A,f) = \arg\max_{\vec{s}}\, P(A|\vec{s},f)\,P(\vec{s}).
\end{aligned}
\]</span>
كما يمكن أخذ التوقعات اللاحقة للحصول على تقديرات متوقَّعة بعديّاً.</p>
<p>سننظر في عائلة من الدوال <span class="math inline">\(f\)</span> تُعرِّف عائلة من النماذج. لاختيار النموذج الملائم لمجموعة بيانات بعينها، نقارن <strong>الدليل البَيْزِي</strong>:
<span class="math display">\[
\begin{aligned}
P(A|f) = \int d\vec{s}\; P(A,\vec{s}|f) = \int d\vec{s}\; P(A|\vec{s},f) P(\vec{s}).
\end{aligned}
\]</span>
وننتقي النموذج الذي يُعظِّم الدليل:
<span class="math display">\[
\begin{aligned}
f^* = \arg\max_f P(A|f).
\end{aligned}
\]</span>
هذا التحليل البَيْزِي الكامل مُكلف حسابياً في غياب تبسيطات تحليلية، غير أنّ طرائق مونتِ كارلو الهاملتونية الحديثة تُظهِر خلطاً كافياً لإعطاء تقديرات متقاربة للدليل في تطبيقاتنا.</p>

<h2 id="تعميمنا">تعميمنا</h2>
<p>قبل تعميم نموذج برادلي–تيري ذي الدالة اللوجستية <span class="math inline">\(f_{BT}(s)=1/(1+e^{-s})\)</span>، نحدّد خصائص ينبغي أن تتوافر في أي <span class="math inline">\(f\)</span> أخرى. بما أنّ <span class="math inline">\(p_{ij} = f(s_i - s_j)=f(s_{ij})\)</span> فهي احتمال، ينبغي لكل <span class="math inline">\(s\in\mathbb{R}\)</span> أن:
<span class="math display">\[
\begin{aligned}
0 \le f(s) \le 1.
\end{aligned}
\]</span>
وفي غياب التعادلات، إما أن يفوز <span class="math inline">\(i\)</span> أو <span class="math inline">\(j\)</span>، لذا:
<span class="math display">\[
\begin{aligned}
1 = p_{ij}+p_{ji} = f(s_{ij}) + f(-s_{ij}) \;\Rightarrow\; f(-s) = 1 - f(s).
\end{aligned}
\]</span>
كما نتوقّع أن تكون <span class="math inline">\(f\)</span> غيرَ متناقصة: بزيادة الفارق المهاري يزداد احتمال فوز الأفضل. هذا القيد الأخير مفيد للتفسير وإن لم يكن ضرورياً لسلامة التعريف.</p>

<h2 id="التحسين">التحسين</h2>
<p>نوجِّه الاهتمام إلى اختيار النموذج الأمثل وفق <span class="math inline">\(P(\eta,u|A)\)</span>، حيث <span class="math inline">\(\eta\)</span> معلمة شكل للأولوية و<span class="math inline">\(u\)</span> معلمة تُلخِّص حدّة المُفاجآت. نعيد كتابة:
<span class="math display">\[
\begin{aligned}
P(\eta,u|A) &= \frac{P(\eta)\,P(u)\,P(A|\eta,u)}{P(A)}\\
&\propto P(\eta)\int d\vec{s}\; P(\vec{s}|\eta)\, P(A|\vec{s},u)\\
&\propto P(\eta)\!\int\! d\vec{s}\; P(\vec{s}|\eta^*) P(A|\vec{s},u^*)\,
\frac{P(\vec{s}|\eta)\,P(A|\vec{s},u)}{P(\vec{s}|\eta^*)\,P(A|\vec{s},u^*)}\\
&\propto P(\eta)\left\langle \frac{P(\vec{s}|\eta)\,P(A|\vec{s},u)}{P(\vec{s}|\eta^*)\,P(A|\vec{s},u^*)} \right\rangle_{\eta^*,u^*}.
\end{aligned}
\]</span>
نُقدِّر هذه التوقعات بسحب عينات <span class="math inline">\(\vec{s}\)</span> من <span class="math inline">\(P(\vec{s},A|\eta^*,u^*)=P(\vec{s}|\eta^*)P(A|\vec{s},u^*)\)</span>. يمكن استخدام المجموعة نفسها من العينات لتقدير <span class="math inline">\(P(\eta,u|A)\)</span> لعدة أزواج <span class="math inline">\((\eta,u)\)</span> قريبة من <span class="math inline">\((\eta^*,u^*)\)</span>.</p>
<p>لتحسين التقارب حين تكون نسبة الاحتمال غير متجانسة، نُعيد تحجيم التكامل:
<span class="math display">\[
\begin{aligned}
P(\eta,u|A) 
&\propto P(\eta)\!\int\! d\vec{s}\; P(\vec{s}|\eta)\, P(A|\vec{s},u)\\
&\propto P(\eta)\!\int\! d\vec{s}\; \lambda_\eta^n\, P(\lambda_\eta\vec{s}|\eta)\, P(A|\lambda_\eta\vec{s},u)\\
&\propto P(\eta)\lambda_\eta^n \!\int\! d\vec{s}\; P(\vec{s}|\eta^*) P(A|\vec{s},u^*)
\frac{P(\lambda_\eta\vec{s}|\eta)\, P(A|\lambda_\eta\vec{s},u)}{P(\vec{s}|\eta^*)\, P(A|\vec{s},u^*)}\\
&\propto P(\eta)\lambda_\eta^n \left\langle \frac{P(\lambda_\eta\vec{s}|\eta)\, P(A|\lambda_\eta\vec{s},u)}{P(\vec{s}|\eta^*)\, P(A|\vec{s},u^*)} \right\rangle_{\eta^*,u^*}.
\end{aligned}
\]</span>
لاختيار <span class="math inline">\(\lambda_\eta\)</span> قد نساوي تباين التوزيعين:
<span class="math display">\[
\begin{aligned}
\operatorname{var} P(\vec{s}|\eta^*) &= 2\,\psi_1(\eta^*), \\
\operatorname{var} P(\lambda_\eta\vec{s}|\eta) &= \frac{2}{\lambda_\eta^2}\,\psi_1(\eta),
\end{aligned}
\]</span>
فتكون
<span class="math display">\[
\begin{aligned}
\lambda_\eta = \sqrt{\frac{\psi_1(\eta)}{\psi_1(\eta^*)}}.
\end{aligned}
\]</span></p>
<ul>
  <li>نُحاذِر من الوقوع في حدودٍ محلية.</li>
  <li>نُضمِّن اختبار اتساق للطريقة في الملحق، ونُبيِّن أثر ثراء البيانات على القدرة على تمييز التأثيرات.</li>
</ul>

<h2 id="الدليل-البيزي">الدليل البَيْزِي</h2>
<p>نسأل إن كان بالإمكان إجراء التكامل داخل التوقع للتخلّص من خطأ التقريب عند الانتقال من <span class="math inline">\(P(A|\eta,u)\)</span> إلى <span class="math inline">\(P(A)\)</span> لحساب الدليل. على الأرجح لا يتاح ذلك على نحوٍ عام دون بنى خاصة تسهِّل التكامل.</p>

<h1 id="اختبار-قيمة-p-على-التوزيع-التنبؤي-اللاحق">اختبار قيمة <span class="math inline">\(p\)</span> على التوزيع التنبؤي اللاحق</h1>
<p>لشبكة معيّنة <span class="math inline">\(A\)</span> نُعرِّف قيمة <span class="math inline">\(p\)</span> لمدى اتساق الملاحظة مع نموذجٍ مختار بالسؤال عن:
<span class="math display">\[
\begin{aligned}
P\!\big(\log P(\tilde{A}|A) < \log P(A|A)\big),
\end{aligned}
\]</span>
حيث تُسحَب <span class="math inline">\(\tilde{A}\)</span> من <span class="math inline">\(P(\tilde{A}|A)\)</span>. نكتب:
<span class="math display">\[
\begin{aligned}
P(\tilde{A}|A) = \int d \vec{s}\, d\alpha\, d\beta\; P(\tilde{A}|\vec{s},\alpha,\beta)\, P(\vec{s},\alpha,\beta|A),
\end{aligned}
\]</span>
ومن ثم
<span class="math display">\[
\begin{aligned}
\log P(\tilde{A}|A) 
&= \log \!\left[\int d \vec{s}\, d\alpha\, d\beta\; P(\tilde{A}|\vec{s},\alpha,\beta)\,P(\vec{s},\alpha,\beta|A)\right]\\
&= \sum_{ij} \int d \vec{s}\, d\alpha\, d\beta\; \log P(\tilde{A}_{ij}|s_{ij},\alpha,\beta)\, P(\vec{s},\alpha,\beta|A).
\end{aligned}
\]</span></p>

<h1 id="التحقق-من-صحة-العينات-الخارجية">التحقق خارج العيِّنة</h1>
<p>نُقارن أداء نموذجنا مع نماذج أُخَر في أدبيات الترتيب الزوجي، مع تركيزٍ على التنبؤ خارج البيانات المُدرَّبة. نعتمد تحققاً متقاطعاً خُماسيّ الطِّيّات: تدريب على <span class="nodecor">80%</span> من البيانات واختبار على <span class="nodecor">20%</span> المتبقية.</p>
<p>نستخدم مقياسين. الأول بَيْزِي بالكامل، إذ نبحث عن النموذج الذي يُعظِّم التوزيع التنبؤي اللاحق <span class="math inline">\(P(A_{\text{test}}|A_{\text{train}})\)</span>:
<span class="math display">\[
\begin{aligned}
P(A_{\text{test}}|A_{\text{train}}) &= \int d \vec{s}\, du\, dd\; P(A_{\text{test}}|\vec{s},u,d)\, P(\vec{s},u,d|A_{\text{train}})\\
&\equiv \left\langle P(A_{\text{test}}|\vec{s},u,d) \right\rangle_{\vec{s},u,d|A_{\text{train}}}.
\end{aligned}
\]</span>
ونُقرِّبه بعيناتٍ لاحقة:
<span class="math display">\[
\begin{aligned}
P(A_{\text{test}}|A_{\text{train}}) \approx \frac{1}{N}\sum_{k=1}^N P(A_{\text{test}}|\vec{s}^{(k)},u^{(k)},d^{(k)}).
\end{aligned}
\]</span></p>
<p>ولأجل هذا نحتاج صياغةً بَيْزِيّة كاملة للنماذج المقارنة. نعرض بإيجاز SpringRank. لديه معامِلان فائقان <span class="math inline">\(\beta\)</span> و<span class="math inline">\(c\)</span> إضافةً إلى درجات <span class="math inline">\(\vec{s}\)</span>. الاحتمال:
<span class="math display">\[
\begin{aligned}
P(A|\vec{s},\beta,c) = \prod_{i,j}\frac{\big(c\, e^{-\frac{\beta}{2}(s_i - s_j - 1)^2}\big)^{A_{ij}}}{A_{ij}!}\;
\exp\!\left[-\,c\, e^{-\frac{\beta}{2}(s_i - s_j - 1)^2}\right],
\end{aligned}
\]</span>
أي توزيع بواسون لمعدّل <span class="math inline">\(c\, e^{-\frac{\beta}{2}(s_i - s_j - 1)^2}\)</span>. قيمة الاحتمال الأقصى لـ<span class="math inline">\(c\)</span>:
<span class="math display">\[
\begin{aligned}
c = \frac{\sum_{ij} A_{ij}}{\sum_{ij} e^{-\frac{\beta}{2} (s_i - s_j - 1)^2}},
\end{aligned}
\]</span>
وبالإدخال نحصل على لوغاريتم الاحتمال:
<span class="math display">\[
\begin{aligned}
\mathcal{L}(A|\vec{s},\beta) \propto -\,\frac{\beta}{2}\sum_{ij}A_{ij}(s_i - s_j - 1)^2 \;-\; M \log \!\left[\sum_{ij} e^{-\frac{\beta}{2} (s_i - s_j - 1)^2}\right],
\end{aligned}
\]</span>
مع إمكان إضافة أولوية Gaussian منظِّمة، حيث يستخدمون <span class="math inline">\(\alpha=2\)</span> للنسخة المُنظَّمة و<span class="math inline">\(\alpha=0\)</span> لغير المنظَّمة:
<span class="math display">\[
\begin{aligned}
P(\vec{s}) = \prod_i \exp\!\left[-\frac{\alpha \beta}{2}(s_i - 1)^2\right].
\end{aligned}
\]</span>
يُضبَط <span class="math inline">\(\beta\)</span> و<span class="math inline">\(c\)</span> غالباً بقيم الاحتمال الأقصى.</p>
<p>المقياس الثاني يعتمد قيم الاحتمال الأقصى مباشرةً للتنبؤ، بمقارنة
<span class="math display">\[
\begin{aligned}
-\log P(A_{\text{test}}|\vec{s}^*,u^*,d^*),
\end{aligned}
\]</span>
حيث <span class="math inline">\((\vec{s}^*,u^*,d^*)\)</span> تعظِّم <span class="math inline">\(P(\vec{s},u,d|A_{\text{train}})\)</span>. نقيس أيضاً الدقّة (النسبة المئوية للتطابق مع ترتيب النتائج الفعلي).</p>
<p>نُحدِّد <span class="math inline">\(\vec{s}\)</span> لتعظيم:
<span class="math display">\[
\begin{aligned}
P(\vec{s}\,|\,A_{\text{train}},u^*,d^*).
\end{aligned}
\]</span>
أي نُثبِّت المعلمات الفائقة المُحسَّنة لتحديد النموذج ثم نجد تقديرات ML للدرجات كما في النماذج الأخرى.</p>
<p>النماذج المُقارنة:</p>
<ul>
  <li>النموذج الكامل (معلمات فائقة على <span class="math inline">\(d\)</span> و<span class="math inline">\(u\)</span>).</li>
  <li>برادلي–تيري القياسي (<span class="math inline">\(u=0\)</span>، معلمة فائقة على <span class="math inline">\(d\)</span>).</li>
  <li>برادلي–تيري بَيْزِي (تغيير شكل الأولوية إلى لوجستية موحّدة تقابل <span class="math inline">\(\eta=1\)</span>، مع الضبط الموافق مثل <span class="math inline">\(\theta=0.244979\)</span>).</li>
  <li>نموذج الدالة الخطّية (تكافئ حدّ <span class="math inline">\(d\to\infty\)</span>، معلمة فائقة على <span class="math inline">\(u\)</span>).</li>
  <li>SpringRank غير المُنظَّم (<span class="math inline">\(\alpha=0\)</span>).</li>
  <li>SpringRank المُنظَّم (<span class="math inline">\(\alpha=2\)</span>).</li>
</ul>
<p>ينبغي أيضاً النظر في الاحتمال <em>المشروط</em> على النسخة غير الموجَّهة من الرسم: لنموذج برادلي–تيري:
<span class="math display">\[
\begin{aligned}
P(A|\vec{s},\bar{A}) = \prod_{(i,j)} \binom{\bar{A}_{ij}}{A_{ij}}\, f(s_{ij})^{A_{ij}}\, f(s_{ji})^{A_{ji}},
\end{aligned}
\]</span>
حيث يمتد الجداء على الحواف غير الموجَّهة <span class="math inline">\((i,j)\)</span>، و<span class="math inline">\(\bar{A}_{ij}=A_{ij}+A_{ji}\)</span>. هذا التكييف مهم خصوصاً عند تفاوت تكرارات المواجهات.</p>
<p>ومن ثم يكون التوزيع التنبؤي اللاحق المشروط على وجود المواجهات:
<span class="math display">\[
\begin{aligned}
P(A_{\text{test}}|A_{\text{train}},\bar{A}_{\text{test}}) = \int d \vec{s}\, d\alpha\, d\beta\; P(A_{\text{test}}|\vec{s},\alpha,\beta,\bar{A}_{\text{test}})\, P(\vec{s},\alpha,\beta|A_{\text{train}}).
\end{aligned}
\]</span></p>

<h1 id="النتائج-1">النتائج</h1>
<h2 id="قيم-العوامل-المثلى">قيم العوامل المثلى</h2>
<p>نستعرض قيم المعلمات الفائقة المُثلى بحسب الدليل البَيْزِي والتنبؤ خارج العيِّنة.</p>
<h2 id="التأثير-على-التصنيفات">التأثير على التصنيفات</h2>
<p>نُقارن بين تقديرات ML، وتقديرات MAP، والمتوقَّع البَعدي للدرجات، ضمن الطرحين النموذجي والأمثل، ونرصد أثر ذلك على ترتيب العناصر.</p>

<h1 id="التقريبات-العملية">التقريبات العملية</h1>
<p>التنفيذ البَيْزِي الكامل يتطلّب حسابات مكثّفة (HMC). في تطبيقات كبيرة، قد لا يكون ذلك عملياً، فنلجأ إلى تقريباتٍ أسرع.</p>

<h2 id="لا-توجد-مفاجآت-u-0">لا مُفاجآت: <span class="math inline">\(u = 0\)</span></h2>
<p>حالة <span class="math inline">\(u=0\)</span> تُعيد نموذج برادلي–تيري القياسي. نُسارع إلى تقدير درجات MAP تحت أولوية لوجستية عامة ثم نقارب بغاوسي:
<span class="math display">\[
\begin{aligned}
P(\eta|A) \propto P(A|\eta) = \int d\vec{s}\; P(A|\vec{s})\, P(\vec{s}|\eta),
\end{aligned}
\]</span>
حيث نفترض أولوية ثابتة على <span class="math inline">\(\eta\)</span> ونعتبر عرض الأولوية متغيراً. نأخذ
<span class="math display">\[
\begin{aligned}
P(\vec{s}|\eta) &= \prod_i \frac{\Gamma(2\eta)}{\Gamma(\eta)^2}\left[\frac{e^{-s_i}}{(1+e^{-s_i})^2}\right]^\eta,\\
\log P(\vec{s}|\eta) &= \sum_i \log \frac{\Gamma(2\eta)}{\Gamma(\eta)^2} + \eta \log \frac{e^{-s_i}}{(1+e^{-s_i})^2},
\end{aligned}
\]</span>
ومثلاً أولوية أسية <span class="math inline">\(P(\eta)=e^{-\eta}\)</span>. بالتوسع حول <span class="math inline">\(\vec{s}^*\)</span> قُرب نقطة سرج نحصل على تقريب لابلاس:
<span class="math display">\[
\begin{aligned}
\log P(\eta|A) &\approx -\log P(A) - \eta + \log P(A|\vec{s}^*) + \log P(\vec{s}^*|\eta) \\
&\quad + \frac{n}{2}\log(2\pi) - \tfrac{1}{2}\log\det H + \tfrac{1}{2}\,\vec{B}^{\!\top} H^{-1}\vec{B},
\end{aligned}
\]</span>
حيث
<span class="math display">\[
\begin{aligned}
H_{ij} &\equiv -\partial_i\partial_j \log P(A|\vec{s}) - \partial_i\partial_j \log P(\vec{s}|\eta),\\
B_i &\equiv \partial_i \log P(A|\vec{s}) + \partial_i \log P(\vec{s}|\eta).
\end{aligned}
\]</span>
وبالاشتقاق نحصل على
<span class="math display">\[
\begin{aligned}
\partial_i \partial_j \log P(\vec{s}|\eta) &= -\,\frac{\delta_{ij}\,\eta}{1+\cosh(s_i)}, \\
\partial_i \log P(\vec{s}|\eta) &= -\,\eta\, \tanh\!\left(\frac{s_i}{2}\right).
\end{aligned}
\]</span>
وتُستخلص مشتقات لوغاريتم الاحتمال لبرادلي–تيري تحليلياً، ثم تُستكمَل عناصر <span class="math inline">\(H,B\)</span> والمشتقات بالنسبة لـ<span class="math inline">\(\eta\)</span> عدديّاً.</p>
<p>إجمالاً، قد لا تكون <span class="math inline">\(P(\eta|A)\)</span> مُقعَّرة لوغاريتمياً دائماً في <span class="math inline">\(\eta\)</span>، لكن في أمثلتنا رُصِدت سلوكيات حسنة.</p>

<h2 id="دالة-الخطوة-eta-0">دالةُ الخُطوة: <span class="math inline">\(\eta = 0\)</span></h2>
<p>في الحدّ <span class="math inline">\(\eta=0\)</span> تُقارِب <span class="math inline">\(f_u\)</span> دالةَ خطوة تقفز من <span class="math inline">\(u\)</span> إلى <span class="math inline">\(1-u\)</span>، وهي ملائمة لهرمية قوية (كما في بعض بيانات الهيمنة الحيوانية). من منظور بَيْزِي:
<span class="math display">\[
\begin{aligned}
P(0,u|A) &\propto \int d\vec{s}\; \prod_{(i,j)} f_u(s_{ij})^{A_{ij}}
\;\propto\; \sum_{\pi \in \mathfrak{S}_n} u^{m_{\pi,A}}\,(1-u)^{m - m_{\pi,A}},
\end{aligned}
\]</span>
حيث
<span class="math display">\[
\begin{aligned}
m_{\pi,A} \equiv \sum_{(i,j)} A_{ij}\, \mathbf{1}\big(\pi(i) < \pi(j)\big),
\end{aligned}
\]</span>
و<span class="math inline">\(m\)</span> إجمالي عدد الحواف. الترتيب الأمثل يُصغِّر <span class="math inline">\(m_{\pi,A}\)</span>، ويكون <span class="math inline">\(u^* \approx m_{\pi,A}/m\)</span> إذا هيمن تبادل واحد.</p>

<h1 id="الأولوية-الفائقة-على-d">الأولوية الفائقة على <span class="math inline">\(d\)</span></h1>
<p>يحتاج عمق اللعبة <span class="math inline">\(d>0\)</span> إلى أولوية فائقة ملائمة، مثل:
<span class="math display">\[
\begin{aligned}
P(d) = e^{-d}.
\end{aligned}
\]</span></p>

<h1 id="وصف-مجموعة-البيانات">وصف مجموعة البيانات</h1>
<p>نصف هنا مجموعات البيانات المستخدمة، وكلّها متاحة علناً، وتشمل دوريات محترفة وإعدادات أكثر انفتاحاً:</p>
<ul>
  <li><strong>البوكر:</strong> مجموعة بيانات صغيرة نسبياً ونطمح إلى توسيعها.</li>
  <li><strong>التنس:</strong> جميع المباريات الرسمية في بطولات المحترفين الكبرى 2010–2019.</li>
  <li><strong>الكريكيت:</strong> بطولات دولية ومحلية (مثل IPL) بين 2010 و2019.</li>
  <li><strong>كرة القدم (Soccer):</strong> مباريات الدوريات الأوروبية الكبرى 2010–2019.</li>
  <li><strong>كرة السلة:</strong> جميع مباريات مواسم <span class="nodecor">NBA</span> الكاملة 2010–2019، مع اعتبار الفرق مختلفة بين المواسم. البيانات من <code>https://www.kaggle.com/datasets/nathanlauga/nba-games</code>.</li>
  <li><strong>البيسبول:</strong> جميع مباريات مواسم <span class="nodecor">MLB</span> الكاملة 2010–2019، مع اعتبار الفرق مختلفة بين المواسم. البيانات من <code>retrosheet.org</code>.</li>
  <li><strong>كرة القدم الأمريكية:</strong> جميع مباريات مواسم <span class="nodecor">NFL</span> الكاملة 2010–2019، مع اعتبار الفرق مختلفة بين المواسم. البيانات من <code>pro-football-reference.com</code>.</li>
  <li><strong>الهوكي:</strong> جميع مباريات مواسم <span class="nodecor">NHL</span> الكاملة 2010–2019، مع اعتبار الفرق مختلفة بين المواسم. بيانات متاحة من <code>hockey-reference.com</code> أو مصادر رسمية مماثلة.</li>
  <li><strong>شبكات الصداقة:</strong> <span class="nodecor">84</span> شبكة من الدراسة الطولية الوطنية لصحة المراهقين في الولايات المتحدة (AddHealth)، كما في ورقة براين ونيومان (<span class="nodecor">BN13</span>).</li>
</ul>

</main>
</body>
</html>