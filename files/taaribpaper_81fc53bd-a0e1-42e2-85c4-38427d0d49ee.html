<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Rui Liu ruiliu@umd.edu قِسْمِ عُلُومِ الحاسُوب جامِعَةِ ماريلاند، كوليدج بارَك Erfaun Noorani enoorani@umd.edu قِسْمِ الهَنْدَسَةِ الكَهْرَبائِيَّةِ وَالحاسُوب جامِعَةِ ماريلاند، كوليدج بارَك Pratap Tokekar tokekar@umd.edu قِسْمِ عُلُومِ الحاسُوب جامِعَةِ ماريلاند، كوليدج بارَك John S. Baras baras@umd.edu قِسْمِ الهَنْدَسَةِ الكَهْرَبائِيَّةِ وَالحاسُوب جامِعَةِ ماريلاند، كوليدج بارَك">
  <title>نَحْوَ تُدْرِج سِياسَةِ حَسّاسَةٍ لِلمَخاطِرِ فَعّالٌ: تَحْلِيلِ تَعْقِيدِ التَكْرارِ</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>body { direction: rtl; font-size: 22px; }</style>
</head>
<body>
<header>
<h1 class="title">نَحْوَ تُدْرِج سِياسَةِ حَسّاسَةٍ لِلمَخاطِرِ فَعّالٌ: تَحْلِيلِ تَعْقِيدِ التَكْرارِ</h1>
<p class="author"><span class="nodecor">Rui Liu</span><br />
<span class="nodecor">ruiliu@umd.edu</span><br />
قِسْمِ عُلُومِ الحاسُوب<br />
جامِعَةِ ماريلاند، كوليدج بارَك <span class="nodecor">Erfaun Noorani</span><br />
<span class="nodecor">enoorani@umd.edu</span><br />
قِسْمِ الهَنْدَسَةِ الكَهْرَبائِيَّةِ وَالحاسُوب<br />
جامِعَةِ ماريلاند، كوليدج بارَك <span class="nodecor">Pratap Tokekar</span><br />
<span class="nodecor">tokekar@umd.edu</span><br />
قِسْمِ عُلُومِ الحاسُوب<br />
جامِعَةِ ماريلاند، كوليدج بارَك <span class="nodecor">John S. Baras</span><br />
<span class="nodecor">baras@umd.edu</span><br />
قِسْمِ الهَنْدَسَةِ الكَهْرَبائِيَّةِ وَالحاسُوب<br />
جامِعَةِ ماريلاند، كوليدج بارَك</p>
</header>
<h1 id="ملخص">مُلَخَّصُ</h1>
<p>لَقَد أَظْهَرَ التَعَلُّمِ بِالتَعْزِيز (<span class="nodecor">RL</span>) أَداءِ اِسْتِثْنائِيّاً فِي مُخْتَلِفِ التَطْبِيقات، مِمّا يُمْكِن الوُكَلاءِ المُسْتَقِلِّينَ مِن تَعْلَم السِياساتِ المُثْلَى مِن خِلالَ التَفاعُل مَعَ بِيئاتهم. وَمَعَ ذٰلِكَ، غالِباً ما تُواجِه الأُطُر التَقْلِيدِيَّةِ لِلتَعَلُّمِ بِالتَعْزِيز تَحَدِّياتٍ مِن حَيْثُ تَعْقِيدِ التَكْرارِ وَالمَتانَة. تَمَّ اِسْتِكْشافٍ التَعَلُّمِ بِالتَعْزِيز الحَسّاسِ لِلمَخاطِرِ، الَّذِي يُوازِن بَيِّنَ العائِدِ المُتَوَقَّعِ وَالمَخاطِرُ، لَإِمْكانِيَّته فِي تَحْقِيقِ سِياساتِ قَوِيَّةٍ اِحْتِمالِيّا، وَلٰكِن تَحْلِيلِ تَعْقِيدِ التَكْرارِ الخاصِّ بِهِ لا يَزال غَيْرِ مُسْتَكْشِف بِما فِيهِ الكِفايَةُ. فِي هٰذِهِ الدِراسَةُ، نُجْرِي تَحْلِيلا شامِلاً لَتَعْقِيد التَكْرارِ لِطَرِيقَةِ تُدْرِج السِياسَةِ الحَسّاسَةِ لِلمَخاطِرِ، مَعَ التَرْكِيزِ عَلَى خوارزميه <span class="nodecor">REINFORCE</span> وَاِسْتِخْدامِ دالَّةٍ المَنْفَعَةِ الآسِيَة. نَحْصُل عَلَى تَعْقِيدِ تَكْرارِي بِمِقْدارِ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> لِلوُصُولِ إِلَى نُقْطَةً ثابِتَةٍ تَقْرِيبِيّه مِن الدَرَجَةِ الأُولَى (<span class="nodecor">FOSP</span>). نُحَقِّق فِيما إِذا كانَ بِإِمْكانِ الخوارزميات الحَسّاسَةِ لِلمَخاطِرِ تَحْقِيقِ تَعْقِيدِ تَكْرارِي أَفْضَلَ مُقارَنَةً بِنَظِيراتها غَيْرِ الحَسّاسَةِ لِلمَخاطِرِ. تُظْهِر تَحْلِيلاتنا النَظَرِيَّةِ أَنَّ <span class="nodecor">REINFORCE</span> الحَسّاسِ لِلمَخاطِرِ يُمْكِن أَنَّ يُقَلِّل مِن عَدَدٍ التكرارات المَطْلُوبَةِ لِلتَقارُب. يُؤَدِّي هٰذا إِلَى تَحْسِينِ تَعْقِيدِ التَكْرارِ، حَيْثُ أَنَّ اِسْتِخْدامِ الدالَّةِ الآسِيَة لا يَتَطَلَّب حِساباً إِضافِيّا فِي كُلِّ تَكْرارِ. نُحَدِّد الشُرُوطِ الَّتِي يُمْكِن فِيها للخوارزميات الحَسّاسَةِ لِلمَخاطِرِ تَحْقِيقِ تَعْقِيدِ تَكْرارِي أَفْضَلَ. كَما تُثْبِت نَتائِجِ المُحاكاة لَدَينا أَنَّ الحالاتِ المُتَحَفِّظَةَ تُجاهَ المَخاطِرِ يُمْكِن أَنَّ تَتَقارَب وَتَسْتَقِرّ بِشَكْلٍ أَسْرَعِ بُعْدَ حِوالِي نِصْفِ الحَلَقاتِ مُقارَنَةً بِنَظِيراتها غَيْرِ الحَسّاسَةِ لِلمَخاطِرِ.</p>
<h1 id="مقدمة">مُقَدِّمَةِ</h1>
<p>تَعْلَم التَعْزِيز (Reinforcement Learning) هُوَ مُشْكِلَةِ تَعْلَم السِياساتِ المُثْلَى مِن خِلالَ التَفاعُل مَعَ بِيئَةُ (<span class="nodecor">sutton1999policy, kaelbling1996reinforcement</span>). أَظْهَرَ تَعْلَم التَعْزِيز نَجاحاً مَلْحُوظاً فِي مَجْمُوعَةِ واسِعَةً مِن التَطْبِيقات، مِثْلَ أَلْعابِ الطاوِلَةِ وَأَلْعاب الفِيدْيُو (<span class="nodecor">silver2016mastering, mnih2013playing</span>). وَمَعَ ذٰلِكَ، مِن المُعْتَرَفِ بِهِ عَلَى نِطاقِ واسِعٍ أَنَّ تَعْلَم التَعْزِيز التَقْلِيدِيِّ يَفْتَقِر إِلَى القُوَّةِ وَيُقَصِّر فِيما يَتَعَلَّق بِكَفاءَة التَكْرارِ (<span class="nodecor">casper2023open, almahamid2021reinforcement</span>). أَحَدُ الأَسْبابِ هُوَ أَنَّ تَعْلَم التَعْزِيز التَقْلِيدِيِّ يَأْخُذ فَقَط العائِدِ المُتَوَقَّعِ فِي الاِعْتِبارِ.</p>
<p>تَعْمَل خوارزميات تَعْلَم التَعْزِيز الحَسّاسَةِ لِلمَخاطِرِ (<span class="nodecor">mihatsch2002risk, shen2014risk, berkenkamp2017safe</span>) عَلَى التَخْفِيفِ مِن هٰذِهِ المُشْكِلاتِ مِن خِلالَ أَخَذَ القِيمَةِ المُتَوَقَّعَةِ لِلأَداء وَتَقَلُّباته فِي الاِعْتِبارِ. يَسْمَح ذٰلِكَ بِضَبْطِ التَوازُنِ بَيِّنَ العائِدِ المُتَوَقَّعِ وَالتَقَلُّباتِ. النَظَرِ فِي المَخاطِرِ أَمْرٌ حاسِمٍ فِي التَطْبِيقات ذاتِ المَخاطِرِ العالِيَةِ وَالحَرَجَة لِلسَلامَةِ، مِثْلَ التَمْوِيلِ (<span class="nodecor">filos2019reinforcement, charpentier2021reinforcement</span>)، القِيادَةِ الذاتِيَّةِ (<span class="nodecor">zhang2021safe</span>) وَالرُوبُوتات (<span class="nodecor">majumdar2017risk</span>). تَمَّ اِسْتِخْدامِ مُخْتَلِفِ مَقايِيسِ المَخاطِرِ، مِثْلَ القِيمَةِ المَشْرُوطَةِ عِنْدَ الخَطَرِ (CVaR) (<span class="nodecor">qiu2021rmix, prashanth2022risk</span>)، المُكافِئات المُؤَكَّدَةِ المُحَسِّنَة (OCE) (<span class="nodecor">lee2020learning</span>) وَدالّه المَنْفَعَةِ الآسِيَة (<span class="nodecor">mihatsch2002risk, fei2020risk, eriksson2019epistemic, prashanth2022risk, noorani2021risk</span>)، لَدَمْج المَخاطِرِ فِي خوارزميات تَعْلَم التَعْزِيز. لَقَد تَمَّ إِثْباتِ قُوَّةٍ السِياساتِ المُسْتَخْدَمَةِ بِاِسْتِخْدامِ خوارزميات تَعْلَم التَعْزِيز الحَسّاسَةِ لِلمَخاطِرِ الَّتِي تُسْتَخْدَم دالَّةٍ المَنْفَعَةِ الآسِيَة تَحْلِيلِيّا وَتَمَّ أَظْهارها تَجْرِيبِيّا، عَلَى سَبِيلِ المِثالِ، أَنْظُر (<span class="nodecor">noorani2022risk</span>).</p>
<p>بَيْنَما تَمَّ اِسْتِنْتاجِ خوارزميات تَعْلَم التَعْزِيز الحَسّاسَةِ لِلمَخاطِرِ بِناءَ عَلَى هٰذِهِ المَقايِيسِ المَخاطِرِ، فَإِنَّ تَعْقِيدِ التَكْرارِ الخاصِّ بِها قَد تَلَقَّى اِهْتِماماً مَحْدُودا. وَمَعَ ذٰلِكَ، يُمْكِن أَنَّ يُوَفِّر فَهُم تَعْقِيدِ التَكْرارِ رُؤَى نَظَرِيَّةَ حَوْلَ تَعْلَم التَعْزِيز الحَسّاسِ لِلمَخاطِرِ وَيُوَجِّه تَطْوِيرِ خوارزميات أَكْثَرَ كَفاءَةِ. هُنا، نُرَكِّز عَلَى مَسْأَلَةِ تَعْقِيدِ التَكْرارِ لخوارزميات تَعْلَم التَعْزِيز الحَسّاسَةِ لِلمَخاطِرِ. وَهٰذا يَحْفِز سُؤالنا الأَساسِيُّ:</p>
<p><em>هَل تُظْهِر الخوارزميات الحَسّاسَةِ لِلمَخاطِرِ تَعْقِيدِ تَكْرارِ مُحْسِن مُقارَنَةً بالخوارزميات القِياسِيَّةِ؟</em></p>
<p>لِمُعالَجَةِ سُؤالنا الأَساسِيُّ بِشَأْنِ تَعْقِيدِ التَكْرارِ، نُرَكِّز عَلَى طَرِيقَةِ التَدَرُّج السِياسِيِّ (PG) REINFORCE (<span class="nodecor">williams1992simple, sutton1999policy, baxter2001infinite</span>) وَنَظِيرَتها الحَسّاسَةِ لِلمَخاطِرِ (<span class="nodecor">noorani2021risk</span>)، الَّتِي تُسْتَخْدَم الدالَّةِ المَنْفَعَةِ الآسِيَة.</p>
<p>لَقَد فَحَصَت الدِراساتِ السابِقَةِ تَعْقِيدِ التَكْرارِ لخوارزميه REINFORCE المُحايِدَةِ لِلمَخاطِرِ القِياسِيَّةِ، وَلٰكِن القَلِيلُ مِنها أَسْتَكْشِف تَعْقِيدِ التَكْرارِ لِ REINFORCE الحَسّاسَةِ لِلمَخاطِرِ كَما ذَكَّرَنا. قَدَّمَ (<span class="nodecor">papini2018stochastic</span>) طَرِيقَةِ التَدَرُّج السِياسِيِّ المُخَفَّض لِلتَبايُنِ العَشْوائِيِّ (SVRPG)، وَالَّتِي تَتَطَلَّب <span class="math inline">\(\cO(\epsilon^{-2})\)</span> تكرارات لِتَحْقِيقِ <span class="math inline">\(\norm{\nabla J(\theta)} \leq \epsilon\)</span>. قَدَّمَ (<span class="nodecor">xu2020improved</span>) تَحْلِيلِ تَقارُبٍ مُحْسِن لِ SVRPG وَأَظْهَرَ تَعْقِيدِ تَكْرارِ <span class="math inline">\(\cO(\epsilon^{-\frac{5}{3}})\)</span> لِتَحْقِيقِ نُقْطَةً ثابِتَةٍ تَقْرِيبِيّه مِن الدَرَجَةِ الأُولَى (FOSP). بُعْدَ ذٰلِكَ، اِقْتَرَحَ (<span class="nodecor">xu2019sample</span>) خوارزميه SRVRPG الَّتِي تَحَسُّنِ هٰذا التَعْقِيدِ التَكْرارِيّ إِلَى <span class="math inline">\(\cO(\epsilon^{-\frac{3}{2}})\)</span>. أَثْبَت (<span class="nodecor">papini2021safe</span>) تَعْقِيدِ التَكْرارِ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> لِ REINFORCE. حَقَّقَ (<span class="nodecor">yuan2022general</span>) تَعْقِيدِ تَكْرارِ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> لِلتَدَرُّج الدَقِيقِ لخوارزميه REINFORCE بِهَدَفِ الوُصُولِ إِلَى FOSP.</p>
<p><span>ccccc</span> &amp; &amp; &amp;<br />
<br />
(<span class="nodecor">papini2018stochastic</span>) &amp;مُحايِد لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-2})\)</span><br />
(<span class="nodecor">xu2020improved</span>) &amp;مُحايِد لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-\frac{5}{3}})\)</span><br />
(<span class="nodecor">xu2019sample</span>) &amp;مُحايِد لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-\frac{3}{2}})\)</span><br />
(<span class="nodecor">papini2021safe</span>) &amp;مُحايِد لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-2})\)</span><br />
(<span class="nodecor">yuan2022general</span>) &amp;مُحايِد لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-2})\)</span><br />
الخاصِّ بِنا &amp;حَسّاس لِلمَخاطِرِ &amp;FOSP &amp;<span class="math inline">\(\cO(\epsilon^{-2})\)</span><br />
</p>
<h1 id="تحليل-تعقيد-التكرار-لتعزيز-الحساسية-للمخاطر">تَحْلِيلِ تَعْقِيدِ التَكْرارِ لِتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ</h1>
<p>فِي هٰذِهِ الدِراسَةُ، نُحَلِّل تَعْقِيدِ التَكْرارِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ تَحْتَ اِفْتِراضِ عامَ لِلغايَةِ بِتَحْدِيدِ اللَحْظَةِ الثانِيَةِ لِلتَدَرُّج. هٰذا التَحْلِيلِ هُوَ الأَوَّلِ مِن نَوْعِهِ. نُقَدِّم فِي الجَدْوَلُ [table1] نَتائِجِ تَعْقِيدِ التَكْرارِ مِن بِعَضِّ الدِراساتِ السابِقَةِ عَلَى تَعْزِيزِ المَخاطِرِ المُحايِدَةِ القِياسِيَّةِ وَتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ الخاصَّةِ بِنا. مِن المَلْحُوظِ أَنَّنا لا نُقَدِّم فَقَط رُؤَى حَوْلَ تَعْقِيدِ التَكْرارِ لِتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ وَلٰكِنَّنا أَيْضاً نَقُوم بِمُقارَنَة مَعَ تَعْزِيزِ المَخاطِرِ المُحايِدَةِ القِياسِيَّةِ، وَالَّتِي تُعْتَبَر المِعْيار الأَساسِيُّ. يَكْشِف تَحْلِيلنا أَنَّ الخوارزميه الحَسّاسَةِ لِلمَخاطِرِ يُمْكِن أَنَّ تَحَقَّقَ التَقارُبِ بِعَدَدٍ أَقَلَّ مِن التكرارات تَحْتَ بِعَضِّ المَعايِيرِ الحَسّاسَةِ لِلمَخاطِرِ. بِشَكْلٍ عامَ، نُساهِم فِي ثَلاثَةِ جَوانِبَ رَئِيسِيَّةٍ وَنُناقِش هٰذِهِ المُساهَماتِ بِالتَفْصِيلِ هُنا:</p>
<p>نُجْرِي أَوَّلاً تَحْلِيلا شامِلاً لَتَعْقِيد التَكْرارِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ، وَالَّتِي تُظْهِر تَعْقِيدِ تَكْرارِ يَبْلُغ <span class="math inline">\(\cO(\epsilon^{-2})\)</span>. يَهْدِف هٰذا التَحْلِيلِ إِلَى تَحْقِيقِ نُقْطَةً ثابِتَةٍ تَقْرِيبِيّه مِن الدَرَجَةِ الأُولَى (FOSP) بِحَيْثُ <span class="math inline">\(\E{\norm{\nabla J_\beta(\theta)}} \leq \epsilon\)</span>، حَيْثُ <span class="math inline">\(J_\beta\)</span> هِيَ دالَّةٍ القِيمَةِ الحَسّاسَةِ لِلمَخاطِرِ المُعَلِّمَةُ بِواسِطَةِ <span class="math inline">\(\theta\)</span> مَعَ مَعامِلِ حَسّاس لِلمَخاطِرِ <span class="math inline">\(\beta\)</span>. يَعْتَمِد تَحْلِيلنا عَلَى اِفْتِراضِ النُعُومَة المُتَوَقَّعَةِ الَّذِي قَدَّمَهُ (<span class="nodecor">khaled2020better</span>)، كَما هُوَ مُوَضِّح فِي الاِفْتِراضُ [ass:abc]. يَحُدّ هٰذا الاِفْتِراضُ اللَحْظَةِ الثانِيَةِ لِلتَدَرُّج وَيُعْتَبَر الاِفْتِراضُ الأَكْثَرَ عُمُومِيَّةٍ لنمذجته.</p>
<p>بِشَكْلٍ مَلْحُوظٍ، قامَ (<span class="nodecor">yuan2022general</span>) بِتَحْقِيقِ مُعَدَّلاتِ التَقارُبِ وَنَتائِجَ تَعْقِيدِ التَكْرارِ لخوارزميه تَعْزِيزِ المَخاطِرِ المُحايِدَةِ القِياسِيَّةِ، مُعْتَمَدَيْنِ عَلَى هٰذا الاِفْتِراضُ، الَّذِي أَشارُوا إِلَيهِ بِاِسْمِ اِفْتِراضِ ABC. وَمَعَ ذٰلِكَ، لَم يَفْحَصُوا خوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ. اِقْتَرَحُوا أَنَّ مَجالاً مُثِيراً لِلاِهْتِمامِ لِلتَحْقِيقِ سَيَكُون تَحْدِيدِ ما إِذا كانَ يُمْكِن تَمْدِيدِ التَحْلِيلِ القائِمِ عَلَى اِفْتِراضِ ABC إِلَى مَجالاتِ أَو خوارزميات أُخْرَى. حَسَبَ عَلَّمَنا، هٰذِهِ هِيَ المَرَّةُ الأُولَى لِمِثْلِ هٰذا التَمْدِيدِ، مِمّا يُضِيف مَنْظُورا جَدِيداً إِلَى مَجالِ تَعْلَم التَعْزِيز الحَسّاسِ لِلمَخاطِرِ.</p>
<p>نُقارَن رَسْمِيّاً تَعْقِيدِ التَكْرارِ لِتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ وَتَعْزِيزِ المَخاطِرِ المُحايِدَةِ. تُظْهِر كُلّاً الخوارزميتين تَعْقِيداتٌ تَكْرارِ تَبْلُغ <span class="math inline">\(\cO(\epsilon^{-2})\)</span>، مَضْمُونه بِواسِطَةِ FOSP، وَمَعَ ذٰلِكَ، عِنْدَما يَتِمّ اِخْتِيارِ مَعامِلِ الحَسّاسِيَّةِ لِلمَخاطِرِ <span class="math inline">\(\beta\)</span> بِشَكْلٍ مُناسِبٍ، يُمْكِننا تَحْقِيقِ عَدَدٍ أَقَلَّ مِن التكرارات المَطْلُوبَةِ لِلتَقارُب للخوارزميه الحَسّاسَةِ لِلمَخاطِرِ مُقارَنَةً بالخوارزميه المُحايِدَةِ. نَقُوم بِتَحْدِيدِ مِثْلَ هٰذِهِ قِيَمِ <span class="math inline">\(\beta\)</span> فِي نَظَرِيَّةَ [the:beta].</p>
<p>نُجْرِي تَجارِبِ عَدَدَيْهِ بِاِسْتِخْدامِ بِيئَةُ المِلاحَةِ Minigrid، مُسْتَخْدَمِينَ خوارزميه تَعْزِيزِ المَخاطِرِ المُحايِدَةِ كَمِعْيارٍ أَساسِيٌّ لِلمُقارَنَة. تَسْتَقِرّ الحالاتِ المُتَحَفِّظَةَ بُعْدَ حِوالِي نِصْفِ الحَلَقاتِ مُقارَنَةً بِالحالَةِ المُحايِدَةِ. تُؤَكِّد هٰذِهِ النَتائِجِ نَتائِجنا النَظَرِيَّةِ بِأَنَّ تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ يُمْكِن أَنَّ يُظْهِر تَعْقِيدِ تَكْرارِ أَفْضَلَ مِن تَعْزِيزِ المَخاطِرِ المُحايِدَةِ القِياسِيَّةِ.</p>
<h1 id="المقدمات">المُقَدِّمات</h1>
<p>فِكْرِ فِي مُشْكِلَةِ التَحْسِين (<span class="nodecor">jain2017non</span>) المَعْرِفَةِ كَما يَلِي: <span class="math display">\[\label{eq:opt}
    \min_{\theta\in\R^d} J(\theta),\]</span> حَيْثُ تَكُون الدالَّةِ <span class="math inline">\(J(\theta)\)</span> هِيَ العائِدِ المُتَوَقَّعِ المُعَلِّمِ ب <span class="math inline">\(\theta\)</span> وَيُفْتَرَض أَنَّها سَلِسَةِ ليبشيتز، كَما فِي الاِفْتِراضُ [ass: smooth].</p>
<p>[ass: smooth] يُوجَد <span class="math inline">\(L \in \mathbb{R}^+\)</span> بِحَيْثُ، لِكُلِّ <span class="math inline">\(\theta, \theta&#39; \in \sR^d\)</span>، لَدَينا <span class="math display">\[\label{eq:smooth}
        \norm{\nabla J(\theta) - \nabla J(\theta&#39;)} \leq L \norm{\theta-\theta&#39;}.\]</span></p>
<p>تُعْطِي طَرِيقَةِ الاِنْحِدارِ التَدْرِيجِيِّ لِحَلِّ مُشْكِلَةِ التَحْسِين [eq:opt] التَكْرارِ التالِي: <span class="math display">\[\theta_{t+1} = \theta_t - \eta_t \nabla J(\theta_t),\]</span> حَيْثُ <span class="math inline">\(\eta_t\)</span> هُوَ حَجْمِ الخَطْوَةِ.</p>
<p>اِسْتِناداً إِلَى الاِفْتِراضُ [ass: smooth], <span class="math display">\[J(\theta&#39;) \leq J(\theta) + \nabla J(\theta) (\theta&#39;-\theta)^\top + \frac{L}{2}\norm{\theta&#39;-\theta}^2.\]</span> لِنَعْرِف <span class="math inline">\(g(\theta&#39;) = J(\theta) + \nabla J(\theta) (\theta&#39;-\theta)^\top + \frac{L}{2}\norm{\theta&#39;-\theta}^2\)</span>، ثُمَّ نَجْعَل مُشْتَقّه <span class="math inline">\(g(\theta&#39;)=0\)</span>، <span class="math display">\[\begin{aligned}
    \nabla J(\theta) + L(\theta&#39;-\theta) = 0, \nonumber \\
    \theta&#39;^* = \theta - \frac{1}{L} \nabla J(\theta).\end{aligned}\]</span> ثُمَّ، <span class="math display">\[J(\theta&#39;^*) \leq g(\theta&#39;^*) = J(\theta) - \frac{1}{2L}\norm{\nabla J(\theta)}^2.\]</span></p>
<p>مَعَ حَجْمِ الخَطْوَةِ <span class="math inline">\(\eta_t = \frac{1}{L}\)</span>، <span class="math display">\[J(\theta_t) -J(\theta_{t+1}) \geq \frac{1}{2L}\norm{\nabla J(\theta_t)}^2.\]</span> أَخَذَ المَجْمُوعِ عَلَى خَطَواتٍ <span class="math inline">\(T+1\)</span>، <span class="math display">\[\label{eq: convergence}
    J(\theta_0) - J(\theta^*)  \geq J(\theta_0) - J(\theta_T) \geq \frac{1}{2L}\sum_{t=0}^T\norm{\nabla J(\theta_t)}^2,\]</span> حَيْثُ <span class="math inline">\(J(\theta^*)\)</span> هُوَ القِيمَةِ العالَمِيَّةِ الأَمْثَلُ.</p>
<p>لَدَينا، <span class="math display">\[\min_{0\leq t \leq T}\norm{\nabla J(\theta_t)}^2 \leq \frac{2L(J(\theta_0) - J(\theta^*))}{T+1}.\]</span></p>
<p>بُعْدَ ذٰلِكَ، نُدْمَج المَخاطِرِ فِي الإِطارِ بِاِسْتِخْدامِ دالَّةٍ المَنْفَعَةِ الآسِيَة (<span class="nodecor">mihatsch2002risk, fei2020risk, eriksson2019epistemic, liu2023data, prashanth2022risk, noorani2021risk</span>)، مُتَحَوِّلَيْنِ مِن الهَدَفَ المُحايِد لِلمَخاطِرِ <span class="math inline">\(J\)</span> إِلَى الهَدَفَ الحَسّاسِ لِلمَخاطِرِ <span class="math inline">\(J_\beta\)</span>، حَيْثُ <span class="math inline">\(\beta\)</span> هُوَ مَعامِلِ الحَسّاسِيَّةِ لِلمَخاطِرِ. مِن خِلالَ أَخَذَ تَوَسُّعه تايْلُور، كَما هُوَ مُوَضِّح لاحِقاً فِي ، نَأْخُذ فِي الاِعْتِبارِ لَيِسَ فَقَط القِيمَةِ المُتَوَقَّعَةِ وَلٰكِن أَيْضاً التَبايُنِ، وَبِالتالِي دَمْجِ المَخاطِرِ فِي الإِطارِ. الآنَ، مِن المُهِمِّ مُلاحَظَةُ أَنَّ الهَدَفَ الحَسّاسِ لِلمَخاطِرِ <span class="math inline">\(J_\beta\)</span> يُظْهِر سَلاسَة ليبشيتز وَلٰكِن بِثابِت مُخْتَلِفِ <span class="math inline">\(L_\beta\)</span> فِي حالَتنا، كَما ثَبَتَ فِي المُلْحَقِ [apx: comparison].</p>
<p>بِناءَ عَلَى اِفْتِراضِ السَلاسَة ليبشيتز فِي الاِفْتِراضُ [ass: smooth]، نُقَدِّم الاِفْتِراضُ التالِي، الَّذِي يَحُدّ مِن اللَحْظَةِ الثانِيَةِ لِلتَدَرُّج، بِناءَ عَلَى العَمَلِ بِواسِطَةِ (<span class="nodecor">khaled2020better</span>).</p>
<p>[ass:abc] تُوجَد ثَوابِتِ <span class="math inline">\(A, B, C \in \mathbb{R}_{\geq 0}\)</span> بِحَيْثُ لِكُلِّ <span class="math inline">\(\theta \in \sR^d\)</span>، يُلَبِّي مُقَدَّر التَدَرُّج السِياسِيِّ <span class="math display">\[\E{\norm{\widehat{\nabla} J_\beta (\theta)}^2} \leq 2A(J_\beta^*-J_\beta(\theta))+B\norm{\nabla J_\beta(\theta)}^2+C.\]</span></p>
<p>بُعْدَ المُقَدِّمات حَوْلَ اِفْتِراضِ السَلاسَة لَدالّه القِيمَةِ وَمُعَلِّمه السِياسَةِ، نَدْرُس طُرُقٍ التَدَرُّج السِياسِيِّ.</p>
<h1 id="طرق-تدرج-السياسة">طُرُقٍ تُدْرِج السِياسَةِ</h1>
<p>فِي هٰذا القِسْمِ، نُناقِش طُرُقٍ تُدْرِج السِياسَةِ، بِما فِي ذٰلِكَ بِعَضِّ المُقَدِّمات حَوْلَ عَمَلِيَّةِ القَرارِ ماركوف، وخوارزميه تَعْزِيزِ، وخوارزميه تَعْزِيزِ الحَسّاسَةِ لِلمَخاطِرِ.</p>
<h2 id="عملية-القرار-ماركوف">عَمَلِيَّةِ القَرارِ ماركوف</h2>
<p>نَدْرُس عَمَلِيَّةِ القَرارِ ماركوف الَّتِي تَتَمَيَّز بِالمَجْمُوعَة <span class="math inline">\(\{\cS, \cA, \cP, r, \gamma, \rho\}\)</span>. فِي هٰذا الإِعْدادُ، <span class="math inline">\(\cS\)</span> تُمَثِّل فَضاءِ الحالَةِ، <span class="math inline">\(\cA\)</span> هُوَ فَضاءِ العَمَلِ، وَ<span class="math inline">\(\cP\)</span> هُوَ نَمُوذَجَ الاِنْتِقالِ. نَمُوذَجَ الاِنْتِقالِ، المُشارِ إِلَيهِ ب <span class="math inline">\(\cP(s&#39; \mid s, a)\)</span>، يَدُلّ عَلَى اِحْتِمالِ الاِنْتِقالِ مِن الحالَةِ <span class="math inline">\(s\)</span> إِلَى الحالَةِ <span class="math inline">\(s&#39;\)</span> عِنْدَ اِتِّخاذِ العَمَلِ <span class="math inline">\(a\)</span>. وَظِيفَةٍ المُكافَأَةَ، المُشارِ إِلَيها ب <span class="math inline">\(r(s, a)\)</span>، تُنْتِج مُكافَآت مَحْدُودَةٍ فِي نِطاقِ <span class="math inline">\([r_{\min}, r_{\max}]\)</span> لَأَزْواج الحالَةِ-العَمَلِ <span class="math inline">\((s, a)\)</span>، حَيْثُ <span class="math inline">\(r_{\max}\)</span> هُوَ ثابِتٌ مُوجِب.</p>
<p>المُعامَلاتِ <span class="math inline">\(\gamma \in [0, 1)\)</span> وَ<span class="math inline">\(\rho\)</span> تَدُلّ عَلَى عامِلٍ الخَصْمِ وَتَوْزِيعِ الحالَةِ الأَوَّلِيَّةِ، عَلَى التَوالِي. يَتِمّ اِلْتِقاطِ سُلُوكِ الوَكِيلَ مِن خِلالَ سِياسَةِ <span class="math inline">\(\pi\)</span>، الَّتِي تَقَع فِي فَضاءِ تَوْزِيعات الاِحْتِمالاتِ عَلَى الأَعْمالِ فِي كُلِّ حالَةِ. يَتِمّ تَمْثِيلِ هٰذا ك <span class="math inline">\(\pi(a\mid s)\)</span>.</p>
<p>نُحَدِّد كَثافَةُ الاِحْتِمالِ <span class="math inline">\(p(\tau \mid \pi)\)</span> لَمَسار واحِدٍ <span class="math inline">\(\tau\)</span> يَتِمّ تَوْلِيده تَحْتَ سِياسَةِ <span class="math inline">\(\pi\)</span> كَما يَلِي: <span class="math display">\[\label{eq:p}
p(\tau\mid\pi) = \rho(s_0)\prod_{t=0}^\infty\pi(a_t\mid s_t)\cP(s_{t+1}\mid s_t,a_t).\]</span> لِنَجْعَل <span class="math inline">\(\cR(\tau) \eqdef \sum_{t=0}^\infty\gamma^t r(s_t, a_t)\)</span> تَكُون المُكافَآتُ المُخَفَّضَةِ الإِجْمالِيَّةُ المُتَراكِمَةِ عَلَى طُولِ المَسارُ <span class="math inline">\(\tau\)</span>. نُحَدِّد العائِدِ المُتَوَقَّعِ المُحايِد لِلمَخاطِرِ لِ <span class="math inline">\(\pi\)</span> كَما يَلِي: <span class="math display">\[\begin{aligned}
 \label{eq:J}
J(\pi) \defeq \EE{\tau \sim p(\cdot\mid\pi)}{\cR(\tau)}.\end{aligned}\]</span></p>
<h2 id="sec:reinforce">خوارزميه تَعْزِيزِ</h2>
<p>نَعْتَبِر السِياساتِ المُعَلِّمَةُ وَالعَشْوائِيَّة، المُمَثَّلَةِ ك <span class="math inline">\(\{\pi_{\theta} : \theta \in \mathbb{R}^d\}\)</span>، مَعَ الاِفْتِراضُ الأَساسِيُّ بِأَنَّ هٰذِهِ السِياساتِ قابِلَةٍ لِلتَفاضُل بِالنِسْبَةِ لِلمَعامِل <span class="math inline">\(\theta\)</span>. دَعُونا نَعْرِف <span class="math inline">\(J(\pi_{\theta})\)</span> ك <span class="math inline">\(J(\theta)\)</span>، وَيُمْكِننا أَيْضاً التَعْبِيرِ عَن اِحْتِمالَيْهِ مَسارِ مُعَيَّنٍ بِالنَظَرِ إِلَى <span class="math inline">\(\theta\)</span> ك <span class="math inline">\(p(\tau\mid\pi_{\theta}) = p(\tau\mid\theta)\)</span>.</p>
<p>تُسْتَخْدَم طُرُقٍ تُدْرِج السِياسَةِ (PG) تَصاعُدِ التَدَرُّج داخِلَ فَضاءِ المَعامِلُ <span class="math inline">\(\theta\)</span>، لِتَحْدِيدِ السِياسَةِ الَّتِي تُعَظِّم العائِدِ المُتَوَقَّعِ. نَرْمُز لِلعائِد المُتَوَقَّعِ الأَمْثَلُ ب <span class="math inline">\(J^* \defeq J(\theta^*)\)</span>.</p>
<p>يُعَبِّر عَن تُدْرِج العائِدِ المُتَوَقَّعِ <span class="math inline">\(\nabla J(\theta)\)</span> كَما يَلِي: <span class="math display">\[\begin{aligned}
 \label{eq:GD}
\nabla J(\theta) = \int\cR(\tau)\nabla p(\tau\mid\theta)d\tau \overset{\ref{eq:p}}{=} \EE{\tau}{\sum_{t=0}^\infty\nabla_{\theta}\log\pi_{\theta}(a_{t} \mid s_{t}) \sum_{t&#39;=0}^\infty\gamma^{t&#39;} r(s_{t&#39;}, a_{t&#39;})}.\end{aligned}\]</span></p>
<p>يُمْكِن تَبْسِيطِ تُدْرِج تَعْزِيزِ بِالاِسْتِفادَةِ مِن حَقِيقَةِ أَنَّ الأَفْعال المُسْتَقْبَلِيَّةِ لا تَعْتَمِد عَلَى المُكافَآتُ السابِقَةِ. هٰذا يُؤَدِّي إِلَى الصِياغَةُ التالِيَةِ لِلتَدَرُّج الكامِلِ (<span class="nodecor">sutton2018reinforcement</span>): <span class="math display">\[\begin{aligned}
 \label{eq:pg}
    \nabla J(\theta) = \EE{\tau}{\sum_{t=0}^{\infty} \nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{t&#39;=t}^{\infty} \gamma^{t&#39;} r(s_{t&#39;}, a_{t&#39;})} = \EE{\tau}{\sum_{t=0}^{\infty} \nabla_\theta \log \pi_\theta(a_t|s_t)R(t)},\end{aligned}\]</span> حَيْثُ نَعْرِف <span class="math inline">\(\displaystyle R(t) \defeq \sum_{t&#39;=t}^\infty\gamma^{t&#39;} r(s_{t&#39;}, a_{t&#39;})\)</span> كَمُكافَآت مُخَفَّضَةٍ لِلمُسْتَقْبَلِ.</p>
<h3 id="sec:sc">تَعْقِيداتٌ تَكْرارِ تَعْزِيزِ التَعَلُّمِ</h3>
<p>تُشِير تَعْقِيداتٌ التَكْرارِ (<span class="nodecor">kakade2003sample</span>) إِلَى عَدَدٍ التَفاعُلات الَّتِي يَحْتاجها العامِلِ مَعَ بِيئَته لِلتَقارُب نَحْوَ سِياسَةِ شِبْهِ مِثالِيَّةٍ. حَقَّقَ (<span class="nodecor">yuan2022general</span>) تَعْقِيدِ تَكْرارِ بِمِقْدارِ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> لِلتَدَرُّج الدَقِيقِ لخوارزميه تَعْزِيزِ التَعَلُّمِ وَتَعْقِيد عَيِّنَةً بِمِقْدارِ <span class="math inline">\(\Tilde{\cO}(\epsilon^{-4})\)</span> لَتَقْدِير التَدَرُّج المَقْطُوع، كُلاهما يَهْدِف إِلَى الوُصُولِ إِلَى نُقْطَةً ثابِتَةٍ مِن الدَرَجَةِ الأُولَى (<span class="nodecor">FOSP</span>). اِعْتَبَرَ (<span class="nodecor">yang2021sample</span>) مَعايِيرِ التَقارُبِ لَنُقَطه ثابِتَةٍ مِن الدَرَجَةِ الثانِيَةِ (<span class="nodecor">SOSP</span>) وَحَقَّقَ تَعْقِيدِ عَيِّنَةً بِمِقْدارِ <span class="math inline">\(\cO(\epsilon^{-\frac{9}{2}})\)</span>. بِالإِضافَةِ إِلَى ذٰلِكَ، أَثْبَت (<span class="nodecor">papini2021safe</span>) تَعْقِيدِ التَكْرارِ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> لخوارزميه تَعْزِيزِ التَعَلُّمِ، وَقَدَّمَ (<span class="nodecor">papini2018stochastic</span>) طَرِيقَةِ التَدَرُّج المُخَفَّض التَبايُنِ العَشْوائِيِّ (<span class="nodecor">SVRG</span>)، وَالَّتِي تَتَطَلَّب <span class="math inline">\(\cO(\epsilon^{-2})\)</span> تكرارات لِتَحْقِيقِ <span class="math inline">\(\norm{\nabla J(\theta)} \leq \epsilon\)</span>. فِي الوَقْتِ نَفْسِهِ، اِقْتَرَحَ (<span class="nodecor">xu2019sample</span>) نَهْجٍ التَدَرُّج السِياسِيِّ المُخَفَّض التَبايُنِ العَشْوائِيِّ التَكْرارِيّ (<span class="nodecor">SRVR-PG</span>) الَّذِي يَتَطَلَّب <span class="math inline">\(\cO(\epsilon^{-\frac{3}{2}})\)</span> تكرارات لِلعُثُور عَلَى نُقْطَةً ثابِتَةٍ تَقْرِيبِيّه بِمِقْدارِ <span class="math inline">\(\epsilon\)</span> لَوَظِيفَة الأَداءِ غَيْرِ المُقَعَّرَة، المُمَيَّزَةِ ب <span class="math inline">\(\norm{\nabla J(\theta)} \leq \epsilon\)</span>.</p>
<h2 id="خوارزميه-تعزيز-الحساسية-للمخاطر">خوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ</h2>
<p>بُعْدَ مُناقَشَةِ التَدَرُّج السِياسِيِّ المُحايِد لِلمَخاطِرِ، نُراجِع التَدَرُّج السِياسِيِّ الحَسّاسِ لِلمَخاطِرِ، وَهُوَ اِمْتِدادِ لِلتَدَرُّج السِياسِيِّ التَقْلِيدِيِّ (<span class="nodecor">sutton1999policy, kakade2001natural</span>). فِي هٰذا الاِمْتِداد، الهَدَفَ هُوَ تَحْسِينِ سِياسَةِ مِن خِلالَ النَظَرِ لَيِسَ فَقَط فِي العائِدِ المُتَوَقَّعِ وَلٰكِن أَيْضاً فِي بِعَضِّ مَقايِيسِ المَخاطِرِ، مِثْلَ القِيمَةِ المَشْرُوطَةِ عِنْدَ الخَطَرِ (<span class="nodecor">qiu2021rmix, prashanth2022risk</span>)، وَمُكافِئات اليَقِينِ المُحَسِّنَة (<span class="nodecor">lee2020learning</span>) وَدالّه المَنْفَعَةِ الآسِيَة (<span class="nodecor">mihatsch2002risk, fei2020risk, eriksson2019epistemic, prashanth2022risk, noorani2021risk</span>).</p>
<p>فِي هٰذا العَمَلِ، نَسْتَخْدِم دالَّةٍ المَنْفَعَةِ الآسِيَة لَدَمْج المَخاطِرِ فِي مِقْياسِ أَداءِ النِظامِ بِسَبَبِ سُهُولَةَ حِسابها وَقابِلِيَّتها لِلتَتَبُّع الرِياضِيِّ. تَهْدِف خوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ إِلَى تَعْظِيمِ الهَدَفَ التالِي: <span class="math display">\[\label{risk-obj}
J_\beta(\pi) \eqdef \EE{\tau \sim p(\cdot \mid \pi)}{\beta e^{\beta \cR(\tau)}},\]</span> حَيْثُ <span class="math inline">\(J_\beta(\pi)\)</span> هُوَ الهَدَفَ الحَسّاسِ لِلمَخاطِرِ بِاِتِّباعِ سِياسَةِ <span class="math inline">\(\pi\)</span> وَيَفِي بِالنُعُومَة الليبشيتز فِي الاِفْتِراضُ [ass: smooth]، <span class="math inline">\(\beta \neq 0\)</span> يُمَثِّل مَعامِلِ الحَسّاسِيَّةِ لِلمَخاطِرِ، <span class="math inline">\(\cR(\tau)\)</span> يَدُلّ عَلَى المُكافَآتُ المُخَفَّضَةِ المُتَراكِمَةِ عَلَى طُولِ مَسارِ <span class="math inline">\(\tau\)</span> كَما فِي القِسْمِ [sec: mdp].</p>
<p>اِسْتَخْدَمَ بِعَضِّ الأَعْمالِ السابِقَةِ (<span class="nodecor">fei2020risk, hau2023entropic</span>) هَدَفَ مِقْياسِ المَخاطِرِ الانتروبي، المعرف ك <span class="math inline">\(\frac{1}{\beta}\log\big(\EE{\tau \sim p(\cdot \mid \pi)}{e^{\beta \cR(\tau)}}\big)\)</span>. مِن مَنْظُورٍ التَحْسِين، يَشْتَركَ هٰذا الهَدَفَ فِي نَفْسِ السِياسَةِ المُثْلَى كَهَدَفنا <span class="math inline">\(J_\beta(\pi)\)</span>، حَيْثُ أَنَّ لَدَيهِما نَفْسِ الارجماكس. تَشْتَق السِياسَةِ المُثْلَى ك <span class="math inline">\(\pi^* = \arg\max_\pi J_\beta (\pi)\)</span>. مِن خِلالَ أَخَذَ تَوَسُّعه تايْلُور لِلهَدَف الحَسّاسِ لِلمَخاطِرِ: <span class="math display">\[\begin{aligned}
 \label{eq:taylor}
\E{\beta e^{\beta \cR(\tau)}} = \beta + \beta^2 \E{\cR(\tau)} + \frac{\beta^3}{2} \E{\cR^2(\tau)} + \cO(\beta^4).\end{aligned}\]</span></p>
<p>فِي الحالاتِ الَّتِي يَكُون فِيها <span class="math inline">\(\beta\)</span> سالِبا (يَعْكِس السُلُوكِ المُتَحَفِّظِ تُجاهَ المَخاطِرِ)، يُصْبِح تَعْظِيمِ <span class="math inline">\(J_\beta(\pi)\)</span> مُكافِئا لَتَعْظِيم العائِدِ المُتَوَقَّعِ وَتَقْلِيل تَبايُنٍ العائِدِ، مِمّا يُساعِد عَلَى اِسْتِقْرارِ التَعَلُّمِ. بِالمُقابِلِ، عِنْدَما يَكُون <span class="math inline">\(\beta\)</span> مُوجِبا (يُشِير إِلَى السُلُوكِ الباحِثُ عَن المَخاطِرِ)، يُصْبِح تَعْظِيمِ <span class="math inline">\(J_\beta(\pi)\)</span> مُكافِئا لَتَعْظِيم كُلِّ مِن العائِدِ المُتَوَقَّعِ وَتَبايُنٍ العائِدِ.</p>
<p>نَهْدِف إِلَى اِسْتِكْشافٍ ما إِذا كانَ تَعْدِيلِ مَعامِلِ الحَسّاسِيَّةِ لِلمَخاطِرِ يُمْكِن أَنَّ يُقَلِّل مِن تَعْقِيدِ التَكْرارِ لِتَعْزِيزِ المُتَحَفِّظِ تُجاهَ المَخاطِرِ مُقارَنَةً بِتَعْزِيزِ المُحايِد لِلمَخاطِرِ. تَحْقِيقِ ذٰلِكَ سَيَكُون مُفِيداً لِلغايَةِ حَيْثُ سَيَسْمَح بِالمَتانَةِ وَالتَقارُبَ الأَسْرَعَ فِي نَفْسِ الوَقْتِ.</p>
<p>يُعَبِّر عَن تُدْرِج الهَدَفَ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ كَما يَلِي:</p>
<p><span class="math display">\[\begin{aligned}
 \label{eq:risk-pg}
\nabla J_\beta(\theta) &amp;= \EE{\tau}{\sum_{t=0}^\infty\nabla_{\theta}\log\pi_{\theta}(a_{t} \mid s_{t}) \cdot \beta e^{\beta R(t)}},\end{aligned}\]</span></p>
<p>حَيْثُ <span class="math inline">\( R(t) \defeq \sum_{t&#39;=t}^\infty\gamma^{t&#39;} r(s_{t&#39;}, a_{t&#39;})\)</span> هِيَ المُكافَآتُ المُخَفَّضَةِ المُتَبَقِّيَةُ كَما عَرَفْنا فِي القِسْمِ [sec:reinforce].</p>
<p>ثُمَّ يُمْكِننا الحُصُولِ عَلَى تَقْدِيرٍ تَجْرِيبِيٍّ لِلتَدَرُّج مَعَ <span class="math inline">\(N\)</span> مَساراتٍ وَأُفُقُ <span class="math inline">\(H\)</span> فِي المُمارِسَةِ العَمَلِيَّةِ: <span class="math display">\[\label{eq: risk-empirical-gradient}
    \hnabla J_\beta(\theta) = \frac{1}{N}\sum_{i=1}^N\sum_{t=0}^{H-1}\nabla_{\theta}\log\pi_{\theta}(a_{t}^i \mid s_{t}^i) \cdot \beta e^{\beta R^i(t)}.\]</span></p>
<p>تَقُوم خوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ بِتَحْدِيثِ مُعَلِّمات السِياسَةِ بِاِسْتِخْدامِ النُزُولِ التَدْرِيجِيِّ: <span class="math display">\[\begin{aligned}
 \label{eq:GA}
\theta_{t+1}  =  \theta_t - \eta_t\hnabla J_\beta(\theta_t)\end{aligned}\]</span> حَيْثُ <span class="math inline">\(\eta_t &gt; 0\)</span> هُوَ حَجْمِ الخَطْوَةِ فِي التَكْرارِ <span class="math inline">\(t\)</span>-th.</p>
<h1 id="مقارنة-تعقيد-التكرار-بين-تعزيز-المخاطر-الحساسة-والمحايدة">مُقارَنَةً تَعْقِيدِ التَكْرارِ بَيِّنَ تَعْزِيزِ المَخاطِرِ الحَسّاسَةِ وَالمُحايِدَة</h1>
<h2 id="sec:risk sc">تَعْقِيدِ تَكْرارِ تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ</h2>
<p>نُطَوِّر تَحْلِيلِ تَعْقِيدِ التَكْرارِ لِتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ، بِهَدَفِ الوُصُولِ إِلَى نُقْطَةً ثابِتَةٍ مِثْلِي مُتَوَقَّعَةٍ، اِسْتِناداً إِلَى الاِفْتِراضُ (<span class="nodecor">ass:abc</span>) (<span class="nodecor">khaled2020better</span>) الَّذِي يُقَيِّد اللَحْظَةِ الثانِيَةِ لِلتَدَرُّج. بَيْنَما طَبَّقَ (<span class="nodecor">yuan2022general</span>) هٰذا الاِفْتِراضُ بِنَجاحٍ عَلَى تَعْزِيزِ الحَسّاسِيَّةِ المُحايِدَةِ لِلمَخاطِرِ، لَم يَسْتَكْشِفُوا النَظِير الحَسّاسِ لِلمَخاطِرِ. تَمْتَدّ أَبْحاثنا هٰذِهِ التَحْلِيلِ إِلَى تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ، وَالَّذِي يُقَدِّم وِجْهَةِ نَظَرِ جَدِيدَةٍ حَوْلَ هٰذا المَوْضُوعِ.</p>
<p>بِاِفْتِراض أَنَّ الاِفْتِراضات (<span class="nodecor">ass: smooth</span>) وَ (<span class="nodecor">ass:abc</span>) صَحِيحَةٍ، نَسْتَنْتِج النَتِيجَةُ التالِيَةِ، وَالَّتِي تَتْبَع مِن النَظَرِيَّةِ <span class="nodecor">3.4</span> فِي (<span class="nodecor">yuan2022general</span>):</p>
<p>[cor:abc] بِالنِسْبَةِ لِلهَدَف الحَسّاسِ لِلمَخاطِرِ <span class="math inline">\(J_\beta\)</span>، يُشار إِلَى ثابِتٌ النُعُومَة ليبشيتز ب <span class="math inline">\(L_\beta\)</span>. يَقَع حَجْمِ الخَطْوَةِ <span class="math inline">\(\eta\)</span> ضِمْنَ النِطاقِ <span class="math inline">\(\left(0, \frac{2}{LB}\right)\)</span>. هُنا، نُلاحِظ أَنَّ <span class="math inline">\(B=0\)</span> يَعْنِي أَنَّ <span class="math inline">\(\eta \in (0, \infty) \)</span>. نَعْرِف <span class="math inline">\(\delta_0 \defeq J_\beta^* - J_\beta(\theta_0)\)</span>. لَدَينا أَنَّ <span class="math display">\[\begin{aligned}
\min_{0\leq t\leq T-1} &amp; \E{\norm{\nabla J_\beta(\theta_t)}^2} \leq \frac{2\delta_0(1+L_\beta \eta^2A)^T}{\eta T(2-L_\beta B\eta)} + \frac{L_\beta C\eta}{2-L_\beta B\eta}.\nonumber\end{aligned}\]</span></p>
<p>نُقَدِّم دَلِيلٌ النَتِيجَةُ (<span class="nodecor">cor:abc</span>) فِي المُلْحَقِ (<span class="nodecor">apx: abc</span>).</p>
<p>[cor:sc] فِي سِياقِ النَتِيجَةُ (<span class="nodecor">cor:abc</span>)، وَلِقِيمَة مُعَيَّنَةٍ <span class="math inline">\(\epsilon &gt; 0\)</span>، دَعْ <span class="math inline">\(\eta = \min\big\{\frac{1}{\sqrt{L_\beta AT}}, \frac{1}{L_\beta B}, \frac{\epsilon}{2L_\beta C}\big\}\)</span>. إِذا كانَ عَدَدٍ التكرارات <span class="math inline">\(T\)</span> يُلَبِّي الشَرْطُ التالِي: <span class="math display">\[\begin{aligned}
    T \geq \frac{12\delta_0L_\beta}{\epsilon^2}\max\left\{B, \frac{12\delta_0A}{\epsilon^2}, \frac{2C}{\epsilon^2}\right\} \defeq n_\beta, \label{eq:T}\end{aligned}\]</span> فَإِنَّ <span class="math inline">\(\displaystyle \min_{0\leq t\leq T-1} \E{\norm{\nabla J_\beta(\theta_t)}^2} = \cO(\epsilon^2)\)</span>.</p>
<p>يُمْكِننا الحُصُولِ عَلَى النَتِيجَةُ (<span class="nodecor">cor:sc</span>) مِن العَمَلِ بِواسِطَةِ (<span class="nodecor">khaled2020better</span>). وِفْقاً لِلنَتِيجَة (<span class="nodecor">cor:abc</span>) وَالنَتِيجَةُ (<span class="nodecor">cor:sc</span>)، فَإِنَّ تَعْقِيدِ التَكْرارِ لِلحُصُولِ عَلَى التَدَرُّج الكامِلِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ هُوَ <span class="math inline">\(T = \cO(\epsilon^{-2})\)</span>. بُعْدَ عَلَى الأَقَلِّ <span class="math inline">\(n_\beta\)</span> تكرارات، يُمْكِننا تَحْقِيقِ نُقْطَةً ثابِتَةٍ مِثْلِي مُتَوَقَّعَةٍ تَقْرِيبِيّه ب <span class="math inline">\(\epsilon\)</span>. يَعْتَمِد التَعْقِيدِ عَلَى ثابِتٌ النُعُومَة ليبشيتز <span class="math inline">\(L_\beta\)</span>.</p>
<p>عِنْدَ تَحْلِيلِ تَعْقِيدِ التَكْرارِ لِكُلِّ مِن خوارزميات تَعْزِيزِ الحَسّاسِيَّةِ المُحايِدَةِ وَالحَسّاسَة لِلمَخاطِرِ، سَنَقُوم بِإِجْراءِ مُقارَنَةً بَيِّنَهُما. اِسْتِناداً إِلَى العَمَلِ بِواسِطَةِ (<span class="nodecor">yuan2022general</span>)، نَعْرِف <span class="math display">\[n \defeq \frac{12\delta_0L}{\epsilon^2}\max\left\{B, \frac{12\delta_0A}{\epsilon^2}, \frac{2C}{\epsilon^2}\right\},\]</span> كَعَدَد التكرارات لِتَحْقِيقِ نُقْطَةً ثابِتَةٍ مِثْلِي مُتَوَقَّعَةٍ تَقْرِيبِيّه ب <span class="math inline">\(\epsilon\)</span> لِتَعْزِيزِ المُحايِد لِلمَخاطِرِ. الهَدَفَ الأَساسِيُّ هُوَ الإِجابَةَ عَلَى السُؤالُ: هَل يُمْكِننا تَحْقِيقِ تَعْقِيدِ تَكْرارِ أَقَلَّ لِتَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ مُقارَنَةً بِتَعْزِيزِ المُحايِد لِلمَخاطِرِ، بِشَكْلٍ أَساسِيٌّ <span class="math inline">\(n_\beta &lt; n\)</span>، وَتَحْتَ أَيّ ظُرُوفٍ يُمْكِن تَحْقِيقِ ذٰلِكَ، خاصَّةٍ فِيما يَتَعَلَّق بِاِخْتِيارِ المُعَلِّمَةُ الحَسّاسَةِ لِلمَخاطِرِ؟ إِذا اِسْتَطَعْنا تَحْقِيقِ هٰذا الهَدَفَ، فَسَيَكُون ذٰلِكَ مُفِيداً لِلغايَةِ حَيْثُ يَعْنِي أَنَّهُ عِنْدَ النَظَرِ فِي المَخاطِرِ أَثْناءَ عَمَلِيَّةِ اِتِّخاذِ القَرارِ، يُمْكِننا فِي الوَقْتِ نَفْسِهِ تَقْلِيلِ عَدَدٍ التكرارات المَطْلُوبَةِ لِلتَعَلُّمِ.</p>
<p>[ass: risk-value-ratio] أَفْتَرِض أَنَّ هُناكَ قِيَماً لَمَعامِل الحَسّاسِيَّةِ لِلمَخاطِرِ <span class="math inline">\(\beta\)</span>، بِحَيْثُ يَكُون الآتِي صَحِيحاً: <span class="math display">\[|\beta| e^{|\beta| \sum_{t=0}^\infty\gamma^t\left|r(s_t, a_t)\right|} &lt; \sum_{t=0}^\infty\gamma^t|r(s_t, a_t)|,\]</span></p>
<p>لِنَعْرِف <span class="math inline">\(\alpha\)</span> كَنِسْبَة بَيِّنَ هٰذَيْنِ القِيمَتَيْنِ: <span class="math display">\[\label{eq: ratio}
\alpha = \frac{|\beta| e^{|\beta|\sum_{t=0}^\infty\gamma^t|r(s_t,a_t)|}}{\sum_{t=0}^\infty\gamma^t|r(s_t,a_t)|}, \ 0&lt;\alpha&lt;1.\]</span></p>
<p>الاِفْتِراضُ (<span class="nodecor">ass: risk-value-ratio</span>) يَعْنِي بِشَكْلٍ أَساسِيٌّ أَنَّنا نَهْدِف إِلَى تَحْدِيدِ قِيَمِ لَمَعامِل الحَسّاسِيَّةِ لِلمَخاطِرِ <span class="math inline">\(\beta\)</span>، بِحَيْثُ تَكُون دالَّةٍ القِيمَةِ للخوارزميه الحَسّاسَةِ لِلمَخاطِرِ أَصْغَرِ مِن تِلْكَ الخاصَّةِ بالخوارزميه المُحايِدَةِ لِلمَخاطِرِ، عَلَى طُولِ أَيّ مَسارِ <span class="math inline">\(\tau\)</span> يَتَضَمَّن تَسَلْسُلات مِن الحالاتِ وَالإِجْراءات. مِن الضَرُورِيِّ التَأْكِيدُ عَلَى أَنَّنا نَسْعَى لِلعُثُور عَلَى وُجُودِ مِثْلَ هٰذِهِ القِيَمِ <span class="math inline">\(\beta\)</span> بَدَلاً مِن تِلْكَ العالَمِيَّةِ، حَيْثُ أَنَّ تَحْقِيقِ العالَمِيَّةِ غَيْرِ عَمَلِيٍّ. وُجُودِ مِثْلَ هٰذِهِ القِيَمِ لَيِسَ مُقَيَّدا؛ بَل هُوَ ذُو قِيمَةَ عالِيَةٍ حَيْثُ قَد يُمْكِننا مِن تَحْقِيقِ القُوَّةِ وَالتَقارُبَ السَرِيعِ فِي آنٍ واحِدٍ. مِن خِلالَ اِسْتِخْدامِ دالَّةٍ المَنْفَعَةِ الآسِيَة وَضَمانِ صِحَّةِ الاِفْتِراضُ (<span class="nodecor">ass: risk-value-ratio</span>)، يُمْكِننا إِعادَةِ تَشْكِيلِ بِنْيَةَ وَخَصائِصَ النُعُومَة لَدالّه القِيمَةِ بِفَعّالِيَّةٍ.</p>
<p>ثُمَّ نُقَدِّم الاِفْتِراضُ التالِي الَّذِي يَحُدّ مِن التَدَرُّج والهسيان لِلسِياسَةِ، وَالَّذِي سَيَتِمّ اِسْتِخْدامه لَاِشْتِقاق ثابِتٌ النُعُومَة ليبشيتز <span class="math inline">\(L\)</span> وَ<span class="math inline">\(L_\beta\)</span> لِكُلِّ مِن تَعْزِيزِ المُحايِد وَالحَسّاس لِلمَخاطِرِ.</p>
<p>[ass:lipschitz_smooth_policy] تُوجَد ثَوابِتِ <span class="math inline">\(F_1, F_2 &gt; 0\)</span> بِحَيْثُ أَنَّهُ لِكُلِّ حالَةِ <span class="math inline">\(s\in S\)</span>، يُلَبِّي التَدَرُّج المُتَوَقَّعِ والهسيان لِ <span class="math inline">\(\log\pi_\theta(\cdot\mid s)\)</span> الشُرُوطِ التالِيَةِ: <span class="math display">\[\begin{aligned}
\EE{a\sim\pi_\theta(\cdot\mid s)}{\norm{\nabla_\theta\log\pi_\theta(a \mid s)}^2} &amp; \leq F_1^2, \label{eq:G2} \\
\EE{a\sim\pi_\theta(\cdot\mid s)}{\norm{\nabla^2_\theta\log\pi_\theta(a\mid s)}} &amp;\leq F_2. \label{eq:F} \end{aligned}\]</span></p>
<h1 id="الثابت-النعومة-ليبشيتز">الثابِتُ النُعُومَة ليبشيتز</h1>
<p>الثابِتُ النُعُومَة ليبشيتز يَقِيس نَعُومه دالَّةٍ، وَبِالأَخَصّ تُدْرِجها. بَيْنَما لا يَضْمَن ثابِتٌ النُعُومَة ليبشيتز الأَصْغَرِ بَيِّنَ خوارزميتين تَقارُباً أَسْرَعِ بِالضَرُورَةِ، حَيْثُ أَنَّهُ يَعْمَل فَقَط كَحَدٍّ أَعْلَى لِلتَدَرُّج، تُشِير تَحْلِيلاتنا، كَما هُوَ مُوَضِّح فِي النَتِيجَةُ (<span class="nodecor">cor:sc</span>) وَالمَدْعُومَة بِواسِطَةِ (<span class="nodecor">Khaled <span class="nodecor">et al</span>. (2020)</span>), إِلَى أَنَّ عَدَدٍ التكرارات المَطْلُوبَةِ لِلتَقارُب يَعْتَمِد خَطِّيّا عَلَى ثابِتٌ النُعُومَة ليبشيتز. وَبِالتالِي، يُمْكِن لِتَقْلِيلِ ثابِتٌ النُعُومَة ليبشيتز أَنَّ يُقَلِّل فِعْلِيّاً مِن عَدَدٍ التكرارات، مِمّا يَعْنِي تَحْسِينِ تَعْقِيدِ التَكْرارِ عِنْدَ مُقارَنَةً خوارزميتين إِذا كانَ لَدَيهِما نَفْسِ التَكْلِفَةِ الحِسابِيَّة لِكُلِّ تَكْرارِ. هٰذا صَحِيحٌ بِالنِسْبَةِ لَمُقارَنَتنا بَيِّنَ تَعْزِيزِ المَخاطِرِ وَتَعْزِيزِ المَخاطِرِ المُحايِدَةِ، حَيْثُ أَنَّ اِسْتِخْدامِ الأَداة المنفعيه الآسِيَة لا يُضِيف تَكْلِفَةِ حِسابِيَّةً إِضافِيَّةً.</p>
<p>لِذٰلِكَ، فِي هٰذا السِياقِ، سَنَقُوم بِاِشْتِقاق وَمُقارَنَة ثابِتٌ النُعُومَة ليبشيتز <span class="math inline">\(L\)</span> وَ <span class="math inline">\(L_\beta\)</span> عَلَى التَوالِي:</p>
<p>أَفْتَرِض أَنَّ الاِفْتِراضات (<span class="nodecor">ass: smooth</span>), (<span class="nodecor">ass: risk-value-ratio</span>) وَ (<span class="nodecor">ass:lipschitz_smooth_policy</span>) صَحِيحَةٍ. لَدَينا أَنَّ <span class="math display">\[\begin{aligned}
    L &amp;=&amp; \frac{r_{max}}{(1-\gamma)^2}(F_1^2 + F_2), \nonumber \\
    L_\beta &amp;=&amp; \alpha L,\end{aligned}\]</span></p>
<p>حَيْثُ <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> هُوَ النِسْبَةِ فِي الاِفْتِراضُ (<span class="nodecor">ass: risk-value-ratio</span>)، وَالَّتِي تُمَثِّل عامِلٍ ضَرْبِ يُقَلِّل <span class="math inline">\(L_\beta\)</span> مُقارَنَةً ب <span class="math inline">\(L\)</span>. دَرَجَةِ الخَفْضِ تَعْتَمِد عَلَى القِيمَةِ الخاصَّةِ لَمَعامِل حَسّاسِيَّةٍ المَخاطِرِ <span class="math inline">\(\beta\)</span>. <span class="math inline">\(r_{max}\)</span> هُوَ الحَدِّ الأَقْصَى لِلمُكافَأَة، <span class="math inline">\(\gamma\)</span> هُوَ عامِلٍ الخَصْمِ، <span class="math inline">\(F_1\)</span> وَ <span class="math inline">\(F_2\)</span> هُما الثَوابِتِ الَّتِي تَحُدّ التَدَرُّج والهسيان لِلسِياسَةِ كَما هُوَ مُوَضِّح فِي الاِفْتِراضُ (<span class="nodecor">ass:lipschitz_smooth_policy</span>). نُقَدِّم دَلِيلٌ الاِشْتِقاق لِ <span class="math inline">\(L\)</span> وَ <span class="math inline">\(L_\beta\)</span> فِي المُلْحَقِ (<span class="nodecor">apx: comparison</span>).</p>
<p>كَما هُوَ مَذْكُورٌ فِي (<span class="nodecor">eq: ratio</span>)، دَعُونا نَعْرِف <span class="math inline">\(x=\sum_{t=0}^\infty\gamma^t|r(s_t,a_t)|\)</span>، وَبِالتالِي: <span class="math display">\[\alpha(x) = \frac{|\beta| e^{|\beta|x}}{x}, \ x&gt;0.\]</span></p>
<p>بَيْنَما تَرْتَبِط دالَّةٍ القِيمَةِ اِرْتِباطا وَثِيقاً بِإِجْراءِ تُدْرِج السِياسَةِ، هُنا يُمْكِننا مُعامَلَتها كَمُتَغَيِّر وَحِساب المُشْتَقَّة الأُولَى لِ <span class="math inline">\(\alpha\)</span> عَلَيها. سَواءُ كانَ بِإِمْكانِ <span class="math inline">\(\alpha\)</span> أَخَذَ القِيمَةِ الأَمْثَلُ <span class="math inline">\(x^*\)</span> الَّتِي يَتِمّ تَحْقِيقِها بِتَعْيِينِ المُشْتَقَّة الأُولَى إِلَى الصِفْرِ، سَيَعْتَمِد عَلَى إِجْراءِ تُدْرِج السِياسَةِ.</p>
<p><span class="math display">\[\nabla \alpha(x) = \frac{|\beta|e^{|\beta|x}(|\beta|x-1)}{x^2},\]</span></p>
<p>عِنْدَما <span class="math inline">\(\nabla \alpha(x^*) = 0, x^* = \frac{1}{|\beta|}\)</span>. إِذا كانَ بِإِمْكانِ <span class="math inline">\(\alpha\)</span> أَخَذَ القِيمَةِ الدُنْيا عِنْدَ <span class="math inline">\(x^*\)</span> فَإِنَّ <span class="math inline">\(\alpha_{min}=\beta^2 e\)</span>، مِن أَجْلِ أَنَّ يَكُون <span class="math inline">\(0&lt;\alpha&lt;1\)</span> لِبَعْضِ قِيَمِ <span class="math inline">\(\beta\)</span>، نَحْتاج <span class="math display">\[\begin{aligned}
    \beta^2 e &amp;&lt;&amp; 1, \nonumber \\
    |\beta| &amp;&lt;&amp; e^{-\frac{1}{2}}. \end{aligned}\]</span></p>
<p>عِلاوَةً عَلَى ذٰلِكَ، <span class="math inline">\(x=\sum_{t=0}^\infty\gamma^t|r(s_t,a_t)| \leq \frac{r_{max}}{1-\gamma}\)</span>، وَبِالتالِي، إِذا <span class="math inline">\(\frac{1}{|\beta|} &lt; \frac{r_{max}}{1-\gamma}\)</span>، فَإِنَّ <span class="math display">\[\begin{aligned}
    |\beta| &amp;&gt;&amp; \frac{1-\gamma}{r_{max}}, \nonumber \\
    \frac{1-\gamma}{r_{max}} &lt; &amp;|\beta|&amp; &lt; e^{-\frac{1}{2}}. \end{aligned}\]</span> إِذا كانَ <span class="math inline">\(\frac{1}{|\beta|} &gt; \frac{r_{max}}{1-\gamma}\)</span>، فَإِنَّ <span class="math inline">\(\alpha(x)\)</span> لا يُمْكِن أَنَّ يَأْخُذ القِيمَةِ الدُنْيا <span class="math inline">\(\beta^2 e\)</span> عِنْدَ <span class="math inline">\(x^*\)</span>. فِي النِطاقِ <span class="math inline">\(0&lt;x\leq \frac{r_{max}}{1-\gamma}\)</span>، <span class="math inline">\(\alpha(x)\)</span> تَتَناقَص تَناقَصا أُحادِيّا. وَبِالتالِي، <span class="math display">\[\begin{aligned}
    \alpha(\frac{r_{max}}{1-\gamma}) &amp;&lt;&amp; 1, \nonumber \\
    |\beta| e^{|\beta| \frac{r_{max}}{1-\gamma}} &amp;&lt;&amp; \frac{r_{max}}{1-\gamma}, \nonumber \\
    |\beta| &amp;&lt;&amp; k,\end{aligned}\]</span> حَيْثُ <span class="math inline">\(k\)</span> هُوَ ثابِتٌ يَعْتَمِد عَلَى <span class="math inline">\(r_{max}\)</span> وَ <span class="math inline">\(\gamma\)</span>. ثُمَّ، <span class="math display">\[\begin{equation}
|\beta| &lt; \min\{\frac{1-\gamma}{r_{max}}, k\}.\]</span></p>
<p>اِسْتِناداً إِلَى التَحْلِيلِ النَظَرِيّ أَعْلاه، لَدَينا النَظَرِيَّةِ التالِيَةِ:</p>
<p>[the:beta] تُوجَد مَجْمُوعَةِ مِن القِيَمِ لِ <span class="math inline">\(\beta\)</span>: <span class="math display">\[\label{eq:beta_range}
    \frac{1-\gamma}{r_{max}} &lt; |\beta| &lt; e^{-\frac{1}{2}} \ or \ |\beta| &lt; \min\{\frac{1-\gamma}{r_{max}}, k\}, \ \beta \neq 0,\]</span> مِمّا يُؤَدِّي إِلَى <span class="math inline">\(L_\beta &lt; L\)</span>، وَبِالتالِي <span class="math inline">\(n_\beta &lt; n\)</span>، مِمّا يَعْنِي تَقْلِيلِ تَعْقِيدِ التَكْرارِ لِ REINFORCE الحَسّاسِ لِلمَخاطِرِ مُقارَنَةً ب REINFORCE الخالِي مِن المَخاطِرِ.</p>
<h1 id="التجارب">التَجارِبِ</h1>
<p>لِلتَحَقُّقِ مِن تَحْلِيلنا النَظَرِيّ الَّذِي يُشِير إِلَى أَنَّ الخوارزميات الحَسّاسَةِ لِلمَخاطِرِ يُمْكِن أَنَّ تَحَقَّقَ تَعْقِيدِ تَكْرارِ مُحْسِن تَحْتَ قِيَمِ مُعَيَّنَةٍ لِلمَعامِل الحَسّاسِ لِلمَخاطِرِ، أَجْرَيْنا تَجارِبِ مُحاكاةَ بِاِسْتِخْدامِ بِيئَةُ المِلاحَةِ MiniGrid (<span class="nodecor">MinigridMiniworld23</span>). عَلَى وَجْهِ التَحْدِيدِ، اُسْتُخْدِمْنا بِيئَةُ <em>MiniGrid-Empty-Random</em>-6x6، حَيْثُ يَجِب عَلَى العامِلِ عَلَى شَكْلٍ مُثَلَّثِ أَحْمَر أَنَّ يَتَنَقَّل عَبْرَ غُرْفَةِ فارِغَةً لِلوُصُولِ إِلَى المُرَبَّعِ الأَخْضَرِ الَّذِي يُمَثِّل الهَدَفَ وَالَّذِي يُوَفِّر مُكافَأَةٍ مُتَقَطِّعَةً. يُمْكِن لِلعامِل اِتِّخاذِ الإِجْراءاتِ <em>{يَسارِ، يَمِين، إِلَى الأَمامِ}</em>. تَقَدَّمَ النُسَخِ العَشْوائِيَّةِ مِن هٰذِهِ البِيئَةِ تَعْقِيداً إِضافِيّا مِن خِلالَ بَدْء العامِلِ مِن مَوْقِعِ عَشْوائِيٍّ فِي بِدايَةِ كُلِّ حَلْقَةِ. هٰذا التَعْشِيق يَزِيد مِن التَبايُنِ فِي عَمَلِيَّةِ التَعَلُّمِ وَيُوَفِّر أَعْداداً مُناسِبا لَتَجارِبنا.</p>
<p>فِي المُمارِسَةِ العَمَلِيَّةِ، لا يُمْكِن حِسابِ التَدَرُّج الكامِلِ نَظَراً لِأَنَّهُ يَتَطَلَّب التَوَسُّط عَلَى جَمِيعِ المَساراتِ المُحْتَمَلَةِ <span class="math inline">\(\tau\sim p(\cdot \mid \theta)\)</span> وَأُفُقُ لا نِهائِيِّ. لِذٰلِكَ، نَسْتَخْدِم تَقْدِيراً تَجْرِيبِيّا لِلتَدَرُّج يَتِمّ الحُصُولِ عَلَيهِ مِن خِلالَ أَخَذَ عَيِّنَةً مِن مَجْمُوعَةِ مِن المَساراتِ المَقْطُوعَةِ <span class="math inline">\(N=10\)</span> لِكُلِّ تَكْرارِ، مُشار إِلَيها ب <span class="math inline">\(\tau_i = \left(s_0^i, a_0^i, r_0^i, s_1^i, \cdots, s_{H-1}^i, a_{H-1}^i, r_{H-1}^i\right)\)</span>. وَنَقُوم بِتَدْرِيبِ العامِلِ لِ <span class="math inline">\(800\)</span> تَكْرارِ. تَمَّ الحُصُولِ عَلَى هٰذِهِ المَساراتِ مِن خِلالَ تَنْفِيذِ <span class="math inline">\(\pi_{\theta}\)</span> لَأُفُق ثابِتٌ <span class="math inline">\(H=200\)</span>. وَعامِلٌ الخَصْمِ <span class="math inline">\(\gamma=0.99\)</span>، <span class="math inline">\(r_{max}=1\)</span>، <span class="math inline">\(r_{min}=0\)</span>. نَسْتَخْدِم شَبَكَةِ الإِدْراك المُتَعَدِّدِ الطَبَقاتِ (MLP) مَعَ طَبَقَةٌ مَخْفِيّه واحِدَةٍ تَحْتَوِي عَلَى <span class="math inline">\(64\)</span> عُقْدَةِ كَشَبَكَةٍ سِياسَةِ وAdam (<span class="nodecor">kingma2014adam</span>) كَمُحْسِن بِمُعَدَّلِ تَعْلَم <span class="math inline">\(0.001\)</span>.</p>
<p>أَجْرَيْنا تَجارِبِ المِلاحَةِ لِكُلِّ مِن السِينارِيُوهات المُحايِدَةِ لِلمَخاطِرِ والحذره مِن المَخاطِرِ مَعَ <span class="math inline">\(\beta=\{-0.1, -0.2, -0.5, -10.0\}\)</span>، مُسْتَخْدَمِينَ الحالَةِ المُحايِدَةِ لِلمَخاطِرِ كَأَساسٍ لِلمُقارَنَة. وَقُمْنا بتوسيط نَتائِجِ المُحاكاة عَلَى ثَلاثِ بُذُورِ عَشْوائِيَّةٍ مُخْتَلِفَةٍ. مِن خِلالَ مُراقَبَةِ النَتائِجِ، مِن الواضِحِ أَنَّهُ عِنْدَما تَقَع قِيمَةَ <span class="math inline">\(|\beta|\)</span> ضِمْنَ النِطاقِ المُحَدَّدِ فِي نَظَرِيَّةَ [the:beta]، فَإِنَّ الخوارزميه تَتَعَلَّم بِفَعّالِيَّةٍ، كَما يَتَّضِح مِن زِيادَةِ المُكافَأَةَ الَّتِي تَقْتَرِب مِن <span class="nodecor">1.0</span> وَاِنْخِفاضَ مِعْيار التَدَرُّج. عِنْدَما يَكُون <span class="math inline">\(|\beta|=10.0\)</span>، يُصْبِح التَدَرُّج كَبِيراً جِدّاً، مِمّا يُعِيق عَمَلِيَّةِ التَعَلُّمِ.</p>
<p>وِفْقاً لَمِعْيار التَقارُبِ FOSP، حَيْثُ يَكُون مِعْيار التَدَرُّج أَقَلَّ مِن أَو يُساوِي <span class="math inline">\(\epsilon\)</span>، فَإِنَّهُ يُشِير إِلَى أَنَّ الخوارزميه الحذره مِن المَخاطِرِ تَتَطَلَّب عَدَداً أَقَلَّ مِن التكرارات لِلتَعَلُّمِ وَيُمْكِن أَنَّ تَتَقارَب بِشَكْلٍ أَسْرَعِ تَحْتَ قِيَمِ مُعَيَّنَةٍ مِن المَعامِلُ الحَسّاسِ لِلمَخاطِرِ.</p>
<p>يَسْتَقِرّ بُعْدَ حِوالِي 4000 حَلْقَةِ، بَيْنَما تَسْتَقِرّ الحالاتِ الَّتِي تَتَجَنَّب المُخاطِرَة مَعَ <span class="math inline">\(\beta = -0.2, -0.5\)</span> بُعْدَ حِوالِي 3000 حَلْقَةِ، فِي حِينِ يَحْدُث ذٰلِكَ بُعْدَ حِوالِي 7300 حَلْقَةِ لِلحالَةِ المُحايِدَةِ لِلمَخاطِرِ. عَدَدٍ الحَلَقاتِ اللازِمَةِ لِلتَقارُب لِلحالات الَّتِي تَتَجَنَّب المُخاطِرَة يُقارِب نِصْفِ عَدَدٍ الحَلَقاتِ اللازِمَةِ لِلتَقارُب لِلحالَةِ المُحايِدَةِ لِلمَخاطِرِ. هٰذِهِ المُلاحَظَةُ تُؤَكِّد أَنَّ الخوارزميات الَّتِي تَتَجَنَّب المَخاطِرِ يُمْكِن أَنَّ تَحَقَّقَ تَعْقِيدِ تَكْرارِي أَقَلَّ، وَهُوَ ما يَتَماشَى أَيْضاً مَعَ الشَكْلِ [fig:g]، الَّذِي يُوَضِّح أَنَّ الخوارزميه الَّتِي تَتَجَنَّب المَخاطِرِ تَتَقارَب بِشَكْلٍ أَسْرَعِ إِلَى نُقْطَةً ثابِتَةٍ مِن الدَرَجَةِ الأُولَى.</p>
<h1 id="الاستنتاجات">الاِسْتِنْتاجاتِ</h1>
<p>فِي هٰذا العَمَلِ، نَبْدَأ بِتَحْلِيلِ تَعْقِيدِ التَكْرارِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ، حَيْثُ نُحَقِّق تَعْقِيدِ تَكْرارِ يَبْلُغ <span class="math inline">\(\cO(\epsilon^{-2})\)</span> بِهَدَفِ الوُصُولِ إِلَى نُقْطَةً ثابِتَةٍ مِن الدَرَجَةِ الأُولَى. يَمُدّ هٰذا التَحْلِيلِ فَرْضِيَّةَ النُعُومَة المُتَوَقَّعَةِ مِن الأَعْمالِ السابِقَةِ وَيُمَثِّل أَوَّلِ تَمْدِيدِ لِتَحْلِيلِ تَعْقِيدِ التَكْرارِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ. بُعْدَ ذٰلِكَ، نُقارَن تَعْقِيدِ التَكْرارِ لخوارزميه تَعْزِيزِ الحَسّاسِيَّةِ لِلمَخاطِرِ مَعَ نَظِيرَتِها غَيْرِ الحَسّاسَةِ لِلمَخاطِرِ، الَّتِي تُعْتَبَر كَأَساسٍ مُقارَنَةً. تُشِير نَتائِجنا إِلَى أَنَّ الخوارزميه الحَسّاسَةِ لِلمَخاطِرِ يُمْكِن أَنَّ تَحَقَّقَ التَقارُبِ بِعَدَدٍ أَقَلَّ مِن التكرارات. نُحَدِّد الشُرُوطِ الَّتِي قَد تُظْهِر فِيها خوارزميه الحَسّاسِيَّةِ لِلمَخاطِرِ تَعْقِيدِ تَكْرارِ أَفْضَلَ. هٰذا الاِكْتِشافِ مُهِمٌّ لِأَنَّهُ يُشِير إِلَى أَنَّهُ أَثْناءَ الأَخْذِ بِعَيْنِ الاِعْتِبارِ المَخاطِرِ خِلالَ عَمَلِيَّةِ اِتِّخاذِ القَرارِ، يُمْكِننا فِي الوَقْتِ نَفْسِهِ تَقْلِيلِ عَدَدٍ التكرارات المَطْلُوبَةِ لِلتَعَلُّمِ. لِلتَحَقُّقِ مِن نَتائِجنا النَظَرِيَّةِ، نُجْرِي تَجارِبِ مُحاكاةَ لِلمِلاحَة فِي بِيئَةُ Minigrid مَعَ مَعايِيرِ حَسّاسَةٍ لِلمَخاطِرِ المُتَغَيِّرَة. النَتائِجِ تَدْعَم بِاِسْتِمْرارٍ نَتائِجنا النَظَرِيَّةِ، حَيْثُ يُمْكِن أَنَّ يَكُون عَدَدٍ الحَلَقاتِ لِلتَقارُب فِي جَمِيعِ الحالاتِ الحذره مِن المَخاطِرِ تَقْرِيباً نِصْفِ عَدَدٍ الحَلَقاتِ لِلتَقارُب فِي حالَةِ عَدَمِ الحَسّاسِيَّةِ لِلمَخاطِرِ.</p>
</body>
</html>
