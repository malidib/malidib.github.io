<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Naoufal El Bekri, Lucas Drumetz, Franck Vermet">
  <title>تَدَفُّقاتُ التَّطْبِيعِ ذاتُ التَّغْيِيرِ الزَّمَنيّ لِنمذجةِ المُعادَلاتِ التَّفاضُلِيَّةِ العَشْوائِيَّةِ بِدِقَّة</title>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
    body {
      direction: rtl;
      font-family: 'Cairo', 'Noto Naskh Arabic', 'Amiri', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      font-size: 22px;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding: 0;
      line-height: 1.7;
    }
    header {
      background: linear-gradient(90deg, #3a6073 0%, #16222a 100%);
      color: #fff;
      padding: 2.5rem 1.5rem 1.5rem 1.5rem;
      text-align: center;
      border-bottom-left-radius: 30px;
      border-bottom-right-radius: 30px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
      margin-bottom: 2.5rem;
    }
    h1.title {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 1rem;
      letter-spacing: 0.02em;
      line-height: 1.3;
    }
    .author {
      font-size: 1.2rem;
      font-weight: 400;
      margin-top: 0.5rem;
      color: #e0e0e0;
    }
    main {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.07);
      padding: 2.5rem 2.2rem 2.5rem 2.2rem;
    }
    h1, h2, h3, h4 {
      font-family: inherit;
      font-weight: 700;
      color: #2c3e50;
      margin-top: 2.2rem;
      margin-bottom: 1.2rem;
      line-height: 1.2;
    }
    h1 {
      font-size: 2rem;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 0.3rem;
      margin-bottom: 1.5rem;
    }
    h2 {
      font-size: 1.4rem;
      color: #3a6073;
      border-right: 4px solid #3a6073;
      padding-right: 0.7rem;
      background: #f1f6fa;
      border-radius: 8px;
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    h3 {
      font-size: 1.15rem;
      color: #2c3e50;
      margin-top: 1.5rem;
      margin-bottom: 0.8rem;
    }
    p {
      margin-bottom: 1.2rem;
      text-align: justify;
    }
    ul, ol {
      margin: 1.2rem 2.5rem 1.2rem 0;
      padding-right: 1.5rem;
    }
    li {
      margin-bottom: 0.7rem;
    }
    code, pre {
      font-family: 'Fira Mono', 'Consolas', 'Monaco', monospace;
      background: #f4f4f4;
      color: #c7254e;
      border-radius: 5px;
      padding: 0.2em 0.4em;
      font-size: 0.95em;
    }
    pre {
      display: block;
      padding: 1em;
      overflow-x: auto;
      background: #f4f4f4;
      color: #222;
      border-radius: 8px;
      margin: 1.5em 0;
    }
    blockquote {
      border-right: 5px solid #3a6073;
      background: #f1f6fa;
      color: #444;
      margin: 1.5em 0;
      padding: 1em 1.5em;
      border-radius: 10px;
      font-size: 1.05em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 2em 0;
      background: #fafbfc;
      border-radius: 10px;
      overflow: hidden;
      font-size: 1rem;
    }
    th, td {
      padding: 0.8em 1em;
      border-bottom: 1px solid #e0e0e0;
      text-align: center;
    }
    th {
      background: #eaf1f8;
      color: #2c3e50;
      font-weight: 700;
    }
    tr:last-child td {
      border-bottom: none;
    }
    .math.display {
      display: block;
      margin: 1.5em auto;
      text-align: center;
      direction: ltr;
      unicode-bidi: embed;
    }
    .math.inline {
      font-size: 1em;
      direction: ltr;
      unicode-bidi: embed;
    }
    .nodecor {
      text-decoration: none !important;
      color: inherit;
      font-weight: 500;
    }
    .subtitle {
      color: #536d7a;
      font-size: 1.05rem;
      margin-top: -0.6rem;
      margin-bottom: 1.2rem;
      text-align: center;
    }
    @media (max-width: 700px) {
      main {
        padding: 1.2rem 0.7rem 1.2rem 0.7rem;
      }
      header {
        padding: 1.5rem 0.5rem 1rem 0.5rem;
      }
      h1.title {
        font-size: 1.5rem;
      }
      h1, h2 {
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">تَدَفُّقاتُ التَّطْبِيعِ ذاتُ التَّغْيِيرِ الزَّمَنيّ لِنمذجةِ المُعادَلاتِ التَّفاضُلِيَّةِ العَشْوائِيَّةِ بِدِقَّة</h1>
  <p class="author"><span class="nodecor">Naoufal El Bekri</span>, <span class="nodecor">Lucas Drumetz</span>, <span class="nodecor">Franck Vermet</span></p>
  <p class="subtitle">إطارٌ عامّ لِتَدَفُّقاتِ التَّطْبِيع في الزَّمان يَستندُ إلى تَغْيِيرِ وقتِ حركةِ براون</p>
</header>
<main>
<h1 id="ملخص">مُلَخَّص</h1>
<p>أصبحت النماذجُ التوليديةُ ذاتَ أهميّةٍ مُتزايدةٍ في تعلُّم الآلة ونماذجِ التعلُّمِ العميق. ومن بين هذه النماذج تتألّقُ تَدَفُّقاتُ التَّطْبِيع (Normalizing Flows)، إذ تُتيح تقديرَ الاحتماليةِ الدقيق عبر تحويل توزيعٍ أساسيّ من خلال تحوّلاتٍ تمايُزيّة (دِفّيومورفيّة). وقد أدّى توسيعُ إطارِ عملِ تَدَفُّقاتِ التَّطْبِيع للتعامُل مع التحويلاتِ المُفهرسةِ بالزمن إلى ظهور تَدَفُّقاتِ تطبيعٍ ديناميكيّة تُعَدّ أداةً قويّةً لِنمذجة السلاسلِ الزمنية والعمليّاتِ العشوائية والمعادلات التفاضلية العشوائية العصبية. في هذا العمل نقترح نسخةً جديدةً من هذه التدفّقات، هي تَدَفُّقُ التَّطْبِيعِ ذاتُ التَّغْيِير الزَّمَنيّ (TCNF)، بالاعتمادِ على تَغْيِيرِ وقتِ حركةِ براون، بما يُنتج عائلةً واسعةً ومُتنوّعةً من العمليات الغاوسية. يُمكّننا هذا النهج من نمذجة بعض المعادلات التفاضلية العشوائية التي يتعذّر التقاطُها بطرائق أُخَر، بما في ذلك عملياتٌ كلاسيكيّة مثل عملية أورنشتاين–أولنبيك؛ كما يُعمِّم المنهجيّاتِ السابقة ويُفضي إلى نتائجَ محسّنة وقدرةٍ أفضل على الاستدلال والتنبؤ.</p>

<h1 id="مقدمة">مُقَدِّمَة</h1>
<p>تُستخدَم الأنظمةُ الديناميكية على نطاقٍ واسعٍ في مجالاتٍ علميةٍ متعدّدة مثل المالية وعلوم الأرض والفيزياء. ويشمل تمثيلُ هذه الأنظمة عادةً معادلاتٍ تفاضليةً عاديةً أو معادلاتٍ تفاضليةً عشوائيةً (<span class="nodecor">oksendal2013stochastic</span>) عند أخذ الضوضاء والاضطرابات في الاعتبار، إلى جانب المُكوِّن الحتمي. من التطبيقات الحاسمة نمذجةُ التقلبات في البيانات المالية وتقديرُ الشكوك ونشرُها في علوم الأرض. وقد شهدت معالجةُ هذه الأنظمة، عبر نمذجة السلاسل الزمنية وتعلُّم الآلة، تزايدًا ملحوظًا في الشُّهرة حديثًا بفضل النماذج التوليدية للتنبؤ والتصفية والاستيفاء مع أخذ الشكوك في الحسبان.</p>
<p>تشمل النماذجُ التوليدية الشائعة الشبكاتِ العصبيةَ التوليديةَ التنافسية (<span class="nodecor">conf/nips/GoodfellowPMXWOCB14</span>) والمُشَفِّراتِ التباينيةَ الذاتية (<span class="nodecor">journals/corr/KingmaW13</span>)، وأيضًا مؤخرًا تَدَفُّقاتِ التَّطْبِيع (<span class="nodecor">jmlr/PapamakariosNRM21, journals/pami/KobyzevPB21</span>) والنماذجَ المبنيّة على الانتشار/الدرجة (Score) (<span class="nodecor">conf/nips/SongE19</span>). وعلى الرغم من إمكان تطبيق هذه النماذج لتوليد السلاسل الزمنية، فإنها قد تُعامِل هذه البيانات كمتجهاتٍ في <span class="math inline">\(\mathbb{R}^{T}\)</span>، حيث <span class="math inline">\(T\)</span> عددُ الخطوات الزمنية، دون مراعاة البنية السببيّة. وقد جرى تكييف الشبكاتِ التنافسية والمُشَفِّراتِ التباينية وتَدَفُّقاتِ التطبيع لبيانات السلاسل الزمنية في (<span class="nodecor">conf/nips/YoonJS19, kidger2021neural</span>)، (<span class="nodecor">li2020scalable, zeng2023latent</span>)، (<span class="nodecor">mehrasa2019point, conf/iclr/ShchurBG20</span>) على التوالي. في هذا العمل نُركّز على تَدَفُّقاتِ التطبيع لقدرتها على إتاحة توزيعٍ صريح، وهو أمرٌ حاسم عند الحاجة لتقدير الشكوك أو كشف الشذوذ.</p>
<p>تعتمد تَدَفُّقاتُ التطبيع على صيغةِ تغييرِ المُتغيّر المعروفة، التي تُوفِّر تعبيرًا لكثافة الاحتمال لتحويلاتٍ تمايزيةٍ لمتغيّرٍ عشوائي. وعن طريق اختيار التحويلات بعناية، إذا كانت الكثافةُ الأساسية قابلةً للتعامل (تحمل احتمالًا صريحًا ويسهل أخذُ عيناتٍ منها، وغالبًا ما تكون غاوسية)، أمكن التلاعبُ بالكثافة المُحوّلة وأخذُ العينات منها بسهولةٍ أيضًا، شريطةَ القدرة على حساب مُحدِّدِ يعقوبي التحويل بفعّالية. وفي الحدّ النظري عند تطبيق عددٍ لا نهائيّ من التحويلات، نصل إلى تَدَفُّقِ التطبيع المستمر (<span class="nodecor">DBLP:conf/iclr/GrathwohlCBSD19</span>). في هذه الحالة، يُوصَفُ التدفق بمعادلةٍ تفاضليةٍ عادية يمكن دمجُها للحصول على الكثافة الناتجة، مما يزيد من كفاءة الحساب عبر استبدال مُحدِّد اليعقوبي بتكامل أثره.</p>
<p>تَمّ توسيعُ تَدَفُّقاتِ التطبيع إلى الإعداد الديناميكي عن طريق استبدال التوزيعِ الأساسي القابل للتعامل بعمليةٍ احتماليةٍ قابلةٍ للتعامل، أي حركة براونية (<span class="nodecor">deng2020modeling</span>)، مما يجعل هذا النوع من النماذج أكثر كفاءةً لتوليد السلاسل الزمنية. غير أنّ (<span class="nodecor">deng2021continuous</span>) أظهروا أنّ هذه النماذج لا تستطيع نظريًا تمثيل بعض العمليات الأساسية والشائعة، مثل عملية أورنشتاين–أولنبيك الكلاسيكية.</p>
<p>وعليه، نقترح في هذه الورقة تعميمًا لهذا النهج باستخدام عائلةٍ واسعةٍ من العمليات الغاوسية كعمليةٍ أساسية بدلًا من الحركة البراونية القياسية. وتُنشَأ هذه العمليات الغاوسية من خلال تَغْيِيرِ وقتِ حركةِ براون، بما يُفضي إلى تَدَفُّقِ التطبيع ذاتِ التَّغْيِير الزَّمَنيّ، وهو نموذجٌ يمتلك خصائصَ رياضيةً تُتيح له وصفَ ديناميكيات ومعادلاتٍ تفاضليةٍ عشوائيةٍ لا تستطيع النماذجُ السابقة التقاطَها، مع الحفاظ على التعبيرية العالية لتَدَفُّقاتِ التطبيع الديناميكية. ونؤكّد هذه النتائج من خلال تجاربَ عديدةٍ على عدّةِ عملياتٍ معروفة.</p>
<p>تُنظَّم بقيّةُ الورقة على النحو الآتي: نُقدِّم أوّلًا، في قسم «الخَلْفِيَّة»، لمحةً عن المعادلات التفاضلية العشوائية العصبية — حيث يُمثَّل كلٌّ من الانجراف والانتشار بشبكاتٍ عصبية — ونستعرض منهج «عملية التدفق الزمني المستمر» CTFP وحدودَه. بعد ذلك، في القسم «tcnf»، نعرض نموذجَنا ونصف خصائصَه وخوارزميةَ تدريبه. ثم نُقدِّم النتائجَ الكمية في قسم «التَّجارِب» مع مقارنتها بنماذج أخرى مبنيّة على التدفق، ونختتم بالملاحظات الختامية في قسم «الخُلاصَة».</p>

<h1 id="الخَلْفِيَّةِ">الخَلْفِيَّة</h1>
<h2 id="الأعمال-ذات-الصلة">الأَعْمالُ ذاتُ الصِّلَة</h2>
<h2 id="معادلات-التفاضل-العشوائية-العصبية">مُعادَلاتُ التَّفاضُلِ العَشْوائِيَّةُ العَصَبيّة</h2>
<p>نعتبر فضاءً احتماليًا مُفلترًا <span class="math inline">\((\Omega, \mathcal{F}, P)\)</span> وأفقًا زمنيًّا <span class="math inline">\(T\)</span>. تُعرَّف عمليةُ الانتشار <span class="math inline">\(X = \{X_t\}_{t\in [0, T]}\)</span> بواسطة معادلةِ إيتو للتفاضل العشوائي (SDE): <span class="math display">\[
\begin{aligned}
\label{eq:EDS_X}
    dX_t = \mu(X_t, t)\,dt + \sigma(X_t,t)\,dW_t,\quad t\in [0, T]
\end{aligned}
\]</span> حيث <span class="math inline">\(W = \{W_t\}_{t\in [0, T]}\)</span> عمليةُ وينر القياسية ذات البُعد <span class="math inline">\(m\)</span>، و<span class="math inline">\(\mu:\mathbb{R} ^d \times [0,T] \to \mathbb{R} ^d\)</span> و<span class="math inline">\(\sigma:\mathbb{R} ^d \times [0,T] \to \mathbb{R} ^{d\times m}\)</span> هما معاملا الانجراف والانتشار على التوالي. وعندما تُنفَّذ هاتان الدالتان بواسطة شبكاتٍ عصبية، يُسمّى ذلك SDE عصبيًا (<span class="nodecor">tzen2019neural</span>, <span class="nodecor">liu2019neural</span>).</p>
<p>اقتَرحَت عدّةُ دراساتٍ تعلُّمَ SDEs عصبية باستخدام أطرٍ توليدية مختلفة، مثل المُشَفِّراتِ التباينية (<span class="nodecor">li2020scalable</span>, <span class="nodecor">zeng2023latent</span>) والشبكاتِ التوليدية التنافسية (<span class="nodecor">kidger2021neural</span>). في هذه الورقة نُركّز تحديدًا على نموذج تَدَفُّقِ التطبيع.</p>

<h2 id="تدفقات-التطبيع">تَدَفُّقاتُ التَّطْبِيع</h2>
<p>تَدَفُّقُ التطبيع (<span class="nodecor">jmlr/PapamakariosNRM21</span>, <span class="nodecor">journals/pami/KobyzevPB21</span>, <span class="nodecor">DBLP:conf/iclr/GrathwohlCBSD19</span>) هو تحويلٌ مُصمَّمٌ لنمذجة متغيّرٍ عشوائي <span class="math inline">\(X\)</span> وتوزيعِه المعقّد <span class="math inline">\(p_X\)</span> انطلاقًا من توزيعٍ أساسي <span class="math inline">\(p_Z\)</span> ودالةٍ ثنائيةِ الاتجاه قابلةٍ للتفاضل <span class="math inline">\(f:\mathbb{R} ^d  \to \mathbb{R} ^d\)</span>. وتُتيح هذه النمذجة تقديرَ الكثافةِ الدقيق والأخذَ العيّني الفعّال، باستخدام صيغة تغيير المُتغيّر لـ <span class="math inline">\(X=f(Z)\)</span>:</p>
<p><span class="math display">\[
\log p_X(x) = \log p_Z(z) - \log \left|\det J_{f}(z)\right|
\]</span></p>
<p>حيث يعبِّر يعقوبي <span class="math inline">\(J_f(z) = \left[\frac{\partial f_i}{\partial z_j} \right]_{1\leq i,j \leq d}\)</span> عن المشتقات الجزئية لـ <span class="math inline">\(f\)</span>.</p>
<p>وقد وَسّعت أعمالٌ سابقةٌ هذا الإطار بنمذجة السلاسل الزمنية والعمليات العشوائية عبر تَبايُنٍ مستمرٍّ مُفهرسٍ بالزمن <span class="math inline">\(F(\cdot, t)\)</span> مع حركةِ براون كعمليةٍ أساسية، بما يُنتج «عمليةَ التدفق الزمني المستمر» (<span class="nodecor">deng2020modeling</span>): <span class="math display">\[
\begin{aligned}
    X_t = F(W_t, t).
\end{aligned}
\]</span></p>
<p>وتقترح طريقةٌ أُخرى (<span class="nodecor">deng2021continuous</span>) دمجَ ديناميكيات عملية أورنشتاين–أولنبيك مع تَدَفُّقِ التطبيع بغيةَ نمذجة المعادلات التفاضلية العشوائية بفعالية.</p>
<p>وقد أثبتت هذه النماذجُ جدواها في التقاط السلوك المعقّد لأنواعٍ مختلفةٍ من العمليات العشوائية والمعادلات التفاضلية العشوائية. غير أنّ قيودًا مهمّةً تنشأ عند تطبيق قاعدة إيتو على عملية التدفق الزمني المستمر لاشتقاق عملية أورنشتاين–أولنبيك الأُحاديّة البُعد المُوصوفة بـ:</p>
<p><span class="math display">\[
\begin{aligned}
\label{eq:ou}
    dY_t = -a(Y_t - b)\,dt + \sigma \,dW_t
\end{aligned}
\]</span></p>
<p>فعند تطبيق قاعدة إيتو على <span class="math inline">\(F(W_t,t)\)</span> نحصل على: <span class="math display">\[
\begin{aligned}
\label{eq:NF-OU}
\begin{split}
 dF(W_t,t) = & \ \frac{\partial F}{\partial t}(W_t,t)\,dt + \frac{\partial F}{\partial x}(W_t,t)\,dW_t  \\
 & \ + \frac{1}{2}\frac{\partial^2 F}{\partial x^2}(W_t,t)\,dt.
\end{split}
\end{aligned}
\]</span></p>
<p>وبالمقارنة بين المعادلتين نستنتج أنّه لِنمذجة عملية أورنشتاين–أولنبيك يجب أن تتحقّق <span class="math inline">\(\frac{\partial F}{\partial x}(W_t,t) = \sigma\)</span>، بما يعني <span class="math inline">\(F(W_t, t) = \sigma W_t + g(t)\)</span> حيث <span class="math inline">\(g\)</span> دالة قابلة للتفاضل. لكن تفاضُل هذه العلاقة يُفضي إلى الشرط التالي: <span class="math display">\[
\begin{aligned}
\label{OUabsurde}
    \frac{dg}{dt}(t) + a\, g(t) - a\, b = -a\,\sigma\, W_t,
\end{aligned}
\]</span> وهي معادلةٌ غيرُ قابلةٍ للحلّ لأن الطرف الأيسر حتميٌّ بينما يعتمد الطرف الأيمن عشوائيًّا على <span class="math inline">\(W_t\)</span>. وبناءً عليه تظهر حدودٌ واضحةٌ لقدرة «عملية التدفق الزمني المستمر» على نمذجة بعض العمليات العشوائية بفعاليّة.</p>
<p>في القسم التالي نقترح نموذجًا يُعالج هذا القيد ويُحسِّن النتائج.</p>

<h1 id="tcnf">تَدَفُّقُ التَّطْبِيعِ الدِّينامِيكِيّ مَعَ تَغْيِيرِ الزَّمَن</h1>
<h2 id="تدفق-التطبيع-المتغير-بالزمن">تَدَفُّقُ التَّطْبِيعِ ذاتُ التَّغْيِيرِ الزَّمَنيّ</h2>
<p>نقترح نمذجةَ عمليةٍ عشوائيةٍ مُراقَبة <span class="math inline">\(X = \{X_t\}_{t\in [0, T]}\)</span> عبر دمجِ تَدَفُّقِ تطبيعٍ مع حركةِ وينر مُغَيَّرةِ الوقت لالتقاط السلوكِ الديناميكي لـ <span class="math inline">\(X_t\)</span> انطلاقًا من سلسلةٍ زمنيةٍ مُحقَّقة <span class="math inline">\(\{(x_{t_i},t_i)\}_{i=1}^n\)</span>. نركّز في هذه الورقة على الحالة الأحادية البُعد، أمّا الحالةُ العامة فتتطلب تعميمًا زمنيًّا مناسبًا لكلّ بُعد. نُعرِّف «تدفّقَ التطبيع ذي التَّغْيِير الزَّمَنيّ» (TCNF) كما يأتي:</p>
<p><span class="math display">\[
\begin{aligned}
    X_t = f_\theta \bigl(W_{\phi(t)},\ \phi(t)\bigr), \quad \forall\, t \in [0,T],
\end{aligned}
\]</span></p>
<p>حيث <span class="math inline">\(f_\theta(\cdot,t):\mathbb{R}\to \mathbb{R}\)</span> تبايُنٌ قابلٌ للتفاضل بمعلمات <span class="math inline">\(\theta\)</span>، و<span class="math inline">\(W_{\phi(t)}\)</span> حركةُ براون مع تَغْيِيرِ وقتٍ (<span class="nodecor">revuz2013continuous</span>). ودالةُ تَغْيِيرِ الوقت <span class="math inline">\(\phi : \mathbb{R} ^{+} \to \mathbb{R} ^{+}\)</span> قابلةٌ للقياس وموجبةٌ ومُتزايدة. وتضمن خاصيتا القياس والإيجابية التعريفَ الصحيحَ لـ <span class="math inline">\(W_{\phi(t)}\)</span>، بينما يضمن التزايدُ الملاءمةَ المارتينجاليّة والخواصَّ الأساسية للتغاير التربيعي. وعليه ينبغي أن تُنتِج الشبكةُ العصبيةُ المُمهِّدة لـ <span class="math inline">\(\phi\)</span> دالةً موجبةً ومُتزايدة بطبيعتها. إنّ تَغْيِيرَ الوقت يُنتِج عائلةً عامةً من العمليات الغاوسية أوسعَ من الحركة البراونية القياسية. كما تؤكِّد مبرهنةُ دامبس–دوبينس–شوارتس (<span class="nodecor">revuz2013continuous</span>) أنّ كلَّ مارتينجالٍ محليٍّ يمكن تمثيلُه كحركةِ براون مُغَيَّرةِ الوقت.</p>
<p>لذا، عبر جعل العمليةِ الأساسية حركةَ براون مُغَيَّرةِ الوقت يمكننا التقاطُ فئاتٍ واسعةٍ من المارتينجالاتِ المحلية وشبهِ المارتينجالات، ومن ثَمَّ تعميمُ إعداد CTFP. في الواقع، يُعطى حلُّ عمليةِ أورنشتاين–أولنبيك بالصّيغة:</p>
<p><span class="math display">\[
\begin{aligned}
    Y_t = Y_0 e^{-a t} + b\,(1 - e^{-a t}) \;+\; \frac{\sigma e^{-a t}}{\sqrt{2a}}\, W_{\,e^{2a t}-1},
\end{aligned}
\]</span></p>
<p>وهو تمثيلٌ يمكن نمذجتُه بكفاءة بواسطة TCNF. كما أنّ صورًا أعمَّ لعملياتٍ ذات تباينٍ تربيعيٍّ معتمدٍ على الزمن أو تقلباتٍ زمنيةٍ يمكن التعبيرُ عنها كتَغْيِيرِ وقتٍ قابلةٌ للتمثيل ضمن TCNF. وأخيرًا، عند اختيار <span class="math inline">\(\phi(t) = t\)</span> نستعيدُ إعدادَ CTFP التقليدي الملائمَ للعمليات التي لا تتطلّب تَغْيِيرًا زمنيًا، مثل الحركةِ البراونية الهندسية (<span class="nodecor">oksendal2013stochastic</span>).</p>

<h2 id="دالة-تغيير-الوقت">دالَّةُ تَغْيِيرِ الوقت</h2>
<p>لضمان خصائصِ دالّةِ تَغْيِيرِ الوقت (الإيجابية والرتابية)، نستخدم شبكةً عصبيةً أحاديةَ البُعد مُصمَّمةً لِتكون مُرتفعةَ الاشتقاق ومُوجِبةَ الاشتقاق. تحديدًا نعتمد بُنية (<span class="nodecor">M-MGN</span>) (<span class="nodecor">chaudhari2023learning</span>) المبنيّة على وحداتٍ مُعرَّفةٍ بالصيغ:</p>
<p><span class="math display">\[
\begin{aligned}
\begin{split}
    \widetilde{t}_k &= W_k\, t + b_k, \\
    \mathrm{M\mbox{-}MGN}(t) &= a + V^\top V\,t + \sum_{k=1}^K s_k(\widetilde{t}_k)\, W_k^\top \sigma_k(\widetilde{t}_k),
\end{split}
\end{aligned}
\]</span></p>
<p>حيث <span class="math inline">\(W_k, b_k \in \mathbb{R}^{l \times 1}\)</span> متجهاتُ الوزن والانحياز للطبقة <span class="math inline">\(k\)</span>، و<span class="math inline">\(\sigma_k:\mathbb{R}^l \to \mathbb{R}^l\)</span> دالةُ تنشيط، و<span class="math inline">\(s_k :\mathbb{R}^l \to \mathbb{R}\)</span> دالةٌ بدائيّةٌ لـ <span class="math inline">\(\sigma_k\)</span> بحيث <span class="math inline">\(s_k'=\sigma_k\)</span>. و<span class="math inline">\(a \in \mathbb{R}\)</span>، و<span class="math inline">\(V \in \mathbb{R}^{l \times 1}\)</span> معامِلان إضافيّان. ولأن خرج (<span class="nodecor">M-MGN</span>) قد لا يكون موجبًا بطبيعته، نُضيف إزاحةً موجبةً صغيرة لضمان إيجابيّةِ تَغْيِيرِ الوقت.</p>

<h2 id="خوارزميه-التدريب">خوارزميّةُ التَّدريب</h2>
<p>هدفُنا تدريبُ الشبكةِ الزمنيةِ المشروطة لتعظيم لوغاريتمِ الاحتمالية لمجموعةِ البيانات المرصودة <span class="math inline">\(\{(x_{t_i},t_i)\}_{i=1}^n\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\label{eq:LL}
    L = \log p_{X_{t_1}, \dots, X_{t_n}}(x_{t_1}, \dots, x_{t_n}).
\end{aligned}
\]</span></p>
<p>ولحسابِ ذلك نستخدمُ صيغةَ تغييرِ المُتغيّر ونستفيد من استقلاليةِ الزيادات <span class="math inline">\(W_{\phi(t_i)} - W_{\phi(t_{i-1})}\)</span>. وبناءً عليه تُكتَبُ الاحتماليةُ اللوغاريتمية كما يلي:</p>
<p><span class="math display">\[
\begin{aligned}
\begin{split}
    L = \sum_{i=1}^n \Big[ & \log p_{W_{\phi(t_i)}\mid W_{\phi(t_{i-1})}}\bigl(w_{\phi(t_i)}\bigr) \\
    &- \log \Bigl|\det \frac{\partial f_\theta \bigl(w_{\phi(t_i)},\ \phi(t_i)\bigr)}{\partial W_{\phi(t_i)}} \Bigr| \,\Big],
\end{split}
\end{aligned}
\]</span></p>
<p>حيث <span class="math inline">\(w_{\phi(t_i)} = f_\theta^{-1}\bigl(x_{t_i}; \phi(t_i)\bigr)\)</span> و<span class="math inline">\(p_{W_{\phi(t_i)}\mid W_{\phi(t_{i-1})}}\)</span> توزيعٌ Gaussّي شرطيّ بمتوسط <span class="math inline">\(W_{\phi(t_{i-1})}\)</span> وتباين <span class="math inline">\(\phi(t_i)- \phi(t_{i-1})\)</span>. وهذا يُشكِّل فارقًا جوهريًّا مقارنةً باحتماليةِ التوزيع الزمني المشروط التي تستخدم التباين <span class="math inline">\(t_i - t_{i-1}\)</span> بدلًا من <span class="math inline">\(\phi(t_i)- \phi(t_{i-1})\)</span>.</p>

<h1 id="quantResults">التَّجارِب</h1>
<h2 id="مجموعات-البيانات-التجريبية">مَجْمُوعاتُ البَياناتِ التَّجريبيّة</h2>
<p>لتقييم أداءِ النموذج المقترح، أجرينا تجاربَ على ثلاث مجموعاتِ بياناتٍ اصطناعيةٍ أحاديةِ البُعد. وجرى توليدُ تلك المجموعات بأخذ عيناتٍ من ثلاث عملياتٍ عشوائيةٍ مختلفة، واستخدمنا في تجاربنا بُنيةً مشابهةً لبنية نموذج <span class="nodecor">CTFP</span> المعتمِد على <span class="nodecor">CNFs</span>.</p>
<p>المجموعة الأولى (<strong>Toy-SDE1</strong>) مُنشأةٌ من عمليةِ <span class="nodecor">OU</span> المعطاة بـ <span class="math inline">\(dX_t = -\theta(X_t - \mu)\,dt + \sigma\, dW_t\)</span>، حيث <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> معامِلا الانجراف والتقلّب الثابتان، و<span class="math inline">\(\theta\)</span> يُحدِّد سرعةَ تقارب المسار نحو حدِّ الانجراف. وتهدف هذه المجموعة إلى اختبار قدرة النموذج على التقاط ديناميكياتٍ ثابتةِ المعاملات عبر الزمن.</p>
<p>المجموعة الثانية (<strong>Toy-SDE2</strong>) مُعرّفةٌ بالمعادلة <span class="math inline">\(dX_t = -\theta(X_t - \mu)\,dt + \sigma \sqrt{t}\,dW_t\)</span>، وهي عمليةُ <span class="nodecor">OU</span> بمعاملِ انتشارٍ معتمدٍ على الزمن، لاختبار قدرة النموذج على التقاط تغيّراتٍ زمنيةٍ معقّدة. يُستخدَم هذا النمط من <span class="nodecor">SDE</span> في نماذج النقاط الأساسية (<span class="nodecor">yang2022diffusion</span>) حيث تُقاد الضوضاء تدريجيًّا أثناء التدريب.</p>
<p>المجموعة الثالثة (<strong>Toy-SDE3</strong>) تخصّ الحركةَ البراونية الهندسية المعطاة بـ <span class="math inline">\(dX_t = \mu X_t\, dt + \sigma X_t\, dW_t\)</span>، حيث <span class="math inline">\(\mu\)</span> و<span class="math inline">\(\sigma\)</span> معامِلان ثابتان للانجراف والتقلّب. وصُمِّمت هذه المجموعة لإظهار قدرة <span class="nodecor">TCNF</span> على التعامل مع <span class="nodecor">SDEs</span> التي لا تحتاج تَغْيِيرًا زمنيًا، وتعلُّم الدالة البسيطة <span class="math inline">\(\phi(t) = t\)</span> بفعالية، مُبرزةً شمولية إطار CTFP.</p>
<p>قارنّا النماذجَ بمقاييسِ المتوسط <span class="math inline">\(m_{X_t}\)</span> والانحراف المعياري <span class="math inline">\(\sigma_{X_t}\)</span> والمُدى بين الرُّبعين <span class="nodecor">IQR</span> (<span class="math inline">\(Q_{3}-Q_{1}\)</span>) والكثافة <span class="math inline">\(p_{X_t}\)</span>. ولكلّ نموذجٍ حسبنا خطأ المتوسط المطلق (<span class="nodecor">MAE</span>) مقارنةً بالحقائق الأساسية. وقد جرى تقديرُ المتوسط والانحراف والرباعيات بالاستناد إلى <span class="nodecor">1000</span> مسارِ عيّنة عبر <span class="nodecor">1000</span> تكرار، فيما استُخدمت شبكةٌ مكانية من <span class="nodecor">1000</span> نقطة و<span class="nodecor">500</span> نقطةٍ زمنية ضمن الفترة <span class="math inline">\([0, T = 1.5]\)</span> لتقدير الكثافة. تُظهر النتائجُ المبلّغُ عنها في الجدول [tab:quant_error_toy12] أنّ <span class="nodecor">TCNF</span> لا يفقد العمومية في حالات عدم الحاجة لتَغْيِير الوقت، وأنّ نموذجَنا يتفوّق في التقاط السلوك المُتغيّر زمنيًّا.</p>

<h2 id="مجموعات-البيانات-الواقعية">مَجْمُوعاتُ البَياناتِ الواقِعيّة</h2>
<p>لتقييم قدرة نموذجِنا على التقاط ديناميكياتٍ أكثر تعقيدًا، درّبناه على مجموعتي بياناتٍ حقيقيّتين: تنبؤات العملات المشفّرة (<strong>Crypto</strong>) (<span class="nodecor">g-research-crypto-forecasting</span>) واستهلاك الطاقة الكهربائية (<strong>ECL</strong>) (<span class="nodecor">zhou2021informer</span>). تحتوي مجموعة Crypto على أسعارٍ تاريخيةٍ لعدّة عملاتٍ مُشفّرة، وركّزنا على العوائد اللُّغاريتمية لإيثريوم خلال عام <span class="nodecor">2020</span>. أمّا مجموعة ECL فتشمل بياناتِ استهلاكِ الكهرباء لعدّة عملاء بفاصل <span class="nodecor">15</span> دقيقة، وقد نمذجنا استهلاكَ العميل «200» على امتداد فترته الزمنية.</p>
<p>تتضمّن النتائجُ أخطاءَ المتوسط المطلق (MAE) لتقدير المتوسط (<span class="math inline">\(m_{X_t}\)</span>) والانحراف المعياري (<span class="math inline">\(\sigma_{X_t}\)</span>) لمجموعة Crypto. كما استخدمنا الأخطاءَ النسبيةَ المتوسّطة (MRE) لمجموعة ECL لملاءمة اختلاف المقاييس. وأُبلِغ عن هذه النتائج في الجدول [tab:real-world] مع مقارنتها بـ CTFP.</p>

<h1 id="conclusion">الخُلاصَة</h1>
<p>قدّمنا نهجًا مُعمَّمًا لنمذجة المعادلات التفاضلية العشوائية عبر شبكاتٍ عصبيةٍ ديناميكية مقرونةٍ بتَغْيِيرِ الوقت. فمن خلال تَغْيِيرِ وقتِ حركةِ وينر نولِّد عملياتٍ غاوسيةً متنوّعة تُطابق العمليةَ المرصودة عند تَطبيق تَدَفُّقاتِ التطبيع. ويُتيح تَغْيِيرُ الوقت، مقترنًا بالشبكة الديناميكية، نمذجةَ عملياتٍ يتعذّر التقاطُها تقليديًّا، مع الحفاظ على مزايا تَدَفُّقاتِ التطبيع في تقدير الكثافة الدقيق والأخذ العيّني الفعّال.</p>
<p>وأظهرت التجاربُ تفوّق نموذجِنا وقدرتَه على التعميم. ونعتقد أنّ ربطَ تَغْيِيرِ الوقت بلحظات العملية أو بتباينها التربيعي قد يُفضي إلى تحسيناتٍ إضافية، ويفتح البابَ لِتوسيع الطريقة إلى أبعادٍ أعلى.</p>
</main>
</body>
</html>