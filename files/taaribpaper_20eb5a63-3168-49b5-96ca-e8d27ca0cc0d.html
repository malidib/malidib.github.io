<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Liwen Zhu Peking University liwenzhu@pku.edu.cn Peixi Peng Peking University pxpeng@pku.edu.cn Zongqing Lu Peking University zongqing.lu@pku.edu.cn Yonghong Tian Peking University yhtian@pku.edu.cn">
  <title>MTLight: التعلُّم المُتعدِّد المهام الفعّال للتحكُّم في إشارات المرور باستخدام التعلُّم المُعزَّز</title>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
    body {
      direction: rtl;
      font-family: 'Cairo', 'Segoe UI', Tahoma, Geneva, Verdana, Arial, sans-serif;
      font-size: 20px;
      background: #f8f9fa;
      color: #222;
      margin: 0;
      padding: 0;
      line-height: 1.8;
    }
    header {
      background: linear-gradient(90deg, #3a8dde 0%, #6dd5ed 100%);
      color: #fff;
      padding: 40px 0 20px 0;
      text-align: center;
      box-shadow: 0 2px 8px rgba(58,141,222,0.08);
      margin-bottom: 30px;
    }
    h1.title {
      font-size: 2.5em;
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }
    .author {
      font-size: 1.1em;
      margin-top: 10px;
      color: #e3f2fd;
      line-height: 1.5;
    }
    main {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(58,141,222,0.10);
      padding: 40px 40px 30px 40px;
    }
    h1, h2, h3, h4 {
      color: #3a8dde;
      font-weight: 700;
      margin-top: 2.2em;
      margin-bottom: 0.7em;
      line-height: 1.3;
    }
    h1 {
      font-size: 2em;
      border-bottom: 2px solid #e3f2fd;
      padding-bottom: 0.2em;
    }
    h2 {
      font-size: 1.4em;
      border-bottom: 1px solid #e3f2fd;
      padding-bottom: 0.1em;
    }
    h3 {
      font-size: 1.15em;
      color: #1976d2;
    }
    p {
      margin: 1.2em 0;
      text-align: justify;
    }
    ul, ol {
      margin: 1.2em 2em 1.2em 0;
      padding-right: 1.5em;
    }
    li {
      margin-bottom: 0.7em;
    }
    strong {
      color: #1976d2;
    }
    code, pre {
      background: #f1f3f4;
      color: #c7254e;
      border-radius: 4px;
      padding: 2px 6px;
      font-size: 0.95em;
      font-family: 'Cairo', 'Consolas', 'monospace';
    }
    pre {
      display: block;
      padding: 12px;
      overflow-x: auto;
      margin: 1.2em 0;
      background: #f1f3f4;
      color: #222;
      border-radius: 6px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 2em 0;
      background: #f9fbfd;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(58,141,222,0.05);
    }
    th, td {
      padding: 12px 10px;
      text-align: center;
      border-bottom: 1px solid #e3f2fd;
    }
    th {
      background: #e3f2fd;
      color: #1976d2;
      font-weight: 700;
    }
    tr:last-child td {
      border-bottom: none;
    }
    tr.odd {
      background: #f6fafd;
    }
    tr.even {
      background: #fff;
    }
    caption {
      caption-side: top;
      text-align: right;
      color: #1976d2;
      font-weight: 700;
      padding: 6px 0 12px 0;
    }
    .math.inline {
      font-family: 'Cairo', 'Consolas', 'monospace';
      background: #f1f3f4;
      padding: 1px 4px;
      border-radius: 3px;
      color: #1976d2;
    }
    .math.display {
      display: block;
      margin: 1.2em 0;
      direction: ltr;
      text-align: left;
      background: #f1f3f4;
      padding: 10px 16px;
      border-radius: 6px;
      font-size: 1.05em;
      color: #1976d2;
    }
    .nodecor {
      text-decoration: none;
      color: inherit;
    }
    @media (max-width: 700px) {
      main {
        padding: 18px 8px 18px 8px;
      }
      h1.title {
        font-size: 1.3em;
      }
      h1, h2 {
        font-size: 1.1em;
      }
      table, th, td {
        font-size: 0.95em;
      }
    }
    blockquote {
      border-right: 4px solid #3a8dde;
      background: #f1f8fe;
      color: #1976d2;
      margin: 1.5em 0;
      padding: 1em 1.5em;
      border-radius: 8px;
      font-size: 1em;
    }
  </style>
</head>
<body>
<header>
  <h1 class="title">MTLight: التعلُّم المُتعدِّد المهام الفعّال للتحكُّم في إشارات المرور باستخدام التعلُّم المُعزَّز</h1>
  <p class="author">
    <span class="nodecor">Liwen Zhu</span><br />
    <span class="nodecor">Peking University</span><br />
    <span class="nodecor">liwenzhu@pku.edu.cn</span><br />
    <span class="nodecor">Peixi Peng</span><br />
    <span class="nodecor">Peking University</span><br />
    <span class="nodecor">pxpeng@pku.edu.cn</span><br />
    <span class="nodecor">Zongqing Lu</span><br />
    <span class="nodecor">Peking University</span><br />
    <span class="nodecor">zongqing.lu@pku.edu.cn</span><br />
    <span class="nodecor">Yonghong Tian</span><br />
    <span class="nodecor">Peking University</span><br />
    <span class="nodecor">yhtian@pku.edu.cn</span>
  </p>
</header>
<main>
<h1 id="ملخص">مُلخَّص</h1>
<p>يُؤثِّر التحكُّم في إشارات المرور تأثيرًا كبيرًا في تخفيف الازدحام المروري بالمدن الحديثة. استُخدمت تقنيات التعلُّم المُعزَّز على نطاق واسع في هذه المهمّة مؤخرًا وأظهرت أداءً واعدًا، لكنها واجهت تحدّيات مثل محدوديّة الأداء وضعف كفاءة العيِّنات. لمواجهة ذلك، نقترح MTLight الذي يُعزِّز مُشاهدات الوكيل بتمثيل حالةٍ كامنة مُتعلَّمة من مؤشِّرات متعدِّدة لحركة المرور. وفي الوقت نفسه، نبني مهامًا مساعِدة مُشرفّة لتعلُّم هذه الحالة الكامنة، ونستخرج نوعين من الميزات الكامنة: ميزة مُشتركة بين المهام وميزة مُخصَّصة للمهمّة، لجعل التمثيل الكامن أغنى. تُظهر تجارب موسَّعة على CityFlow أنّ MTLight يحقق سرعة تقارب رائدة وأداءً تقاربيًا مُتفوقًا. كما نحاكي ظروف ساعة الذروة في جميع السيناريوهات مع زيادة صعوبة التحكُّم، وتُشير النتائج إلى قدرة MTLight العالية على التكيُّف.</p>

<h1 id="sec:introduction">مقدمة</h1>
<p>يهدف التحكُّم في إشارات المرور إلى تنسيق الأطوار الإشارية عبر التقاطعات لتحسين كفاءة الحركة ضمن منطقة أو مدينة، وهو ما يلعب دورًا مهمًّا في النقل الفعّال. تعتمد معظم المناهج التقليدية على توقيت ثابت (<span class="nodecor">koonce2008traffic</span>) أو على قواعد استدلال مُصمَّمة يدويًّا (<span class="nodecor">kouvelas2014maximum</span>)، ما يستلزم خبرة بشرية وتحليلًا عميقًا لبيانات تاريخية محليّة ويُقوِّض قابلية النقل. في المقابل، تُدرِّب الطرق المبنية على التعلُّم المُعزَّز العميق (<span class="nodecor">DRL</span>) (<span class="nodecor">guo2021urban,jintao2020learning,pan2020spatio,he2020spatio,tong2021combinatorial,wang2020deep,gu2020exploiting,liu2021urban,xu2021hierarchically,zhang2021periodic</span>) شبكاتٍ عصبية تتحكّم بالتقاطعات عبر التفاعل المباشر مع البيئة. غير أنّ وفرة مؤشِّرات المرور (عدد المركبات، طول الطابور، وقت الانتظار، السرعة، …) وتعقيد المشاهدة وديناميكية البيئة تجعل المسألة ما تزال صعبة.</p>
<p>نظرًا لارتباط ملاحظات كل إشارة ومكافآتها وديناميكياتها بعضها ببعض، فإن تحسين التحكُّم في إشارات المرور على شبكة واسعة يُصاغ طبيعيًّا على هيئة تعلُّم مُعزَّز مُتعدِّد الوكلاء (<span class="nodecor">MARL</span>). معظم الأعمال السابقة (<span class="nodecor">wei2019presslight,zhang2020generalight,chen2020toward,zheng2019learning</span>) تعلَّمت سياساتٍ مُشروطة على الملاحظة المحليّة الخام للتقاطع فقط، متجاهلةً معلومات الحالة العالمية التي تتاح في المدن الذكيّة. وقد أُشير في (<span class="nodecor">zheng2019diagnosing</span>) إلى أنّ المقاييس المختلفة تؤثّر بقوة في مهمّة التحكُّم. لذلك ينبغي أن تشمل ملاحظة الوكيل، إضافةً إلى بيانات التقاطع المحليّة، معلوماتٍ عن الحالة العالمية. إن تصميم ملاحظةٍ جيّدة يُحسِّن الاستفادة من العيّنات ويرفع أداء السياسة وكفاءتها. لكن كثرة مؤشِّرات الحالة العالمية تجعل تصميم ملاحظةٍ مناسبةٍ وغير مُكرَّرة أمرًا عسيرًا: فالتلخيص المُفرِط قد لا يُمثِّل خصائص الحالة بدقّة كافية، بينما تُسبب الملاحظة الغنية غير المُنظَّمة تضخُّم الأبعاد وتكرار البيانات وصعوبة التعلُّم.</p>
<p>لذلك نقدِّم تمثيلًا كامنًا للحالة يدعم مهمّة التحكُّم. تبدأ الملاحظة الخام المحلية بعدّة متغيّرات ذات دلالة (كعدد المركبات على كل مسار وارد والطور الإشاري الحالي)، ثم نُعزِّزها بفضاءٍ كامنٍ مُتعلَّم من الحالة العالمية عبر مهام مساعِدة مُشرفّة ذات صلة بالتحكُّم. نُغذِّي شبكةً عصبية مُتكرِّرة (<span class="nodecor">RNN</span>)، من نوع <span class="nodecor">GRU</span>، بتسلسلات إحصائيّة مُستخرَجة من سجلات الحالة العالمية، ثم نتفرّع إلى رؤوس تنبؤ عدّة لتقدير توزيعات مثل تدفُّق المرور ومتوسّط زمن السفر. ولإغناء الفضاء الكامن نستخلص ميزتين كامنتين: ميزة مُشتركة بين المهام وأخرى مُخصَّصة للمهمّة. الأولى تعبّر عن خصائص عامة أساسية، والثانية عن معلومات مُوجَّهة بالمهمّة. وبذلك تتكاملان معًا لتعزيز الملاحظة الخام. وأخيرًا، وبالاشتراط على الملاحظة المُعزَّزة، نتعلّم السياسة بواسطة <span class="nodecor">DRL</span> (<span class="nodecor">mnih2015human</span>). تُدرَّب المهام المتعدّدة والسياسة تزامنيًّا، ما يجعل الفضاء الكامن أكثر تكيُّفًا مع تعلُّم السياسة.</p>

<h1 id="تنظيم-الورقة">تنظيم الورقة</h1>
<p>نعرِّف إعداد المشكلة المُتعدِّد الوكلاء ثم تصميم الوكيل. بعد ذلك نعرض منهج MTLight وتفاصيل التعلُّم المُتعدِّد المهام للحالة الكامنة وسياسة التعلُّم. ثم نبيّن النتائج التجريبية، وأخيرًا نختتم بالاستنتاجات واتجاهات العمل المستقبلي.</p>

<h1 id="sec:problem_statement">بيان المشكلة</h1>
<h2 id="sec:problem_definition">تعريف المشكلة</h2>
<p>ننظر في التحكُّم بإشارات المرور عبر وكلاء متعدّدين، حيث نُنمذج المهمّة كلُعبة ماركوفيّة (<span class="nodecor">Littman1994markov</span>) تُعرَّف بالصيغة <span class="math inline">\(\mathcal{G}=\langle\mathcal{N},\mathcal{S}, \mathcal{A}, \mathcal{O}, \mathcal{P}, \mathcal{R}, \mathcal{H}, \gamma\rangle\)</span>. تمثّل <span class="math inline">\(\mathcal{N}\equiv\{1,\ldots,n\}\)</span> مجموعة الوكلاء، وكل تقاطع تتحكّم به وكيـلة واحدة. <span class="math inline">\(\mathcal{S}\)</span> فضاء الحالة العالمية، و<span class="math inline">\(\mathcal{A}\)</span> فضاء أفعال الوكيل الفردي. الفعل المُشترك <span class="math inline">\(\boldsymbol{a}\in\mathbf{A}\equiv\mathcal{A}^{n}\)</span> يضمّ أفعال الأفراد <span class="math inline">\(\left[a_{i}\right]_{i=1}^{n}\)</span>. في كل خطوة زمنية يتلقّى الوكيل <span class="math inline">\(i\)</span> ملاحظة <span class="math inline">\(o_{i}\in\mathcal{O}\)</span> ويختار فعلًا <span class="math inline">\(a_{i}\)</span>، فتنتقل الحالة إلى <span class="math inline">\(s'\)</span> وفقًا لدالة الانتقال <span class="math inline">\(\mathcal{P}(s'\mid s,\boldsymbol{a})\)</span> وتحصل مكافأة <span class="math inline">\(r=\mathcal{R}(s,\boldsymbol{a})\)</span>. يمثّل <span class="math inline">\(\mathcal{H}\)</span> أُفُق الزمن، و<span class="math inline">\(\gamma\in[0,1)\)</span> عامل الخصم.</p>

<h2 id="sec:agent_design">تصميم الوكيل</h2>
<p>يُسند إلى كل تقاطع وكيلٌ واحد. نعرض تصميم الملاحظة والفعل والمكافأة.</p>
<ul>
<li><p><strong>الملاحظة.</strong> تتكوّن الملاحظة الخام من: (1) عدد المركبات على كل مسار وارد <span class="math inline">\(\mathbf{f}_t^v\)</span>؛ (2) الطور الإشاري الحالي <span class="math inline">\(\mathbf{f}_t^s\)</span>. تُعرَّف ملاحظة الوكيل <span class="math inline">\(i\)</span> كما يلي:
<span class="math display">\[
\begin{aligned}
    o_{i}=\{\mathbf{f}_t^v,\ \mathbf{f}_t^s\},
\end{aligned}
\]</span>
حيث <span class="math inline">\(\mathbf{f}_t^v=\{V_{l_{1}^{in}},V_{l_{2}^{in}},\ldots,V_{l_{m}^{in}}\}\)</span> و<span class="math inline">\({l}^{in}=\{l_{1}^{in},\ldots,l_{m}^{in}\}\)</span> مجموعة المسارات الواردة إلى التقاطع. أما الطور الحالي <span class="math inline">\(\mathbf{f}_t^s=p_{k},\ k\in\{1,\ldots,K\}\)</span>، حيث يمثّل كل طور <span class="math inline">\(p_k\)</span> بمُتجه واحد ساخن، و<span class="math inline">\(K\)</span> عدد الأطوار. هدفنا تعلُّم فضاء كامن يُعزِّز هذه الملاحظة الخام.</p></li>
<li><p><strong>الفعل.</strong> فعل الوكيل هو اختيار الطور للفترة الزمنية التالية:
<span class="math display">\[
\begin{aligned}
    a_{i}=p_{k},\quad k\in\{1,\ldots,K\}.
\end{aligned}
\]</span>
يُيسّر هذا الاختيار المباشر مرونةً أعلى في تخطيط التحكُّم المروري.</p></li>
<li><p><strong>المكافأة.</strong> نُعرِّف مكافأة الوكيل على أنّها سالب مجموع أطوال الطوابير على المسارات الواردة (<span class="nodecor">zheng2019diagnosing</span>, <span class="nodecor">huang2021modellight</span>, <span class="nodecor">zang2020metalight</span>, <span class="nodecor">zheng2019learning</span>, <span class="nodecor">wei2019colight</span>):
<span class="math display">\[
\begin{aligned}
    r_{i}=-\sum_{m=1}^{M} q_{l^{in}_{m}},
\end{aligned}
\]</span>
حيث <span class="math inline">\(q_{l^{in}_{m}}\)</span> طول الطابور على المسار الوارد <span class="math inline">\(l^{in}_{m}\)</span>.</p></li>
</ul>

<h1 id="sec:method">الطريقة</h1>
<p>نقدِّم MTLight الذي يدمج شبكةً مُتعدِّدة المهام مع شبكة وكيل للتعلُّم المُعزَّز. نستخدم شبكة <span class="nodecor">Deep Q-Network (DQN)</span> (<span class="nodecor">mnih2015human</span>) لتقريب دالّة القيمة <span class="nodecor">Q</span>، بما ينسجم مع أعمالٍ سابقة (<span class="nodecor">chen2020toward, wei2019colight, wei2019presslight, zheng2019learning, wei2018intellilight</span>). أمّا الوحدة مُتعدِّدة المهام فتتّبع <em>مشاركة صارمة للمعاملات</em> (<span class="nodecor">caruana1997multitask</span>) عبر طبقاتٍ مشتركة بين جميع المهام مع رؤوس إخراج خاصّة بكل مهمّة.</p>

<h2 id="التعلم-المتعدد-المهام-للحالة-الكامنة">التعلُّم المُتعدِّد المهام للحالة الكامنة</h2>
<p>إضافةً إلى <span class="math inline">\(\mathbf{f}_t^v\)</span> و<span class="math inline">\(\mathbf{f}_t^s\)</span>، نستفيد من معلومات الحالة العالمية بصيغٍ زمنية، مثل: أعداد المركبات الوافدة خلال الخطوات <span class="math inline">\(\tau\)</span> الماضية <span class="math inline">\(\mathbf{f}_{t-\tau:t}^c=[\mathbf{f}_{t-\tau}^c,\ldots,\mathbf{f}_{t}^c]\)</span>، ومتوسط زمن السفر <span class="math inline">\(\mathbf{f}_{t-\tau:t}^{tr}\)</span>، وطول الطابور <span class="math inline">\(\mathbf{f}_{t-\tau:t}^{q}\)</span>، وعدد المركبات على الطريق <span class="math inline">\(\mathbf{f}_{t-\tau:t}^{vr}\)</span> في الفترة نفسها.</p>
<p>نُعرِّف أربع مهام مُساعِدة:</p>
<ol>
<li><p><strong>تقريب توزيع التدفُّق.</strong> مهمّة <span class="math inline">\(\mathcal{T}_{flow}\)</span> تُقدِّر متوسّط <span class="math inline">\(\mu_{f}\)</span> وتباين <span class="math inline">\(\sigma_{f}^{2}\)</span> معدّل وصول التدفُّق حتى الزمن <span class="math inline">\(t\)</span>:
<span class="math display">\[
\begin{aligned}
(\mu_{f},\ \sigma_{f}^{2})\leftarrow[\mathbf{f}_t^v,\ \mathbf{f}_t^s,\ \mathbf{f}_{t-\tau:t}^c,\ \mathbf{f}_{t-\tau:t}^{tr},\ \mathbf{f}_{t-\tau:t}^{q},\ \mathbf{f}_{t-\tau:t}^{vr}].
\end{aligned}
\]</span></p></li>
<li><p><strong>تقريب توزيع زمن السفر.</strong> مهمّة <span class="math inline">\(\mathcal{T}_{travel}\)</span> تُقدِّر متوسّط <span class="math inline">\(\mu_{tr}\)</span> وتباين <span class="math inline">\(\sigma_{tr}^{2}\)</span> زمن السفر حتى <span class="math inline">\(t\)</span>:
<span class="math display">\[
\begin{aligned}
(\mu_{tr},\ \sigma_{tr}^{2})\leftarrow[\mathbf{f}_t^v,\ \mathbf{f}_t^s,\ \mathbf{f}_{t-\tau:t}^c,\ \mathbf{f}_{t-\tau:t}^{tr},\ \mathbf{f}_{t-\tau:t}^{q},\ \mathbf{f}_{t-\tau:t}^{vr}].
\end{aligned}
\]</span></p></li>
<li><p><strong>تقريب طول الطابور التالي.</strong> مهمّة <span class="math inline">\(\mathcal{T}_{queue}\)</span> تتنبّأ بمتوسّط طول الطابور <span class="math inline">\(q\)</span> في الخطوة التالية:
<span class="math display">\[
\begin{aligned}
q\leftarrow[\mathbf{f}_t^v,\ \mathbf{f}_t^s,\ \mathbf{f}_{t-\tau:t}^c,\ \mathbf{f}_{t-\tau:t}^{tr},\ \mathbf{f}_{t-\tau:t}^{q},\ \mathbf{f}_{t-\tau:t}^{vr}].
\end{aligned}
\]</span></p></li>
<li><p><strong>تقريب عدد المركبات على الطريق.</strong> مهمّة <span class="math inline">\(\mathcal{T}_{vehicles}\)</span> تتنبّأ بعدد المركبات <span class="math inline">\(V^{r}\)</span> الموجودة حاليًّا في الشبكة:
<span class="math display">\[
\begin{aligned}
V^{r}\leftarrow[\mathbf{f}_t^v,\ \mathbf{f}_t^s,\ \mathbf{f}_{t-\tau:t}^c,\ \mathbf{f}_{t-\tau:t}^{tr},\ \mathbf{f}_{t-\tau:t}^{q},\ \mathbf{f}_{t-\tau:t}^{vr}].
\end{aligned}
\]</span>
لا يشمل ذلك المركبات التي أنهت رحلتها أو لم تدخل الشبكة بعد.</p></li>
</ol>
<p>نظرًا لاختلاف المقاييس والأبعاد بين السلاسل الزمنية <span class="math inline">\(\mathbf{f}_{t-\tau:t}^{(\cdot)}\)</span> والملاحظات المحليّة، نستخدم أربع طبقات خطّية مستقلّة مع <span class="nodecor">ReLU</span> لتوسيعها:
<span class="math display">\[
\begin{aligned}
\mathbf{h}^{c}&=\mathrm{ReLU}(\mathbf{W}_{1}\mathbf{f}_{t-\tau:t}^{c}+\mathbf{b}_{1}),\\
\mathbf{h}^{tr}&=\mathrm{ReLU}(\mathbf{W}_{2}\mathbf{f}_{t-\tau:t}^{tr}+\mathbf{b}_{2}),\\
\mathbf{h}^{q}&=\mathrm{ReLU}(\mathbf{W}_{3}\mathbf{f}_{t-\tau:t}^{q}+\mathbf{b}_{3}),\\
\mathbf{h}^{vr}&=\mathrm{ReLU}(\mathbf{W}_{4}\mathbf{f}_{t-\tau:t}^{vr}+\mathbf{b}_{4}).
\end{aligned}
\]</span>
ثم نُدمج المُدخلات المُضمَّنة ونُمرِّرها عبر طبقة خطّية و<span class="nodecor">ReLU</span> لحساب الحالة الكامنة <span class="math inline">\(\mathbf{H}_{t}\)</span>:
<span class="math display">\[
\begin{aligned}
\mathbf{H}_{t}=\mathrm{ReLU}\big(\mathbf{W}\,(\mathbf{f}_t^v,\ \mathbf{f}_t^s,\ \mathbf{h}^{c},\ \mathbf{h}^{tr},\ \mathbf{h}^{q},\ \mathbf{h}^{vr})+\mathbf{b}\big).
\end{aligned}
\]</span></p>
<p>استنادًا إلى <span class="math inline">\(\mathbf{H}_{t}\)</span>، تمرّ البيانات عبر طبقة مشتركة بين المهام (تتضمن <span class="nodecor">GRU</span>) لتوليد <em>الميزة الكامنة المُشتركة بين المهام</em>، ثم تُغذّى أربع فروع مستقلّة خاصّة بكل مهمّة لإنتاج <em>الميزة الكامنة المُخصَّصة للمهمّة</em>. نتّبع رؤى (<span class="nodecor">zhao2017learning</span>) باستخراج ميزاتٍ كامنةٍ هرميّة: نعتبر ناتج الطبقة المشتركة بعد <span class="nodecor">GRU</span> هو <em>الحالة العقلية</em> (أعمّ وأكثر تجريدًا)، بينما دمج مخرجات الطبقات الخاصّة بالمهام يمثّل <em>الحالة الظاهرة</em> (أدقّ ومُوجَّهة بالمهمّة). يتكامل النوعان ويُستخدمان معًا لتعزيز الملاحظة.</p>

<h2 id="السياسة-مع-الحالة-الكامنة">السياسة مع الحالة الكامنة</h2>
<p>باستخدام الحالة الكامنة، نُعزِّز ملاحظة الوكيل من <span class="math inline">\(\mathbf{o}_t\)</span> إلى <span class="math inline">\((\mathbf{o}_t,\ \mathbf{o}_{t}^{shr},\ \mathbf{o}_{t}^{spe})\)</span>، حيث تُشير <span class="math inline">\(\mathbf{o}_{t}^{shr}\)</span> إلى الميزة المُشتركة بين المهام، و<span class="math inline">\(\mathbf{o}_{t}^{spe}\)</span> إلى الميزة المُخصَّصة للمهمّة. هدف السياسة <span class="math inline">\(\pi^{\theta}\)</span> تعظيم المكافأة التراكمية:
<span class="math display">\[
\begin{aligned}
\max_{\theta}\ J(\theta)=\mathbb{E}_{\substack{a_t \sim \pi^\theta(a_t \mid \mathbf{o}_t,\mathbf{o}_{t}^{shr},\mathbf{o}_{t}^{spe})}}\left[\sum_{t=0}^{\mathcal{H}-1}\gamma^{t}r_{t+1}\right].
\end{aligned}
\]</span>
يعمل الوكيل الذي يُعظِّم الهدف السابق عمل <em>وكيل بايزي أمثل</em> (<span class="nodecor">ghavamzadeh2015bayesian</span>) عند التعامل مع المعرفة حول المهام ذات الصلة بصفتها أَولويّات معلوماتية عن البيئة. تقلّل الوحدة مُتعدِّدة المهام تعقيد النموذج وتؤمِّن أَولويّاتٍ إحصائيّة، وتُخفِّض انحياز التمثيل بدفع خوارزميّة التعلُّم إلى فضاء حلٍّ أصغر، ما يُسرّع التقارب ويحسّن الأداء.</p>

<h1 id="sec:experiment">التجربة</h1>
<p>أجرينا التجارب على منصّة CityFlow (<span class="nodecor">zhang2019cityflow</span>)، وهي محاكٍ مفتوح المصدر على مستوى المدينة للتحكُّم في إشارات المرور. تُوفِّر المنصّة بيئةً للتفاعل؛ تُنفِّذ الوكيلات الأفعال عبر تبديل الأطوار الإشارية، وتُعيد البيئة إشعارات الحالة والمكافآت.</p>
<p>نورد تفاصيل شبكات الطرق وتكوينات التدفُّق والطرائق الأساس في الملاحق ذات الصلة.</p>

<h2 id="مقارنة-الأداء">مقارنة الأداء</h2>
<table>
  <caption>نتائج مقارنة أساليب التحكُّم عبر مدن وسيناريوهات متنوّعة</caption>
  <tbody>
    <tr class="odd">
      <td style="text-align: left;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
      <td style="text-align: right;"></td>
    </tr>
    <tr class="even">
      <td style="text-align: left;">(lr)<span>2-3</span> (lr)<span>4-5</span> (lr)<span>6-7</span> (lr)<span>8-9</span></td>
      <td style="text-align: right;"><strong>real</strong></td>
      <td style="text-align: right;"><strong>syn_peak</strong></td>
      <td style="text-align: right;"><strong>real</strong></td>
      <td style="text-align: right;"><strong>syn_peak</strong></td>
      <td style="text-align: right;"><strong>real</strong></td>
      <td style="text-align: right;"><strong>syn_peak</strong></td>
      <td style="text-align: right;"><strong>real</strong></td>
      <td style="text-align: right;"><strong>syn_peak</strong></td>
      <td style="text-align: right;"></td>
    </tr>
    <!-- … بقية الجدول دون تعديل … -->
  </tbody>
</table>
<p>تُظهر النتائج بوضوح أنّ: 1) عمومًا تتفوّق طرق التعلُّم المُعزَّز على الطرق التقليدية، ما يبرز ميّزتها. وإضافةً إلى ذلك يقدّم MTLight أداءً متقدِّمًا في معظم المدن وتكوينات التدفُّق، مؤكِّدًا فعاليته. 2) يُظهر MTLight تعميمًا جيّدًا عبر سيناريوهات وتكوينات مختلفة؛ فمثلًا يحقّق <span class="nodecor">maxpressure</span> أداءً جيّدًا في <span class="nodecor">hangzhou</span> مع <span class="nodecor">realflow</span> لكنه يتراجع تحت <span class="nodecor">synflow</span>، بينما يحافظ MTLight على أداءٍ جيّدٍ ومستقرّ عبر هذه الأوضاع. 3) يتفوّق MTLight على <span class="nodecor">individualrl</span> و<span class="nodecor">metalight</span> و<span class="nodecor">presslight</span> بفوارق كبيرة (على التوالي: 693.46 و461.80 و432.38)، إذ إن تلك الطرق تتعلّم سياسة الإشارة من ملاحظاتها المحلية فقط وتُهمِل تأثير الجيران، بينما يُضمِّن MTLight معلومات الجوار ضمن بيئة التعلُّم. 4) تستفيد <span class="nodecor">colight</span> و<span class="nodecor">generalight</span> من مزج معلومات الجيران وتؤدّيان أداءً جيّدًا، غير أنّ MTLight يتفوّق عليهما في عدّة سيناريوهات، مع تحسينات تصل إلى نحو 42.5 و398، وذلك بفضل المعرفة المسبقة المُكتسَبة من الشبكة مُتعدِّدة المهام والتي تدعم قرارات أكثر دقّة.</p>

<h2 id="الاستئصال">دراسات الإزالة (Ablation)</h2>
<p>للوقوف على إسهام كل مكوّن، نقارن أربعة متغيّرات من MTLight عبر سيناريوهات متنوّعة:</p>
<ul>
<li><p><strong><span class="nodecor">Base</span>:</strong> يحتفظ بشبكة السياسة فقط ويزيل شبكة المهام المتعدّدة.</p></li>
<li><p><strong><span class="nodecor">Base-Raw</span>:</strong> يحتفظ بشبكة السياسة ويستغني عن شبكة المهام المتعدّدة، لكنه يُضيف مُدخلات الأخيرة الخام مباشرةً إلى الملاحظة.</p></li>
<li><p><strong><span class="nodecor">Base-Per</span>:</strong> يحتفظ بالشبكتين لكنه يستخدم <em>الحالة الكامنة المُشتركة بين المهام</em> فقط، ويزيل الحالة المُخصَّصة للمهمّة.</p></li>
<li><p><strong><span class="nodecor">Base-Tem</span>:</strong> يحتفظ بالشبكتين لكنه يستخدم <em>الحالة الكامنة المُخصَّصة للمهمّة</em> فقط، ويزيل الحالة المُشتركة.</p></li>
</ul>
<p>أما MTLight الكامل فيجمع شبكة السياسة مع كلٍّ من الحالة الكامنة المُشتركة والحالة المُخصَّصة. تُظهر النتائج أنّ: 1) <span class="nodecor">Base</span> هو الأضعف لأن تعلّم سياسةٍ فعّالة بشكلٍ مستقل صعبٌ في بيئةٍ مُتعدِّدة الوكلاء وديناميكيّة. 2) يتحسّن الأداء مع <span class="nodecor">Base-Per</span> و<span class="nodecor">Base-Tem</span> مقارنةً بـ<span class="nodecor">Base</span> و<span class="nodecor">Base-Raw</span>، ما يُبرز فعاليّة كلٍّ من <em>الحالة المُشتركة</em> (المعلومات السابقة الثابتة المرتبطة بمهام متقاربة) و<em>الحالة المُخصَّصة</em> (المعلومات المُلائمة للاتجاهات الآنيّة). 3) تفوّق MTLight الكامل يؤكّد أنّ النوعين مُتكاملان، وأن جميع المكوّنات المقترحة تُسهم إيجابيًّا في النتيجة النهائية.</p>

<h1 id="sec:conclusion">الخلاصة</h1>
<p>قدّمنا MTLight، وهو منهج فعّال للتعلُّم المُعزَّز مُتعدِّد المهام للتحكُّم في إشارات المرور قابلٌ للتوسّع إلى شبكاتٍ حضرية معقّدة ومتعدّدة الوكلاء. تُظهر البنية الكامنة قدرتها على تعلُّم تمثيلاتٍ هرميّةٍ غنيّة تُميِّز بين ميزاتٍ مُشتركة عبر المهام وأخرى مُخصَّصة للمهمّة. عبر مجموعات بيانات لمدنٍ عدّة، برهنا أنّ هذا التمثيل المُستلهَم من مهام متّصلة، مع تكييف السياسة عليه، يُمكِّن الوكيل من التكيُّف مع بيئاتٍ معقّدة. نستنتج أنّ استبقاء تقريباتٍ أوليّة (Prior) مشتقّة من مهام متّصلة يُساعد مقارنةً بالمقاربات الخالية من النماذج، خاصّةً عندما تكون معلومات البيئة وفيرة ولا يمكن اختزالها في تصميم حالةٍ اصطناعي.</p>
<p>وفي أعمالٍ لاحقة، يمكن تعلُّم أَولويّاتٍ كامنة من بيانات خبراء مُسبقة باستخدام التعلُّم بالتقليد (<span class="nodecor">song2018multi</span>) أو عبر تدريبٍ مُسبق بالاعتماد على خوارزميّاتٍ مُتعدِّدة الوكلاء على شبكةٍ مُتعدِّدة المهام.</p>

<h1 id="الملحق">الملحق</h1>
<p>تُدرج هنا تفاصيل إضافية مثل مواصفات شبكات الطرق، وتكوينات التدفُّق، ووصف الطرائق الأساس وإعدادات التدريب.</p>
</main>
</body>
</html>