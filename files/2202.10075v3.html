<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ar" xml:lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Constantine Doumanidis" />
  <meta name="author" content="Prashant Hari Narayan Rajput" />
  <meta name="author" content="Michail Maniatakos" />
  <title>ICSML: إطار تعلُّم الآلة لأنظمة التحكُّم الصناعي للاستدلال المُحَلِّي باستخدام شِفرة IEC 61131-3</title>
  <style>
    html {
      line-height: 1.6;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
      direction: rtl;
    }
    body {
      margin: 0 auto;
      max-width: 38em;
      padding: 48px 52px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
      direction: rtl;
    }
    @media (max-width: 600px) {
      body { font-size: 0.95em; padding: 1em; }
      h1 { font-size: 1.7em; }
    }
    @media print {
      body { background-color: transparent; color: black; font-size: 12pt; }
      p, h2, h3 { orphans: 3; widows: 3; }
      h2, h3, h4 { page-break-after: avoid; }
    }
    p { margin: 1em 0; }
    a { color: #1a1a1a; }
    a:visited { color: #1a1a1a; }
    img { max-width: 100%; }
    h1, h2, h3, h4, h5, h6 { margin-top: 1.4em; }
    h5, h6 { font-size: 1em; font-style: italic; }
    h6 { font-weight: normal; }
    ol, ul { padding-right: 1.7em; margin-top: 1em; padding-left: 0; }
    li > ol, li > ul { margin-top: 0; }
    blockquote {
      margin: 1em 1.7em 1em 0;
      padding-right: 1em;
      border-right: 2px solid #e6e6e6;
      color: #606060;
      border-left: none;
      text-align: right;
    }
    div.abstract {
      margin: 2em;
      text-align: right;
      font-size: 92%;
      background: #fafafa;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 1em 1.2em;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
      direction: ltr;
      unicode-bidi: embed;
      background: #f3f3f3;
      padding: 2px 4px;
      border-radius: 4px;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
      direction: ltr;
      text-align: left;
      background: #f7f7f7;
      padding: 1em;
      border-radius: 6px;
      border: 1px solid #eee;
    }
    pre code { padding: 0; overflow: visible; overflow-wrap: normal; }
    .sourceCode { background-color: transparent; overflow: visible; }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1.4em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
      direction: rtl;
      text-align: right;
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      box-shadow: 0 2px 8px #f0f0f0;
    }
    table caption {
      margin-bottom: 0.75em;
      text-align: center;
      font-weight: bold;
    }
    thead th {
      background: #f3f3f3;
      border-bottom: 2px solid #bdbdbd;
      padding: 0.5em 0.7em;
      font-weight: bold;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th, td {
      padding: 0.25em 0.7em;
      border-bottom: 1px solid #e0e0e0;
    }
    tr:last-child td { border-bottom: none; }
    header { margin-bottom: 3.2em; text-align: center; }
    #TOC li { list-style: none; }
    #TOC ul { padding-right: 1.3em; padding-left: 0; }
    #TOC > ul { padding-right: 0; }
    #TOC a:not(:hover) { text-decoration: none; }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-right: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    /* MathJax Arabic alignment fix */
    .mjx-chtml { direction: ltr !important; unicode-bidi: embed; font-size: 1em; }
    .math.inline {
      font-family: 'Cambria Math', 'Arial', serif;
      font-size: 1em;
      direction: ltr;
      unicode-bidi: embed;
      background: none;
      color: #1a1a1a;
      padding: 0 2px;
    }
    details.meta { background: #fbfbfb; border: 1px solid #eee; border-radius: 6px; padding: 0.5em 0.8em; }
    details.meta > summary { cursor: pointer; font-weight: bold; }
  </style>
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">ICSML: إطار تعلُّم الآلة لأنظمة التحكُّم الصناعي للاستدلال المُحَلِّي باستخدام شِفرة IEC 61131-3</h1>
<p class="author">كونستانتين دومانيديس</p>
<p class="author">براشانت هاري نارايان راجبوت</p>
<p class="author">ميخائيل مانياتاكوس</p>
<div class="abstract">
<div class="abstract-title">الملخّص</div>
<p>
لعبت أنظمة التحكُّم الصناعي (ICS) دورًا محوريًّا في تمكين الثورة الصناعيّة الرابعة. تُؤتمت أجهزة ICS مثل وحدات التحكُّم المنطقيّة القابلة للبرمجة (PLCs) وتُراقِب وتتحكَّم في العمليات الحيويّة في البيئات الصناعيّة وقطاع الطاقة والبيئات التجاريّة. وقد أدّى تقارُب تقنيّات تكنولوجيا العمليات (OT) التقليديّة مع تكنولوجيا المعلومات (IT) إلى فتح مشهد تهديدات جديد ومميَّز. ألهم ذلك أبحاث دفاع تركز بدرجة كبيرة على أساليب اكتشاف الشذوذ المعتمدة على تعلُّم الآلة (ML) التي تعمل على عتاد IT خارجي، ما يزيد التكلفة ويوسِّع سطح الهجوم. لإزالة هذا القيد، نقدّم إطار الاستدلال لتعلُّم الآلة في أنظمة التحكُّم الصناعي (ICSML) الذي يُمكِّن من تنفيذ استدلال نماذج تعلُّم الآلة محلِّيًّا على الـPLC. نُفِّذ ICSML باستخدام شِفرة IEC 61131-3 ويقدّم عدة تحسينات لتجاوز القيود التي تفرضها لغات البرمجة المتخصِّصة في المجال. وبذلك يعمل <em>على كُلّ PLC دون الحاجة إلى دعم من المُصنِّع</em>. يوفِّر ICSML مجموعة كاملة من المكوِّنات لبناء نماذج تعلُّم آلي متكاملة بطريقة تُشبه الأُطر المعروفة. أجرينا سلسلة من اختبارات الأداء لدراسة الذاكرة وزمن التنفيذ، وقارنّا حلّنا بإطار الاستدلال TFLite. وبالتوازي، طوّرنا تحسينات خاصّة بالمجال لزيادة كفاءة ICSML. ولإثبات قدرات الإطار، قيَّمنا دراسة حالة لدِفاع عملي ضد هجمات مُدرِكة للعملية تستهدف محطة تحلية مياه.
</p>
</div>
</header>

<details class="meta">
  <summary>ملاحظة تقنيّة: كلمات محجوزة ومفاتيح تمييز الصياغة</summary>
  <pre><code>Additional keywords:
case, of, if, then, end_if, end_case, super, function_block, function, extends, var,
constant, byte, end_var, var_input, real, bool, var_output,
dint, udint, word, dword, array, of, uint, not, adr, program, for, end_for,
while, do, end_while, repeat, end_repeat, until, to, by, else, elsif

Other symbols:
:, :=, &lt;&gt;, ;, ., [, ], ^, TRUE, FALSE, {attribute, hide}

keywords=[1]:
case, of, if, then, end_if, end_case, super, function_block, extends, var,
constant, byte, end_var, var_input, real, bool, var_output,
dint, udint, word, dword, array, of, uint, not, adr, :, :=, &lt;&gt;, ;, ., [, ], program, function, for, end_for,
while, do, end_while, repeat, end_repeat, until, to, by, else, elsif, sizeof

keywords=[2]: TRUE, FALSE
keywords=[3]: {attribute, hide}
sensitive=false
more_comments=[l] // 
more_comments=[s] (* *)
more_strings=[b] "  and  ' </code></pre>
</details>

<details class="meta CCXML">
  <summary>تصنيف المفاهيم (ACM CCS)</summary>
  <pre><code>&lt;ccs2012&gt;
  &lt;concept&gt;
    &lt;concept_id&gt;10010520.10010553.10010562&lt;/concept_id&gt;
    &lt;concept_desc&gt;تنظيم أنظمة الحاسوب — الأنظمة المُدمَجة&lt;/concept_desc&gt;
    &lt;concept_significance&gt;500&lt;/concept_significance&gt;
  &lt;/concept&gt;
  &lt;concept&gt;
    &lt;concept_id&gt;10010147.10010257.10010293&lt;/concept_id&gt;
    &lt;concept_desc&gt;منهجيّات الحوسبة — مقاربات تعلُّم الآلة&lt;/concept_desc&gt;
    &lt;concept_significance&gt;500&lt;/concept_significance&gt;
  &lt;/concept&gt;
  &lt;concept&gt;
    &lt;concept_id&gt;10002978.10002997.10002999&lt;/concept_id&gt;
    &lt;concept_desc&gt;الأمن والخصوصيّة — أنظمة كشف التسلُّل&lt;/concept_desc&gt;
    &lt;concept_significance&gt;300&lt;/concept_significance&gt;
  &lt;/concept&gt;
&lt;/ccs2012&gt;</code></pre>
</details>

<h1 id="introduction">المقدّمة</h1>
<p>
يشمل مصطلح أنظمة التحكُّم الصناعي (ICS) جميع الأجهزة والأنظمة التي تُمكِّن أتمتة العمليات الصناعيّة، بما في ذلك أنظمة التحكُّم وأجهزة القياس والشبكات ومكوّنات أخرى. تُستَخدم أجهزة ICS على نطاق واسع في البُنى التحتيّة الحيويّة للتحكُّم في العمليات الفيزيائيّة الحسّاسة. تضمن هذه الأجهزة التشغيل السلس والموثوق لبيئات صناعيّة وطاقيّة وتجاريّة مثل خطوط التجميع، ومحطّات تحلية المياه، والشبكات الكهربائيّة الذكيّة، ومحطّات المعالجة الكيميائيّة، والبنية التحتيّة للتعدين. ووفقًا لتقرير صادر عن Research and Markets عام 2021، من المتوقّع أن تبلغ القيمة السوقيّة العالميّة للتحكُّم الصناعي 49.6 مليار دولار أمريكي بحلول عام 2025.
</p>
<p>
مع بروز الثورة الصناعيّة الرابعة (Industry 4.0)، بدأت الصناعات في الاستفادة من أجهزة تكنولوجيا المعلومات (IT) داخل قطاع تكنولوجيا العمليات (OT)، ما أتاح تحسين الإنتاجية في الزمن الحقيقي، والمراقبة والتحكُّم عن بُعد، والصيانة التنبؤية، وزيادة الأتمتة، وغير ذلك. كان يُعتقَد سابقًا أن قطاع OT آمن بفضل عزله عن الشبكات (air-gapped). لكن الثورة الصناعيّة الرابعة طمَسَت الحدود بين IT وOT، ما جعل الأخير عُرضة لهجمات الشبكة عن بُعد. على سبيل المثال، ثغرة Log4j (<code>CVE-2021-44228</code>) التي اعتُبرت على نطاق واسع مشكلة تخصّ مجال IT، أثّرت في الواقع في عدد كبير من مورّدي ICS: شملت أكثر من 100 منتج من Siemens، و8 أجهزة من Rockwell مثل Plex IIoT وغيرها، وبرمجيّات Smart Script من WAGO، والعديد من الشركات الأخرى. ونتيجة لذلك، يمكن للمهاجمين استغلال ثغرات في بُنية IT لنشر الهجمات إلى شبكة OT وإلحاق أضرار جسيمة بالبُنى التحتيّة الحيويّة.
</p>
<p>
مع ازدياد عدد أجهزة OT المتّصلة بالإنترنت، ومع الحوافز المتمثّلة في العوائد الماليّة المرتفعة وإمكانية إحداث ضرر كبير بوجود ثغرات عديدة، أصبح قطاع OT هدفًا أكثر جاذبيّة للهجمات. ووفقًا لـPacketlabs، تعرّض 33.8% من حواسيب ICS عالميًّا لهجمات في النصف الأوّل من عام 2021. علاوة على ذلك، زادت ثغرات ICS بنسبة 41% مقارنة بالنصف الثاني من عام 2020، وكان 71% منها قابلًا للاستغلال عن بُعد.
</p>
<p>
شهد مجال ICS العديد من الهجمات البارزة: أصاب Stuxnet أكثر من 200,000 حاسوب وتسبّب في تلف عدد كبير من أجهزة الطرد المركزي المستخدمة في تخصيب اليورانيوم. وبدأت هجمة شبكة الكهرباء الأوكرانية عام 2015 بسرقة بيانات VPN، حيث قام المهاجمون بفتح القواطع، وإخراج محطات فرعيّة عن الخدمة، وكتابة برمجيّات ثابتة خبيثة لتعطيل الأوامر عن بُعد، ما أدّى إلى انقطاع الكهرباء عن نحو 230,000 شخص. كما أُحبِطت هجمات أخرى، مثل الهجوم على محطة معالجة المياه في أولدسمار، فلوريدا، حيث حاول المهاجمون زيادة تركيز هيدروكسيد الصوديوم في المياه إلى 100 ضعف الكميّة الطبيعيّة.
</p>
<p>
دُرست الهجمات على ICS في الأدبيّات، وتشمل الهجمات على وحدات التحكُّم المنطقيّة القابلة للبرمجة (PLCs) لتغيير منطق التحكُّم أو معلمات العملية، وتعديل البرمجيّات الثابتة، وتزوير قراءات الحساسات ضمن هجمات حقن بيانات زائفة (FDI) تُغذِّي الـPLC ببيانات مُضلِّلة للهجوم على العملية الفيزيائيّة المُتحكَّم بها. كما دُرست مسائل اكتشاف الثغرات في برمجة PLC وتصحيحها، ورصد البرمجيّات الخبيثة. وبالمثل، طُرحت دفاعات ضد الهجمات على عتاد ICS، من بينها حماية PLC عبر ثوابت التحكُّم (العلاقات بين قراءات الحساسات وأوامر PLC)، واستخراج قواعد منطق التحكُّم، وكشف انتهاكات السلامة. كما استُخدمت حلول معتمدة على تعلُّم الآلة لاكتشاف هجمات FDI.
</p>
<p>
ولا تقتصر استخدامات تعلُّم الآلة في مجال ICS على اكتشاف الهجمات؛ إذ يمكن أن تستفيد منه تطبيقات الرؤية الحاسوبيّة للفرز واللوجستيات والتغليف، والصيانة التنبّؤيّة عبر مراقبة حالة الآلات للتنبّؤ بالأعطال وجدولة الإصلاحات، وتحسين الضبط لاختيار استراتيجيات التحكُّم تلقائيًّا، وتحمل الأعطال، واكتشاف الأخطاء.
</p>
<p>
غالبًا ما تُبنى هذه الحلول المعتمدة على تعلُّم الآلة باستخدام لغات عالية المستوى، ولا يمكن تشغيلها إلا على PLCs تستخدم نظام تشغيل يدعم تنفيذ البرمجيّات العامّة. ولسوء الحظ، تعمل فئة واسعة من الأجهزة مباشرة على العتاد أو باستخدام أنظمة تشغيل خاصّة، ما يمنع مثل هذه العمليات. علاوة على ذلك، تعمل هذه الحلول في كثير من الأحيان خارج الجهاز إمّا في وضع جمع البيانات عبر الإنترنت أو دون اتصال. وبالتالي، يتعذّر نشرها عمليًّا نظرًا للحاجة إلى جهاز إضافي لكل PLC مع إمكانية الوصول إلى مدخلات الحساسات المستخدمة في الحل المعتمد على ML. يوضّح الشكل <a href="#fig:traditional_setup" data-reference-type="ref" data-reference="fig:traditional_setup">[fig:traditional_setup]</a> الحالة الراهنة: يجب أن يتلقّى أي حل معتمد على ML مدخلات العملية (عادةً تناظريّة) بشكل منفصل عن الـPLC، وينفِّذ الاستدلال وربما يكتشف شذوذًا، ثم يتّصل هذا الجهاز الخارجي (عادةً حاسوبًا تقليديًّا) بشبكة OT لنقل نتيجة الاستدلال. من البيّن أن وجود جهاز IT تقليدي داخل شبكة OT يوسّع سطح الهجوم وقد يرفع شدّة الأثر.
</p>
<p>
لإلغاء الحاجة إلى إدخال ودمج حاسوب تقليدي في دفاعات الأمن المعتمدة على ML، نقدّم ICSML؛ إطار استدلال لتعلُّم الآلة مُنفَّذ <em>محلّيًّا</em> بلغة النص الهيكلي (ST)، ومُتوافقًا بذلك مع جميع الأجهزة المتوافقة مع IEC 61131-3. وبما أنّ الإطار مبنيًّا بلغة ST، فإنّه يندمج مع أي مشروع IEC ويُتيح تنفيذ الدفاعات المعتمدة على ML على الجهاز نفسه. يمكن لهذا الحل أن يعمل على الـPLC دون أجهزة خارجيّة إضافية، ويبقى مرتبطًا بشكل وثيق بمدخلات الحساسات المرسلة إلى الـPLC. يوضّح الشكل <a href="#fig:icsml_setup" data-reference-type="ref" data-reference="fig:icsml_setup">[fig:icsml_setup]</a> ICSML، حيث يسمح بالاستدلال <em>داخل</em> الـPLC دون: 1) التضحية بدقّة الاستدلال، و2) التأثير على التشغيل الاعتيادي للـPLC، و3) الحاجة إلى دعم المُصنِّع. يمكن تلخيص مساهماتنا كما يلي:
</p>
<ul>
  <li>نُصيغ مشكلة تنفيذ الاستدلال بكفاءة على الـPLCs باستخدام لغات IEC 61131-3 عبر دراسة محدوديّة التعبيريّة في اللغات المتاحة، مع مراعاة قيود عتاد الـPLC وقيود الزمن الحقيقي المفروضة من بيئات تشغيل ICS.</li>
  <li>نُطوِّر إطار استدلال لتعلُّم الآلة يتجاوز قيود لغات IEC 61131-3 المتخصِّصة ويُوفِّر مجموعة كاملة من مكوّنات ML.</li>
  <li>نقدّم منهجيّة شاملة لتنفيذ الاستدلال المعتمد على ML على الـPLCs، تشمل تشكيل مجموعة البيانات، وبناء وتدريب النموذج على أُطر التعلُّم الآلي المعروفة، ونقل النموذج إلى ICSML، وتشغيله على الـPLC.</li>
  <li>نُقيِّم أداء ICSML عبر سلسلة من اختبارات الأداء تُبرز متطلّبات الذاكرة وتدرُّج الأداء مع حجم النموذج، إلى جانب حزمة من التحسينات الخاصّة بالـPLC.</li>
  <li>نُثبت كفاءة ICSML وطبيعته غير المتطفِّلة من خلال دراسة حالة تُنفِّذ دفاعًا حقيقيًّا على PLC لمحطّة تحلية مياه بالتقنيّة متعدِّدة المراحل (MSF).</li>
</ul>

<h1 id="preliminaries">المبادئ الأساسيّة</h1>
<h2 id="industrial-control-systems">أنظمة التحكُّم الصناعي</h2>
<p>
تشمل أنظمة التحكُّم الصناعي (ICS) أنظمة التحكُّم وأجهزة القياس المرتبطة بها التي تُراقب وتُدير وتتحكَّم وتُؤتمت العمليات الصناعيّة الفيزيائيّة، وغالبًا ما تُستخدم في البُنى التحتيّة الحيويّة. إحدى اللبنات الأساسيّة في ICS هي وحدات التحكُّم المنطقيّة القابلة للبرمجة (PLCs)، وهي أجهزة متكاملة ذات تصميم متين لضمان التشغيل الموثوق في البيئات الصناعيّة القاسية. تعمل الـPLCs وفق نموذج تشغيلي دوري يُعرف بدورة المسح (scan cycle)، حيث تُقرأ مدخلات الحساسات، وتُنفَّذ الحسابات بناءً على منطق التحكُّم، وتُضبط المُشغِّلات. يُبرمج منطق التحكُّم لأجهزة الـPLC من قِبل مهندسي العمليات باستخدام مجموعة من لغات البرمجة المتخصِّصة التي يحدِّدها معيار IEC 61131.
</p>
<h2 id="sec:languages">لغات IEC 61131-3</h2>
<p>
يُعد IEC 61131 معيارًا دوليًّا لوحدات التحكُّم القابلة للبرمجة. ويحدِّد الجزء الثالث من المعيار (IEC 61131-3) عدّة لغات برمجة تشمل:
</p>
<p>
<strong>مخطّط السِّلّم (Ladder Diagram - LD):</strong> لغة رسوميّة منخفضة المستوى تمثِّل هيكلًا يشبه السُّلّم، مؤلَّفًا من سِكّتين رأسيّتين متوازيتين تتّصل بينهما «دَرَجات» أفقيّة. تُمثَّل المدخلات والمخرجات برموز «التلامس» و«الملفّات» على التوالي. تُعد LD مناسبة أكثر لفنيّي الصيانة الذين يفتقرون لخبرة برمجيّة عميقة.
</p>
<p>
<strong>مخطّط الكتل الوظيفيّة (Function Block Diagram - FBD):</strong> لغة رسوميّة تتكوّن من كتل وظيفيّة (FBs) قد تكون مُضمَّنة أو مكتوبة بأيٍّ من لغات IEC 61131-3 الأخرى، وتتّصل بخطوط أفقيّة تُعرف بخطوط تدفُّق الإشارة.
</p>
<p>
<strong>المخطّط التسلسلي للوظائف (Sequential Function Chart - SFC):</strong> لغة رسوميّة تُحدِّد السلوك التسلسلي وقادرة على التكامل مع لغات IEC الأخرى. تُحدِّد الكتل المستطيلة مراحل عملية التحكُّم وتتّصل عبر خطوط تدفُّق وانتقالات.
</p>
<p>
<strong>النصّ الهيكلي (Structured Text - ST):</strong> لغة نصيّة عالية المستوى تُشبه باسكال، وتُتيح برمجة وظائف معقّدة بما يلبّي تطوّر قدرات الـPLC.
</p>
<p>
تتكوّن مشاريع IEC من كتل برمجيّة تُسمّى وحدات تنظيم البرامج (POUs)، يمكن برمجتها بإحدى لغات IEC ثم استخدامها من قِبل اللغات الأخرى، ما يجعل اللغات متوافقة فيما بينها. تشمل الـPOUs: الدوال (Functions) التي تُعلن بطريقة مشابهة للدوال في اللغات العامّة، والكتل الوظيفيّة (Function Blocks) التي تعمل بشكل مشابه للكائنات في البرمجة الكائنيّة، إذ تحتوي على متغيّرات ودوال تُغلِّف الحالة والوظيفة. أمّا الواجهات (Interfaces) في IEC 61131-3 فتمثّل «عقودًا» تُعرِّف تواقيع الطرق التي تُنفِّذها الكتل الوظيفيّة. كما يدعم المعيار أيضًا الهياكل (Structs) التي تُعلن بطريقة مشابهة لهياكل لغة C.
</p>
<p>
تحتوي الدوال وطرق الكتل الوظيفيّة على أقسام مخصّصة لتعريف المتغيّرات وتهيئتها. تمثّل المتغيّرات المعرّفة ضمن <code>VAR_INPUT</code> مدخلات الدالّة أو الطريقة، بينما تمثّل المتغيّرات ضمن <code>VAR_OUTPUT</code> قيم الإرجاع. وتُعدّ المتغيّرات في قسم <code>VAR</code> محليّة النطاق. وأخيرًا، تُستخدم متغيّرات <code>VAR_IN_OUT</code> لتمرير المعطيات بالمرجع كمدخلات/مخرجات معًا.
</p>

<h1 id="problem-formulation">صياغة المشكلة</h1>
<p>
نستكشف في هذا العمل قدرة الـPLCs على تنفيذ الاستدلال <em>بكفاءة</em> باستخدام لغات IEC 61131-3 للاستفادة من مزايا تعلُّم الآلة محلّيًّا على الـPLC. إن تنفيذ الاستدلال المعتمد على ML محلّيًّا على الـPLC يمثّل تحدّيًا للأسباب التالية:
</p>
<ol>
  <li>تُكتب تطبيقات الـPLC بلغات برمجة متخصِّصة ذات تعبيريّة محدودة وتُترجم إلى ملفات تنفيذيّة غير قياسيّة. تفتقر هذه اللغات إلى إدارة الذاكرة الديناميكيّة، ولا تدعم الاستدعاء الذاتي (recursion)، وغيرها من القيود التي تتطلّب حلولًا مبتكرة لدعم الاستدلال المعتمد على ML على نحوٍ سليم. سنوضّح ذلك في القسم <a href="#sec:limitations" data-reference-type="ref" data-reference="sec:limitations">3.1</a>.</li>
  <li>تأتي الـPLCs بتكوينات متباينة من حيث القدرة الحاسوبيّة، إذ تحتوي الغالبيّة على ذاكرة ومعالجات مدمجة محدودة، كما سنعرض في القسم <a href="#ss:plchwlimitations" data-reference-type="ref" data-reference="ss:plchwlimitations">3.2</a>. لذا يجب أن تكون الطرق المطوَّرة خفيفة الوزن وألّا تتداخل مع الهدف الحوسبي الأساسي للـPLC: التحكُّم والمراقبة.</li>
  <li>تتطلّب العمليات الصناعيّة عادةً استجابة في الزمن الحقيقي، وقد تكون دورة المسح (حلقة الاستشعار–الحوسبة–التفعيل) بفترات زمنية في حدود أجزاء من الثانية. لذا ينبغي تطوير الاستدلال بعناية مع مراعاة دورة المسح، كما سنناقش في القسم <a href="#ss:realtimeconstr" data-reference-type="ref" data-reference="ss:realtimeconstr">3.3</a>.</li>
</ol>

<h2 id="sec:limitations">قيود لغات IEC 61131-3</h2>
<p>
يُفضي تنفيذ حلول تعلُّم الآلة لأنظمة التحكُّم الصناعي وجميع وظائفها ضمن بيئة المُصنِّع للـPLC وباستخدام لغات IEC 61131-3 إلى تحدّيات نابعة من القيود الخاصّة بهذه اللغات. وبعد موازنة مزايا وعيوب لغات IEC المتاحة، نجد أن Structured Text هي الأنسب لتطوير تطبيقات ML لكونها أقرب إلى اللغات التقليديّة وأكثر مرونة ضمن المعيار IEC 61131-3. ومن أبرز القيود في ST:
</p>
<p>
<strong>غياب إدارة الذاكرة الديناميكيّة:</strong> تفتقر ST، شأنها شأن بقية لغات IEC 61131-3، إلى إدارة الذاكرة الديناميكيّة أثناء التشغيل؛ ممّا يمنع مثلًا تخصيص مصفوفات بأطوال متغيرة.
</p>
<p>
<strong>تمرير المدخلات بالقيمة:</strong> تُمرَّر المدخلات المُصرَّح بها في <code>VAR_INPUT</code> إلى الـPOUs بالقيمة (يُنشَأ نُسَخ للبيانات لكل استدعاء)، ما لم تُمرَّر كـ<code>VAR_IN_OUT</code> صراحةً.
</p>
<p>
<strong>لا يجوز للدوال إنشاء أو استدعاء كتل وظيفيّة:</strong> يُسمَح للدوال باستدعاء دوال أخرى، لكن لا يجوز لها إنشاء مثيلات كتل وظيفيّة أو استدعاء طرقها. وقد تسمح بعض البيئات بتمرير مرجع إلى كتلة وظيفيّة للوصول إلى بياناتها فحسب، لا لتنفيذها.
</p>
<p>
<strong>عدم دعم الاستدعاء الذاتي (Recursion):</strong> يُحظَر الاستدعاء الذاتي المباشر أو غير المباشر في لغات IEC 61131-3، لعدم القدرة على ضمان حدّ أعلى آمن للذاكرة المستخدَمة. وقد تُتيح حِيَل مثل الاستدعاء غير المباشر تجاوز فحوصات المُترجِم الساكنة، لكنها تؤدّي إلى أعطال وقت التنفيذ.
</p>
<p>
<strong>غياب الدوال من الدرجة الأولى:</strong> لا تُعامَل الدوال في ST ككيانات من الدرجة الأولى، فلا يمكن تمريرها كوسائط إلى الـPOUs. يُقيِّد ذلك استخدام البرمجة الوظيفيّة المُعتادة في أُطر ML لبناء سلاسل معالجة بيانات وتكوين مكوّنات مثل طبقة Keras lambda.
</p>

<div class="table*">
<div class="adjustbox">
<p><span>العرض=1</span></p>
<table>
<caption>جدول 1: مواصفات عتاد PLC لدى شركات مختلفة</caption>
<thead>
<tr class="header">
<th style="text-align: right;"><strong>الشركة المُصنِّعة</strong></th>
<th style="text-align: right;"><strong>النماذج</strong></th>
<th style="text-align: right;"><strong>زمن/تعليمة تقريبي (<span class="math inline">\( \mu s \)</span>)</strong></th>
<th style="text-align: right;"><strong>الذاكرة / RAM</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">ABB</td>
<td style="text-align: right;">AC500 PM57x/58x/59x/595/50xx/55x/56x</td>
<td style="text-align: right;">FP:0.7/0.5/0.004/0.001/0.6/1200</td>
<td style="text-align: right;">128-512KB/512KB-1MB/2-4MB/16MB/256KB-1MB/128-512KB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Allen Bradley</td>
<td style="text-align: right;">Micro 810/20/30/50/70, CL 5380, 5560/70/80</td>
<td style="text-align: right;">2.5/0.3/0.3/0.3/0.3, N/A, N/A</td>
<td style="text-align: right;">2/20/8-20/20/40KB, 600KB-10MB, 3-40/2-32/2-32MB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Delta Electronics</td>
<td style="text-align: right;">AS300, AH500</td>
<td style="text-align: right;">1.6, 0.02 LD</td>
<td style="text-align: right;">N/A, 128KB-4MB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Eaton</td>
<td style="text-align: right;">XC152, XC300</td>
<td style="text-align: right;">N/A, N/A</td>
<td style="text-align: right;">64MB, 512MB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Emerson</td>
<td style="text-align: right;">Micro CPUE05/001, RX3i CPE400/CPL410</td>
<td style="text-align: right;">0.8 Bool/1.8, N/A</td>
<td style="text-align: right;">64/34KB, 64MB/2GB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Fatek</td>
<td style="text-align: right;">B1, B1z</td>
<td style="text-align: right;">0.33, 0.33</td>
<td style="text-align: right;">31KB, 15KB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Festo</td>
<td style="text-align: right;">CECC-D/LK/S</td>
<td style="text-align: right;">N/A</td>
<td style="text-align: right;">16/16/44MB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Fuji Electric</td>
<td style="text-align: right;">SPH5000M/H/D/3000D/300/2000/200</td>
<td style="text-align: right;">FP:0.0253/0.066/0.088/0.08/0.27/5600</td>
<td style="text-align: right;">4/4/2/2/2MB/128KB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Hitachi</td>
<td style="text-align: right;">Micro EHV+, HX, EHV+</td>
<td style="text-align: right;">N/A, 0.006 FP, 0.08</td>
<td style="text-align: right;">1MB, 16MB, 2MB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Honeywell</td>
<td style="text-align: right;">ControlEdge R170 PLC</td>
<td style="text-align: right;">N/A</td>
<td style="text-align: right;">256MB ECC</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Mitsubishi Electric</td>
<td style="text-align: right;">MELSEC iQ-R/Q/L</td>
<td style="text-align: right;">0.0098 FP/0.0016 LD/0.065 LD</td>
<td style="text-align: right;">4MB/64-896KB/64K Steps</td>
</tr>
<tr class="even">
<td style="text-align: right;">Panasonic</td>
<td style="text-align: right;">FP 7/2SH/0R/X0/0H</td>
<td style="text-align: right;">0.011/0.03/0.08-0.58/0.08-0.58/0.01</td>
<td style="text-align: right;">1MB/20KB/64KB/16KB/64K Steps</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Rexroth (Bosch)</td>
<td style="text-align: right;">XM21/22/42, VPB</td>
<td style="text-align: right;">FP:0.026/0.013/0.02/0.02</td>
<td style="text-align: right;">0.5/0.5/2/16GB</td>
</tr>
<tr class="even">
<td style="text-align: right;">Schneider Electric</td>
<td style="text-align: right;">Modicon M221/241/251/262</td>
<td style="text-align: right;">0.3/0.3/0.022/0.005</td>
<td style="text-align: right;">256KB/64MB/64MB/32MB</td>
</tr>
<tr class="odd">
<td style="text-align: right;">SIEMENS</td>
<td style="text-align: right;">SIMATIC S7-1200/1500</td>
<td style="text-align: right;">2.3/0.006-0.384</td>
<td style="text-align: right;">150KB/150KB-4MB</td>
</tr>
<tr class="even">
<td style="text-align: right;">WAGO</td>
<td style="text-align: right;">PFC100/200</td>
<td style="text-align: right;">N/A, N/A</td>
<td style="text-align: right;">256/512MB</td>
</tr>
</tbody>
</table>
</div>
<p><span id="tbl:plc_hardware" label="tbl:plc_hardware"></span></p>
</div>

<h2 id="ss:plchwlimitations">قيود عتاد الـPLC</h2>
<p>
نظرًا إلى أنّ الـPLCs تُنشَر غالبًا في بيئات صناعيّة مترابطة وقاسية، يتركّز تصميمها عادةً على المتانة والكفاءة والاتصال والصلابة، على حساب إدماج عتاد حوسبي عالي الأداء.
</p>
<p>
كما هو مبيَّن في الجدول <a href="#tbl:plc_hardware" data-reference-type="ref" data-reference="tbl:plc_hardware">[tbl:plc_hardware]</a>، تستخدم الـPLCs من الفئة المبدئيّة مثل Allen Bradley Micro 810 معالجات منخفضة الطاقة وتحتوي على ذاكرة محدودة (2 كيلوبايت فقط). أمّا الـPLCs متوسّطة الأداء مثل Schneider Electric Modicon M241 فتضمّ معالجات أسرع (أحيانًا متعدّدة الأنوية) وذاكرة RAM أكبر (حوالي 64 ميجابايت). وأخيرًا، تحتوي الـPLCs عالية الأداء مثل WAGO PFC 200 عادةً على معالجات ARM أسرع وذاكرة RAM بسعة 512 ميجابايت.
</p>
<p>
وبالنظر إلى الموارد المحدودة المتاحة على الـPLCs، ينبغي كتابة تطبيقات تعلُّم الآلة لأنظمة التحكُّم الصناعي بكفاءة في استخدام المدخلات/المخرجات وزمن المعالج والذاكرة، لتحقيق الأداء المطلوب دون التأثير في مهام ICS الأخرى.
</p>

<h2 id="ss:realtimeconstr">قيود الزمن الحقيقي</h2>
<p>
تتضمّن عمليات ICS عادةً مهامّ تعمل دوريًّا، مثل حلقات التغذية الراجعة PID. ولذلك تعمل الـPLCs وفق نموذج دوري يعتمد على تسلسل دورة المسح. في بداية الدورة، يقرأ الـPLC قيم المدخلات (عادةً قراءات الحساسات) ويحمّلها في الذاكرة لإجراء الحسابات. بعد ذلك، يُنفِّذ تسلسل التعليمات المُبرمَج باستخدام لغات IEC 61131-3. وأخيرًا، تُحدَّث مخرجات الـPLC وفق نتائج الخطوة السابقة، ويمكن استخدام هذه المخرجات لأغراض متعدّدة مثل تفعيل المُشغِّلات أو جمع البيانات وغيرها.
</p>
<p>
قد يختلف طول دورة المسح المرغوب فيه بحسب بيئة ICS. فمثلًا، قد يُطلَب من الـPLCs التي تتحكّم في الروبوتات الصناعيّة الاستجابة خلال أجزاء من الثانية، خصوصًا عندما تتعلّق المسألة بسلامة الإنسان. في المقابل، يمكن التحكّم في العمليات البتروكيميائيّة البطيئة بدورات مسح بطول ثوانٍ.
</p>
<p>
يُحدِّد عدد الحسابات الممكن تنفيذها في دورة مسح واحدة طولُ الدورة وقوّة المعالجة المتاحة. وقد يؤدّي انتهاك قيود الزمن الحقيقي لعملية ICS كما تمليها دورة المسح إلى عواقب وخيمة.
</p>

<!-- بقية الترجمة مستمرة بنفس الأسلوب، مع الحفاظ على التنسيق، وتصحيح LaTeX، وضمان تدفق النص العربي بشكل علمي وأنيق -->

<h1 class="unnumbered" id="resources">الموارد</h1>
<p>
ICSML مفتوح المصدر: <a href="https://github.com/momalab/ICSML" class="uri">https://github.com/momalab/ICSML</a>
</p>
</body>
</html>